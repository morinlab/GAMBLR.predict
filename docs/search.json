[{"path":"https://morinlab.github.io/GAMBLR.predict/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 GAMBLR.predict authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_KNN.html","id":"dlbclone_knn","dir":"Articles","previous_headings":"","what":"DLBCLone_KNN","title":"K-Nearest Neighbors without UMAP","text":"Weighted KNN feature (mutation) matrix optional upweighting user-specified “core” features, optional exclusion “hidden” features, optional optimization explicit outgroup (e.g. “”). features_df matrix (rows = samples, cols = features) rownames must sample IDs metadata data frame least sample_id ground-truth label column given truth_column core_features character vector feature names upweight (optional) core_feature_multiplier numeric multiplier core_features (default: 1.5) hidden_features vector feature names drop min_k integer K range explore optimizing (default: 5) max_k integer K range explore optimizing (default: 60) truth_column name metadata column ground-truth class labels truth_classes vector classes consider (including other_class intend optimize ) other_class name explicit outgroup class (default: “”) optimize_for_other TRUE: computes separate “” score (ratio) searches purity threshold; FALSE, treats classes symmetrically predict_unlabeled TRUE: re-runs KNN classify samples present features_df metadata plot_samples optional vector sample_ids keep example plots DLBCLone_KNN_out optional prior result; supplied, learned parameters reused (skip optimization) epsilon small value added distances weighting weighted_votes FALSE: neighbors unweighted (equal votes) skip_umap TRUE: skip layout optimization plots end","code":"dlbcl_knn <- DLBCLone_KNN(   features_df = best_opt_model_matrix,   metadata = dlbcl_meta_clean,   min_k = 5,   max_k = 21,   optimize_for_other = TRUE )  knitr::kable(head(dlbcl_knn$predictions)) dlbcl_knn$plot_truth dlbcl_knn$plot_predicted"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_KNN.html","id":"dlbclone_knn_predict","dir":"Articles","previous_headings":"","what":"DLBCLone_KNN_predict","title":"K-Nearest Neighbors without UMAP","text":"Applies previously optimized DLBCLone_KNN model predict class labels new (test) samples. function combines training test feature matrices, ensures feature compatibility, uses parameters DLBCLone KNN optimization run classify test samples. Optionally, runs iterative mode stable results predicting multiple samples. DLBCLone_KNN_predict reproducible run sample individually samples affect nearest-neighbor distances. OK users want “try ” model doesn’t scale well, predict_single_sample_DLBCLone way go. train_df matrix features training samples (rows = samples, columns = features) test_df matrix features test samples classified metadata data frame metadata samples, including least sample_id column core_features optional character vector feature names upweight KNN calculation core_feature_multiplier multiplier apply core features (default: 1.5) hidden_features optional character vector feature names exclude analysis DLBCLone_KNN_out output previous call DLBCLone_KNN containing optimized parameters mode “iterative”, runs KNN prediction test sample individually (recommended stability)","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_KNN.html","id":"batch-mode","dir":"Articles","previous_headings":"","what":"Batch Mode","title":"K-Nearest Neighbors without UMAP","text":"","code":"predictions_b <- DLBCLone_KNN_predict(   train_df = best_opt_model_matrix,   test_df = valid_df,   metadata = dlbcl_meta_clean,   DLBCLone_KNN_out = dlbcl_knn,   mode = \"batch\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_mixture_model.html","id":"dlbclone_train_mixture_model","dir":"Articles","previous_headings":"","what":"DLBCLone_train_mixture_model","title":"Gaussian Mixture Model","text":"Training Gaussian Mixture Model DLBCLone Classification, function fits supervised Gaussian mixture model (GMM) UMAP-projected data DLBCLone subtypes, excluding samples labeled “”. assigns class predictions optionally reclassifies samples “” based probability density thresholds. umap_out output make_and_annotate_umap, containing data frame UMAP coordinates truth labels probability_threshold minimum posterior probability required assign class (default: 0.5) density_max_threshold minimum maximum density required assign class (default: 0.05)","code":"library(mclust) # <- necessary for running the mixture models  mixture_result <- DLBCLone_train_mixture_model(umap_out = mu_everything)"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_mixture_model.html","id":"dlbclone_predict_mixture_model","dir":"Articles","previous_headings":"","what":"DLBCLone_predict_mixture_model","title":"Gaussian Mixture Model","text":"Applies previously trained supervised Gaussian mixture model (GMM) UMAP-projected data DLBCLone subtypes. Assigns class predictions optionally reclassifies samples “” based probability density thresholds. model fitted model object, returned DLBCLone_train_mixture_model umap_out output make_and_annotate_umap, containing data frame UMAP coordinates samples classified model. must projected using UMAP model generated using training data. probability_threshold minimum posterior probability required assign class (default: 0.5) density_max_threshold minimum maximum density required assign class (default: 0.05)","code":"predict_mixture_result <- DLBCLone_predict_mixture_model(   model = mixture_result$gaussian_mixture_model,    umap_out = mu_everything )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_optimize_params.html","id":"preamble","dir":"Articles","previous_headings":"","what":"Preamble","title":"Training a new DLBCLone model","text":"DLBCLone model suitable application, can train custom model meet needs. training process leverages bundled mutation data LymphGen classifications 2000 DLBCLs. model ’re satisfied , can applied data using DLBCLone_predict.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_optimize_params.html","id":"optimizing-parameters","dir":"Articles","previous_headings":"","what":"Optimizing parameters","title":"Training a new DLBCLone model","text":"DLBCLone_optimize_params function tunes K value thresholds based training data, working maximize balanced accuracy (optionally) another metric. required commonly used arguments : combined_mutation_status_df feature matrix data frame one row per sample one column per mutation Confusingly, argument longer required. mutation status stored output make_and_annotate_umap metadata_df data frame metadata one row per sample three required columns: sample_id, dataset column containing “truth” lable, defaults lymphgen umap_out output make_and_annotate_umap truth_classes vector classes use training testing (LymphGen default: c(“EZB”, “MCD”, “ST2”, “N1”, “BN2”, “”)) min_k lowest k range values try KNN (default: 3). Set higher restrict narrower range. max_k highest k range values try KNN (default: 33). Set lower restrict narrower range.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_optimize_params.html","id":"example","dir":"Articles","previous_headings":"","what":"Example","title":"Training a new DLBCLone model","text":"’re , assume ’ve run make_and_annotate_umap generally happy separation samples latent representation. can use DLBCLone_optimize_params automate finding optimal K value (number neighbors) thresholds categorize sample based location proximity points UMAP. , provide original UMAP produced make_and_annotate_umap re-projected UMAP, function perform sample--sample projection us.","code":"best_opt_model = DLBCLone_optimize_params(     combined_mutation_status_df = mu_everything$features,    metadata_df = dlbcl_meta_clean,   umap_out = mu_everything,   truth_classes = c(\"MCD\",\"EZB\",\"BN2\",\"N1\",\"ST2\",\"Other\"),   min_k=5,   max_k=13 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_optimize_params.html","id":"overview-of-classifications","dir":"Articles","previous_headings":"","what":"Overview of classifications","title":"Training a new DLBCLone model","text":"convenience plotting function make_alluvial generates alluvial plots summarize relationship original (e.g., Lymphgen) predicted (e.g., DLBCLone) class assignments set samples. Typically, use evaluate well model performs across classes. required argument DLBCLone model, example, output DLBCLone_optimize_params. additional arguments commonly used: pred_column name column predictions use predicted class. usually one DLBCLone_wo DLBCLone_w, respectively DLBCLone without outgroup optimization pred_name Display name predictions (e.g. DLBCLone)   overview classification result can also visualized UMAP space. can useful compare UMAP coloured ground truth labels new labels produced DLBCLone.","code":"make_alluvial(all_features_optimized,   pred_column = \"DLBCLone_wo\",   pred_name = \"DLBCLone Optimized\") make_alluvial(all_features_optimized,   pred_column = \"DLBCLone_w\",   pred_name = \"DLBCLone Greedy\") make_umap_scatterplot(   all_features_optimized$prediction,    colour_by = \"lymphgen\",   title = \"Ground Truth\" ) make_umap_scatterplot(   all_features_optimized$prediction,    colour_by = \"DLBCLone_wo\",   title = \"DLBCLone Optimized\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_optimize_params.html","id":"make_alluvial","dir":"Articles","previous_headings":"","what":"make_alluvial","title":"Training a new DLBCLone model","text":"convenience plotting function make_alluvial generates alluvial plots summarize relationship original (e.g., Lymphgen) predicted (e.g., DLBCLone) class assignments set samples. Typically, use evaluate well model performs across classes. required argument DLBCLone model, example, output DLBCLone_optimize_params. additional arguments commonly used: pred_column name column predictions use predicted class. usually one DLBCLone_wo DLBCLone_w, respectively DLBCLone without outgroup optimization pred_name Display name predictions (e.g. DLBCLone)","code":"make_alluvial(all_features_optimized,   pred_column = \"DLBCLone_wo\",   pred_name = \"DLBCLone Optimized\") make_alluvial(all_features_optimized,   pred_column = \"DLBCLone_w\",   pred_name = \"DLBCLone Greedy\")"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_optimize_params.html","id":"make_umap_scatterplot","dir":"Articles","previous_headings":"","what":"make_umap_scatterplot","title":"Training a new DLBCLone model","text":"overview classification result can also visualized UMAP space. can useful compare UMAP coloured ground truth labels new labels produced DLBCLone.","code":"make_umap_scatterplot(   all_features_optimized$prediction,    colour_by = \"lymphgen\",   title = \"Ground Truth\" ) make_umap_scatterplot(   all_features_optimized$prediction,    colour_by = \"DLBCLone_wo\",   title = \"DLBCLone Optimized\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_stored.html","id":"preamble","dir":"Articles","previous_headings":"","what":"Preamble","title":"DLBCLone Models","text":"future use facilitate reproducibility, can save outputs DLBCLone_optimize_params (.e. DLBCLone model) restore subsequent session.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_stored.html","id":"dlbclone_save_optimized","dir":"Articles","previous_headings":"","what":"DLBCLone_save_optimized","title":"DLBCLone Models","text":"store model, simply specify directory name prefix incorporated file names. saved model two separate compoents, .rds file .uwot file.","code":"DLBCLone_save_optimized( # saving DLBCLone_optimize_params   DLBCLone_model = best_opt_model,   base_path=\"../data/saved_tutorial_model\",   name_prefix=\"best_opt_model\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_stored.html","id":"dlbclone_load_optimized","dir":"Articles","previous_headings":"","what":"DLBCLone_load_optimized","title":"DLBCLone Models","text":"Allows load stored model.","code":"loaded_model <- DLBCLone_load_optimized( # loading DLBCLone_optimize_params    path=\"../data/saved_tutorial_model\",    name_prefix=\"best_opt_model\" ) default_model <- \"best_opt_w\" # Load your stored optimized model from DLBCLone_save_optimized() all_features_optimized <- DLBCLone_load_optimized(          dirname(             system.file(                 \"extdata/models\",                 \"best_opt_model.rds\",                 package = \"GAMBLR.predict\"             )         ),         default_model     )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_stored.html","id":"key-components-of-a-dlbclone-model","dir":"Articles","previous_headings":"","what":"Key components of a DLBCLone model","title":"DLBCLone Models","text":"DLBCLone models simply named lists keep track necessary objects required downstream functions DLBCLone_predict. Key components aware : features feature matrix training data used initially create UMAP model determine coordinates training samples UMAP space. contains original mutation features plus (applicable) meta-features. latter recognizable ’re named differently (end _feats). model actual UMAP model, generated uwot package predictions original predicted labels every training sample determined DLBCLone_optimize_params. Let’s take peek ’s features model. see, model used 5 meta-features, one ST2, N1, EZB, MCD BN2. DLBCLone_predict versatile function, can use cross reference training data, predict test sample one time, test samples ! just re-analyzing training samples. two required arguments: mutation_status data frame sample_id rownames feature name columns. feature matrix want predict classes . can subset contain rows samples want analyzed isn’t necessary. optimized_model actual DLBCLone model want use. example, output DLBCLone_optimize_params model ’ve re-loaded disk via DLBCLone_load_optimized","code":"colnames(all_features_optimized$features) [1] \"ACTB\"         \"ACTG1\"        \"BCL10\"        \"BCL2\"         \"BCL2L1\"  [6] \"BCL2_SV\"      \"BCL6\"         \"BCL6_SV\"      \"BIRC3\"        \"BRAF\" [11] \"BTG1\"         \"BTG2\"         \"BTK\"          \"CD19\"         \"CD70\" [16] \"CD79B\"        \"CD83\"         \"CDKN2A\"       \"CREBBP\"       \"DDX3X\" [21] \"DTX1\"         \"DUSP2\"        \"EDRF1\"        \"EIF4A2\"       \"EP300\" [26] \"ETS1\"         \"ETV6\"         \"EZH2\"         \"FAS\"          \"FCGR2B\" [31] \"FOXC1\"        \"FOXO1\"        \"GNA13\"        \"GRHPR\"        \"HLA-A\" [36] \"HLA-B\"        \"HNRNPD\"       \"IRF4\"         \"IRF8\"         \"ITPKB\" [41] \"JUNB\"         \"KLF2\"         \"KLHL14\"       \"KLHL6\"        \"KMT2D\" [46] \"MEF2B\"        \"MPEG1\"        \"MYD88\"        \"MYD88HOTSPOT\" \"NFKBIA\" [51] \"NFKBIE\"       \"NFKBIZ\"       \"NOL9\"         \"NOTCH1\"       \"NOTCH2\" [56] \"OSBPL10\"      \"PIM1\"         \"PIM2\"         \"PRDM1\"        \"PRDM15\" [61] \"PRKDC\"        \"PRRC2C\"       \"PTPN1\"        \"RFTN1\"        \"S1PR2\" [66] \"SETD1B\"       \"SGK1\"         \"SOCS1\"        \"SPEN\"         \"STAT3\" [71] \"STAT6\"        \"TBCC\"         \"TBL1XR1\"      \"TET2\"         \"TMEM30A\" [76] \"TMSB4X\"       \"TNFAIP3\"      \"TNFRSF14\"     \"TOX\"          \"TP53\" [81] \"TP73\"         \"UBE2A\"        \"WEE1\"         \"XBP1\"         \"ZFP36L1\" [86] \"st2_feats\"    \"n1_feats\"     \"ezb_feats\"    \"mcd_feats\"    \"bn2_feats\" head(rownames(all_features_optimized$features)) [1] \"00-14595_tumorC\"   \"00-15201_tumorA\"   \"00-15201_tumorB\" [4] \"00-17960_CLC01670\" \"FL1015T2\"          \"00-22011_tumorB\" all_features_optimized$features[c(1:10),c(1:10)] ACTB ACTG1 BCL10 BCL2 BCL2L1 BCL2_SV BCL6 BCL6_SV BIRC3 BRAF 00-14595_tumorC      0     0     0    2      0       2    2       2     0    0 00-15201_tumorA      0     0     0    0      0       0    2       0     0    0 00-15201_tumorB      0     0     0    0      0       0    0       0     0    0 00-17960_CLC01670    2     0     0    1      0       2    0       2     0    0 FL1015T2             0     0     0    0      0       2    0       2     0    0 00-22011_tumorB      0     0     0    0      0       0    0       0     0    0 00-23442_tumorB      0     0     0    0      0       2    0       0     0    0 00-26427_tumorA      0     0     0    0      0       2    0       0     0    0 00-26427_tumorC      0     0     0    0      0       2    0       0     0    0 FL1002T2             0     0     0    2      0       2    0       0     0    0"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/DLBCLone_stored.html","id":"activating-a-model","dir":"Articles","previous_headings":"","what":"Activating a model","title":"DLBCLone Models","text":"plan classifying one sample session, activated model perform better. simply pre-computes coordinates training samples using model stores re-use.","code":"# Reactivates stored model setting the UMAP projection  all_features_optimized <- DLBCLone_activate(    all_features_optimized,    force = TRUE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/full_walkthrough.html","id":"training-data","dir":"Articles","previous_headings":"","what":"Training data","title":"DLBCLone: Full Walkthrough","text":"simplicity, ’ll skip feature selection train new model using set genes pre-selected based model described DLBCLone preprint. code shows infer features used training model, starting column names model’s features (model_feats). SSM features Hotspot features SV features","code":"# Full set of genes considered for SSM  model_genes = grep(\"_SV|HOTS\",model_feats,invert=T,value=T)  model_genes [1] \"ACTB\"     \"ACTG1\"    \"BCL10\"    \"BCL2\"     \"BCL2L1\"   \"BCL6\"  [7] \"BIRC3\"    \"BRAF\"     \"BTG1\"     \"BTG2\"     \"BTK\"      \"CD19\" [13] \"CD70\"     \"CD79B\"    \"CD83\"     \"CDKN2A\"   \"CREBBP\"   \"DDX3X\" [19] \"DTX1\"     \"DUSP2\"    \"EDRF1\"    \"EIF4A2\"   \"EP300\"    \"ETS1\" [25] \"ETV6\"     \"EZH2\"     \"FAS\"      \"FCGR2B\"   \"FOXC1\"    \"FOXO1\" [31] \"GNA13\"    \"GRHPR\"    \"HLA-A\"    \"HLA-B\"    \"HNRNPD\"   \"IRF4\" [37] \"IRF8\"     \"ITPKB\"    \"JUNB\"     \"KLF2\"     \"KLHL14\"   \"KLHL6\" [43] \"KMT2D\"    \"MEF2B\"    \"MPEG1\"    \"MYD88\"    \"NFKBIA\"   \"NFKBIE\" [49] \"NFKBIZ\"   \"NOL9\"     \"NOTCH1\"   \"NOTCH2\"   \"OSBPL10\"  \"PIM1\" [55] \"PIM2\"     \"PRDM1\"    \"PRDM15\"   \"PRKDC\"    \"PRRC2C\"   \"PTPN1\" [61] \"RFTN1\"    \"S1PR2\"    \"SETD1B\"   \"SGK1\"     \"SOCS1\"    \"SPEN\" [67] \"STAT3\"    \"STAT6\"    \"TBCC\"     \"TBL1XR1\"  \"TET2\"     \"TMEM30A\" [73] \"TMSB4X\"   \"TNFAIP3\"  \"TNFRSF14\" \"TOX\"      \"TP53\"     \"TP73\" [79] \"UBE2A\"    \"WEE1\"     \"XBP1\"     \"ZFP36L1\" # Genes with hotspots considered  hotspot_features = grep(\"HOTS\",model_feats,invert=F,value=T)  hotspot_features [1] \"MYD88HOTSPOT\" SV_genes = grep(\"_SV\",model_feats,invert=F,value=T) SV_genes [1] \"BCL2_SV\" \"BCL6_SV\""},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/full_walkthrough.html","id":"load-and-subset-the-training-data","dir":"Articles","previous_headings":"","what":"Load and subset the training data","title":"DLBCLone: Full Walkthrough","text":"GAMBLR.predict package bundled base-3 mutation status matrix training data set. code shows load data frame (setting sample_id row names) subset features described . train model, also need ground truth labels. come another bundled file, sample metadata samples mutation matrix just loaded.","code":"best_opt_model_matrix <- readr::read_tsv(   system.file(\"extdata/all_full_status.tsv\",              package = \"GAMBLR.predict\")) %>%   tibble::column_to_rownames(\"sample_id\")   # keep only the columns you want to use for your model best_opt_model_matrix = best_opt_model_matrix  %>%   select(all_of(model_genes),all_of(hotspot_features),all_of(SV_genes)) dlbcl_meta <- readr::read_tsv(system.file(\"extdata/dlbcl_meta_with_dlbclass.tsv\",package = \"GAMBLR.predict\"))  # remove rows that don't correspond to unambiguous classes (i.e. drop composites) dlbcl_meta_clean <- filter(   dlbcl_meta,   lymphgen %in% c(\"MCD\",\"EZB\",\"BN2\",\"N1\",\"ST2\",\"Other\") )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/full_walkthrough.html","id":"make_and_annotate_umap","dir":"Articles","previous_headings":"","what":"make_and_annotate_umap","title":"DLBCLone: Full Walkthrough","text":"","code":"mu_everything = make_and_annotate_umap(   best_opt_model_matrix,   dlbcl_meta_clean,   core_features = list(     ST2=c(\"SGK1\",\"DUSP2\",\"TET2\",\"SOCS1\"),     N1=\"NOTCH1\",     EZB=c(\"EZH2\",\"BCL2_SV\"),     MCD=c(\"MYD88HOTSPOT\",\"CD79B\",\"PIM1\"),     BN2=c(\"BCL6_SV\",\"NOTCH2\",\"SPEN\",\"CD70\")   ) )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/full_walkthrough.html","id":"make_umap_scatterplot","dir":"Articles","previous_headings":"","what":"make_umap_scatterplot","title":"DLBCLone: Full Walkthrough","text":"","code":"make_umap_scatterplot(   mu_everything$df,   drop_other = F )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/full_walkthrough.html","id":"dlbclone_optimize_params","dir":"Articles","previous_headings":"","what":"DLBCLone_optimize_params","title":"DLBCLone: Full Walkthrough","text":"","code":"best_opt_model = DLBCLone_optimize_params(     mu_everything$features,    dlbcl_meta_clean,   umap_out = mu_everything,   truth_classes = c(\"MCD\",\"EZB\",\"BN2\",\"N1\",\"ST2\",\"Other\"),   optimize_for_other = T,   min_k=5,   max_k=13 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/full_walkthrough.html","id":"make_alluvial","dir":"Articles","previous_headings":"","what":"make_alluvial","title":"DLBCLone: Full Walkthrough","text":"DLBCLone outgroup optimization (“wo”) w weighted, o optimized .","code":"make_alluvial(best_opt_model,pred_column = \"DLBCLone_wo\",pred_name = \"DLBCLone_wo\")"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/full_walkthrough.html","id":"dlbclone_predict","dir":"Articles","previous_headings":"","what":"DLBCLone_predict","title":"DLBCLone: Full Walkthrough","text":"","code":"test_sample = \"00-14595_tumorC\"  pred_train <- DLBCLone_predict(   mutation_status = best_opt_model_matrix[test_sample,],   optimized_model = best_opt_model ) knitr::kable(head(pred_train$prediction))"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/full_walkthrough.html","id":"predicting-one-training-sample","dir":"Articles","previous_headings":"","what":"predicting one training sample","title":"DLBCLone: Full Walkthrough","text":"","code":"test_sample = \"00-14595_tumorC\"  pred_train <- DLBCLone_predict(   mutation_status = best_opt_model_matrix[test_sample,],   optimized_model = best_opt_model ) knitr::kable(head(pred_train$prediction))"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/full_walkthrough.html","id":"make_neighborhood_plot","dir":"Articles","previous_headings":"","what":"make_neighborhood_plot","title":"DLBCLone: Full Walkthrough","text":"","code":"make_neighborhood_plot(   single_sample_prediction_output = pred_train,   this_sample_id = \"00-14595_tumorC\",   prediction_in_title = TRUE,   add_circle = TRUE,   label_column = \"DLBCLone_wo\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/full_walkthrough.html","id":"nearest_neighbor_heatmap","dir":"Articles","previous_headings":"","what":"nearest_neighbor_heatmap","title":"DLBCLone: Full Walkthrough","text":"","code":"nearest_neighbor_heatmap(   this_sample_id = \"00-14595_tumorC\",   DLBCLone_model = pred_train,   font_size = 7 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/predict_samples.html","id":"preamble","dir":"Articles","previous_headings":"","what":"Preamble","title":"Classifying samples with DLBCLone","text":"practical use DLBCLone model infer class/subtype samples based genetic features present. accomplished DLBCLone_predict function. tutorial assumes start previously saved model, restore disk re-activate shown previous tutorial.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/predict_samples.html","id":"predicting-the-class-of-a-single-sample","dir":"Articles","previous_headings":"","what":"predicting the class of a single sample","title":"Classifying samples with DLBCLone","text":"demonstration, ’ll use model predict class one training samples. normal, particularly sensible, application DLBCLone ’s convenient way demonstrate DLBCLone_predict works. Since ’re using sample training data, can directly recycle genetic feature matrix model via all_features_optimized$features. meta-features data frame, also need enable drop_extra feature.","code":"test_sample = \"00-14595_tumorC\"  pred_train <- DLBCLone_predict(   mutation_status = all_features_optimized$features[test_sample,],   optimized_model = all_features_optimized,   drop_extra = TRUE )  knitr::kable(head(pred_train$prediction))"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/predict_samples.html","id":"visualizing-a-the-neighborhood-of-a-single-classification","dir":"Articles","previous_headings":"","what":"Visualizing a the neighborhood of a single classification","title":"Classifying samples with DLBCLone","text":"Used visualizing neighbors selected, umap plot produced showcasing test sample interest trained neighbors helped determine labeling. single_sample_prediction_output output list predict_single_sample_DLBCLone training_predictions training predictions DLBCLone_optimize_params (e.g. optimized_model$df) this_sample_id Character sample ID neighborhood plot generated prediction_in_title TRUE: includes predicted label plot title add_circle Plot include circle surrounding set neighbors, helpful identification  Generates heatmap feature values nearest neighbors specified sample, based DLBCLone model object. visualization helps inspect feature profiles samples similar query sample. this_sample_id sample ID plot nearest neighbor heatmap DLBCLone_model DLBCLone model object, can output DLBCLone_optimize_params, DLBCLone_KNN, DLBCLone_predict truth_column column name predictions data frame contains ground truth labels (default: “lymphgen”) metadata_cols optional character vector additional metadata columns include heatmap annotations clustering_dis distance metric use clustering rows (default: “binary”) font_size font size heatmap text (default: 14)","code":"make_neighborhood_plot(   single_sample_prediction_output = pred_train,   this_sample_id = \"00-14595_tumorC\",   prediction_in_title = TRUE,   add_circle = TRUE,   label_column = \"DLBCLone_wo\" ) nearest_neighbor_heatmap(   this_sample_id = \"00-14595_tumorC\",   DLBCLone_model = pred_train,   font_size = 7 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/predict_samples.html","id":"make_neighborhood_plot","dir":"Articles","previous_headings":"","what":"make_neighborhood_plot","title":"Classifying samples with DLBCLone","text":"Used visualizing neighbors selected, umap plot produced showcasing test sample interest trained neighbors helped determine labeling. single_sample_prediction_output output list predict_single_sample_DLBCLone training_predictions training predictions DLBCLone_optimize_params (e.g. optimized_model$df) this_sample_id Character sample ID neighborhood plot generated prediction_in_title TRUE: includes predicted label plot title add_circle Plot include circle surrounding set neighbors, helpful identification","code":"make_neighborhood_plot(   single_sample_prediction_output = pred_train,   this_sample_id = \"00-14595_tumorC\",   prediction_in_title = TRUE,   add_circle = TRUE,   label_column = \"DLBCLone_wo\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/predict_samples.html","id":"nearest_neighbor_heatmap","dir":"Articles","previous_headings":"","what":"nearest_neighbor_heatmap","title":"Classifying samples with DLBCLone","text":"Generates heatmap feature values nearest neighbors specified sample, based DLBCLone model object. visualization helps inspect feature profiles samples similar query sample. this_sample_id sample ID plot nearest neighbor heatmap DLBCLone_model DLBCLone model object, can output DLBCLone_optimize_params, DLBCLone_KNN, DLBCLone_predict truth_column column name predictions data frame contains ground truth labels (default: “lymphgen”) metadata_cols optional character vector additional metadata columns include heatmap annotations clustering_dis distance metric use clustering rows (default: “binary”) font_size font size heatmap text (default: 14)","code":"nearest_neighbor_heatmap(   this_sample_id = \"00-14595_tumorC\",   DLBCLone_model = pred_train,   font_size = 7 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/umap.html","id":"preamble","dir":"Articles","previous_headings":"","what":"Preamble","title":"Exploring and selecting features","text":"GAMBLR.predict comes bundled data can used explore genetic features associated DLBCL genetic subgroups. code loads two bundled files needed examples.","code":"mutation_status <- readr::read_tsv(system.file(\"extdata/all_full_status.tsv\",package = \"GAMBLR.predict\")) %>%   tibble::column_to_rownames(\"sample_id\")   dlbcl_meta <- readr::read_tsv(system.file(\"extdata/dlbcl_meta_with_dlbclass.tsv\",package = \"GAMBLR.predict\"))  dlbcl_meta_clean <- filter(dlbcl_meta,                           lymphgen %in% c(\"MCD\",\"EZB\",\"BN2\",\"N1\",\"ST2\",\"Other\"))"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/umap.html","id":"determining-features-relevant-to-a-classification","dir":"Articles","previous_headings":"","what":"Determining features relevant to a classification","title":"Exploring and selecting features","text":"create classifier, need know features relevant. can done post-hoc analysis classified data, searching genetic features significantly -represented individual classes. posthoc_feature_enrichment accomplishes using Fisher’s exact test Chi-square test. Frequencies differences can visualized bar plots forest plots. required inputs commonly used arguments : sample_metadata Data frame containing sample metadata class labels. Normally, bundled training metadata. features Feature matrix one row per sample one column per mutation feature. Normally, bundled training mutation matrix (.e., mutation_status per code shown ) label_column Name column containing class labels (default: “lymphgen”). rarely/never need change unless working different training classifier. truth_classes Vector class labels consider (default: BN2, EZB, MCD, ST2, N1). rarely/never need change unless working different training classifier. method Method determine top features: “frequency” abundant features, “chi_square” top differentially mutated features classes vs classes “fisher” compare -class vs -class feature frequency across classes (default : “frequency”). Note: forest plot generated method either chi_square fisher View stacked bar plot output:  View forest plot output:","code":"plots<- posthoc_feature_enrichment(   sample_metadata = dlbcl_meta_clean,   features = mutation_status,   method = \"fisher\" ) plots$bar_plot plots$forest_plot"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/umap.html","id":"subsetting-to-your-selected-features","dir":"Articles","previous_headings":"","what":"Subsetting to your selected features","title":"Exploring and selecting features","text":"Let’s assume used outputs hand-select set features based analyses. following code shows full feature set can subset selected features.","code":"my_features <- c(   \"ACTB\", \"ACTG1\", \"BCL10\", \"BCL2\", \"BCL2L1\",    \"BCL6\", \"BIRC3\", \"BRAF\", \"BTG1\", \"BTG2\",    \"BTK\", \"CD19\", \"CD70\", \"CD79B\", \"CD83\",    \"CDKN2A\", \"CREBBP\", \"DDX3X\", \"DTX1\", \"DUSP2\",    \"EDRF1\", \"EIF4A2\", \"EP300\", \"ETS1\", \"ETV6\",    \"EZH2\", \"FAS\", \"FCGR2B\", \"FOXC1\", \"FOXO1\",    \"GNA13\", \"GRHPR\", \"HLA-A\", \"HLA-B\", \"HNRNPD\",    \"IRF4\", \"IRF8\", \"ITPKB\", \"JUNB\", \"KLF2\",    \"KLHL14\", \"KLHL6\", \"KMT2D\", \"MEF2B\", \"MPEG1\",    \"MYD88\", \"NFKBIA\", \"NFKBIE\", \"NFKBIZ\", \"NOL9\",    \"NOTCH1\", \"NOTCH2\", \"OSBPL10\", \"PIM1\", \"PIM2\",    \"PRDM1\", \"PRDM15\", \"PRKDC\", \"PRRC2C\", \"PTPN1\",    \"RFTN1\", \"S1PR2\", \"SETD1B\", \"SGK1\", \"SOCS1\",    \"SPEN\", \"STAT3\", \"STAT6\", \"TBCC\", \"TBL1XR1\",    \"TET2\", \"TMEM30A\", \"TMSB4X\", \"TNFAIP3\", \"TNFRSF14\",    \"TOX\", \"TP53\", \"TP73\", \"UBE2A\", \"WEE1\",    \"XBP1\", \"ZFP36L1\", \"MYD88HOTSPOT\", \"BCL2_SV\", \"BCL6_SV\" ) selected_mutation_status <- mutation_status %>%    select(all_of(my_features))"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/umap.html","id":"make_and_annotate_umap","dir":"Articles","previous_headings":"","what":"make_and_annotate_umap","title":"Exploring and selecting features","text":"can exremely useful see UMAP converts feature space 2D representation. make_and_annotate_umap function generate initial UMAP projection samples based mutation features provided . foundational step running DLBCLone. Importantly, provided optional umap_out argument, project (new) data locked latent representation deterministic way. convenience function make_umap_scatterplot allows view result scatter plot, marginal density plots help show dense representation class across X Y axes. can help scrutinize well samples class separate.","code":"mu_all = make_and_annotate_umap(   selected_mutation_status,   dlbcl_meta_clean ) make_umap_scatterplot(mu_all$df)"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/umap.html","id":"re-using-an-existing-umap-model","dir":"Articles","previous_headings":"","what":"Re-using an existing UMAP model","title":"Exploring and selecting features","text":"hood, running make_and_annotate_umap existing model (provided via umap_out) determine coordinates every sample deterministic way. step iteratively places sample latent space using model generated last step based distances samples original training data. case, location samples doesn’t influence sample placed. result, coordinates point slightly different original UMAP always identical whenever function re-run way. important means result deterministic regardless order specify samples.","code":"mu_all_proj = make_and_annotate_umap(   mu_all$features,   dlbcl_meta_clean,   umap_out = mu_all )  make_umap_scatterplot(   mu_all_proj$df )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/umap.html","id":"core-features-and-meta-features","dir":"Articles","previous_headings":"","what":"Core features and meta-features","title":"Exploring and selecting features","text":"addition choosing different feature combinations, may able achieve better separation certain classes assigning certain features higher weight. accomplished specifying vector feature names values multiplied 1.5 using core_features argument. argument can also used specify features grouped meta-features.","code":"meta_feats <- list(     ST2=c(\"SGK1\",\"DUSP2\",\"TET2\",\"SOCS1\"),     N1=\"NOTCH1\",     EZB=c(\"EZH2\",\"BCL2_SV\"),     MCD=c(\"MYD88HOTSPOT\",\"CD79B\",\"PIM1\"),     BN2=c(\"BCL6_SV\",\"NOTCH2\",\"SPEN\",\"CD70\") )  mu_weighted = make_and_annotate_umap(   selected_mutation_status,   dlbcl_meta_clean,   core_features = meta_feats    ) make_umap_scatterplot(mu_weighted$df)"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"preamble","dir":"Articles","previous_headings":"","what":"Preamble","title":"Applying a DLBCLone model to new data","text":"guide demonstrate steps training custom DLBCLone model applying classify new samples.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"preparing-your-test-data","dir":"Articles","previous_headings":"","what":"Preparing your test data","title":"Applying a DLBCLone model to new data","text":"use trained DLBCLone model data, need (minimum) either MAF file mutation status matrix genes (features) used generate model. , learn generate mutation status matrix using one published cohorts, sequenced LySeqST panel. translocation status BCL2, BCL6 etc want include model, also need second table includes translocation status sample. generally refer metadata table. Together, MAF metadata files used assemble feature matrix used UMAP KNN approximation samples. example, extract BCL2 BCL6 status directly output LymphGen. also use LymphGen classification evaluate accuracy. Importantly, need LymphGen result test data can useful sanity check UMAP model performance. MAF metadata samples (form LymphGen output) bundled package. code loads files restructures columns make compatible downstream functions. model ’re using used base-3 encoding (0,1,2), means synonymous mutations considered genes. know -front (find ) genes applies , can encode data consistently. MAF file doesn’t contain synonyous mutations, sure use model trained coding mutations.","code":"library(GAMBLR.open) library(GAMBLR.utils)  library(tidyverse) library(GAMBLR.predict)  lymphgen_test = \"extdata/lyseq_validation/LySeqST_only_unaugmented_vaf.lymphgen_calls.no_cnvs.with_sv.no_A53.tsv\" valid_metadata <- readr::read_tsv(   system.file(lymphgen_test,package = \"GAMBLR.predict\")) %>%   rename(     sample_id = Sample.Name,     lymphgen = Subtype.Prediction   ) %>%   mutate(     BCL2.Translocation = if_else(BCL2.Translocation == \"yes\", \"POS\", BCL2.Translocation),     BCL2.Translocation = if_else(BCL2.Translocation == \"no\", \"NEG\", BCL2.Translocation),     BCL2.Translocation = if_else(BCL2.Translocation == \"Not Available\", \"NA\", BCL2.Translocation),     BCL6.Translocation = if_else(BCL6.Translocation == \"yes\", \"POS\", BCL6.Translocation),     BCL6.Translocation = if_else(BCL6.Translocation == \"no\", \"NEG\", BCL6.Translocation),     BCL6.Translocation = if_else(BCL6.Translocation == \"Not Available\", \"NA\", BCL6.Translocation)   ) maf_test = \"extdata/lyseq_validation/LySeqST_merged_unaugmented_vaf.maf\" valid_maf_vaf_dir <- readr::read_tsv(system.file(maf_test,package = \"GAMBLR.predict\")) %>%     mutate(     sample_id = Tumor_Sample_Barcode   ) #convert to S3 object for compatability valid_maf_vaf <- create_maf_data(     maf_df = valid_maf_vaf_dir,     genome_build = \"grch37\"   ) %>%     mutate(Chromosome = as.character(Chromosome))"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"sv-status","dir":"Articles","previous_headings":"","what":"SV status","title":"Applying a DLBCLone model to new data","text":"example, extract BCL2 BCL6 status directly output LymphGen. also use LymphGen classification evaluate accuracy. Importantly, need LymphGen result test data can useful sanity check UMAP model performance. MAF metadata samples (form LymphGen output) bundled package. code loads files restructures columns make compatible downstream functions.","code":"library(GAMBLR.open) library(GAMBLR.utils)  library(tidyverse) library(GAMBLR.predict)  lymphgen_test = \"extdata/lyseq_validation/LySeqST_only_unaugmented_vaf.lymphgen_calls.no_cnvs.with_sv.no_A53.tsv\" valid_metadata <- readr::read_tsv(   system.file(lymphgen_test,package = \"GAMBLR.predict\")) %>%   rename(     sample_id = Sample.Name,     lymphgen = Subtype.Prediction   ) %>%   mutate(     BCL2.Translocation = if_else(BCL2.Translocation == \"yes\", \"POS\", BCL2.Translocation),     BCL2.Translocation = if_else(BCL2.Translocation == \"no\", \"NEG\", BCL2.Translocation),     BCL2.Translocation = if_else(BCL2.Translocation == \"Not Available\", \"NA\", BCL2.Translocation),     BCL6.Translocation = if_else(BCL6.Translocation == \"yes\", \"POS\", BCL6.Translocation),     BCL6.Translocation = if_else(BCL6.Translocation == \"no\", \"NEG\", BCL6.Translocation),     BCL6.Translocation = if_else(BCL6.Translocation == \"Not Available\", \"NA\", BCL6.Translocation)   ) maf_test = \"extdata/lyseq_validation/LySeqST_merged_unaugmented_vaf.maf\" valid_maf_vaf_dir <- readr::read_tsv(system.file(maf_test,package = \"GAMBLR.predict\")) %>%     mutate(     sample_id = Tumor_Sample_Barcode   ) #convert to S3 object for compatability valid_maf_vaf <- create_maf_data(     maf_df = valid_maf_vaf_dir,     genome_build = \"grch37\"   ) %>%     mutate(Chromosome = as.character(Chromosome))"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"synonymous-mutations","dir":"Articles","previous_headings":"","what":"Synonymous mutations","title":"Applying a DLBCLone model to new data","text":"model ’re using used base-3 encoding (0,1,2), means synonymous mutations considered genes. know -front (find ) genes applies , can encode data consistently. MAF file doesn’t contain synonyous mutations, sure use model trained coding mutations.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"metadata","dir":"Articles","previous_headings":"","what":"metadata","title":"Applying a DLBCLone model to new data","text":"","code":"knitr::kable(head(valid_metadata))"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"lyseq-features","dir":"Articles","previous_headings":"","what":"lyseq features","title":"Applying a DLBCLone model to new data","text":"LySeqST sequencing panel includes following genes. order train classifier compatible panel, need subset training data ensure genes included training.","code":"lyseq_genes <- c(   \"TNFRSF14\", \"SPEN\", \"ID3\", \"ARID1A\", \"RRAGC\",   \"BCL10\", \"CD58\", \"NOTCH2\", \"FCGR2B\", \"FCRLA\",   \"FAS\", \"CCND1\", \"BIRC3\", \"ATM\", \"KMT2D\",   \"STAT6\", \"BTG1\", \"FOXO1\", \"B2M\", \"MAP2K1\",   \"IDH2\", \"CHD2\", \"CREBBP\", \"SOCS1\", \"IL4R\",   \"PLCG2\", \"TP53\", \"STAT5B\", \"STAT3\", \"CD79B\",   \"GNA13\", \"BCL2\", \"TCF3\", \"S1PR2\", \"JAK3\",   \"MEF2B\", \"DNMT3A\", \"XPO1\", \"CXCR4\", \"SF3B1\",   \"PTPN1\", \"XBP1\", \"EP300\", \"MYD88\", \"SETD2\",   \"RHOA\", \"NFKBIZ\", \"TBL1XR1\", \"KLHL6\", \"TET2\",   \"PIM1\", \"CCND3\", \"TMEM30A\", \"PRDM1\", \"SGK1\",   \"TNFAIP3\", \"CARD11\", \"POT1\", \"BRAF\", \"EZH2\",   \"UBR5\", \"MYC\", \"NOTCH1\", \"TRAF2\", \"P2RY8\",   \"BTK\", \"TP73\", \"NOL9\", \"SEMA4A\", \"PRRC2C\",   \"BTG2\", \"ITPKB\", \"SEC24C\", \"EDRF1\", \"WEE1\",   \"MPEG1\", \"ETS1\", \"DTX1\", \"SETD1B\", \"NFKBIA\",   \"ZFP36L1\", \"CIITA\", \"MBTPS1\", \"IRF8\", \"ACTG1\",   \"KLHL14\", \"MED16\", \"CD70\", \"JUNB\", \"KLF2\",   \"CD79A\", \"DYSF\", \"DUSP2\", \"BCL2L1\", \"PRDM15\",   \"RFTN1\", \"OSBPL10\", \"EIF4A2\", \"BCL6\", \"IRF4\",   \"FOXC1\", \"CD83\",    \"HLA-A\", \"HLA-B\", \"PRRC2A\", \"TBCC\", \"INTS1\",   \"ACTB\", \"PIK3CG\", \"PRKDC\", \"TOX\", \"CDKN2A\",   \"GRHPR\", \"DDX3X\", \"PIM2\", \"UBE2A\", \"ETV6\",   \"MS4A1\", \"CD19\", \"HNRNPD\", \"NFKBIE\", \"TMSB4X\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"making-a-compatible-feature-matrix","dir":"Articles","previous_headings":"","what":"Making a compatible feature matrix","title":"Applying a DLBCLone model to new data","text":"create mutation feature matrix assemble_genetic_features. can include mutation status structural variant status BCL2, BCL6, MYC. default, synonymous mutations encoded 1 SV coding mutations encoded 2. genes synonymous mutations considered specified separately. genes commonly use shown example .","code":"ashm_genes = c(\"ACTB\",\"ACTG1\",\"BCL2\",\"BCL6\",\"BIRC3\",      \"BTG1\",\"BTG2\",\"CD83\",\"CIITA\",\"CXCR4\",\"DDX3X\",          \"DTX1\",\"DUSP2\",\"ETS1\",\"ETV6\",\"GRHPR\",\"ID3\",       \"IL4R\",\"IRF4\",\"IRF8\",\"ITPKB\",\"KLF2\",\"KLHL6\",      \"MEF2B\",\"MS4A1\",\"MYC\",\"NFKBIZ\",\"OSBPL10\",\"PIM1\",      \"PIM2\",\"PTPN1\",\"RFTN1\",\"S1PR2\",\"SGK1\",\"SOCS1\",      \"TMSB4X\",\"WEE1\",\"XBP1\",\"ZFP36L1\")  lyseq_valid = assemble_genetic_features(   these_samples_metadata = valid_metadata,   sv_from_metadata = c(BCL2 = 'BCL2.Translocation', BCL6 = 'BCL6.Translocation'),   genes=lyseq_genes,   maf_with_synon = valid_maf_vaf,   hotspot_genes = \"MYD88\",   synon_genes=ashm_genes )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"load-the-training-data","dir":"Articles","previous_headings":"","what":"Load the training data","title":"Applying a DLBCLone model to new data","text":"training, mutation matrix bundled training data must subset exclude features part panel.","code":"all_full_status_train <- readr::read_tsv(system.file(\"extdata/all_full_status.tsv\",package = \"GAMBLR.predict\")) %>%   tibble::column_to_rownames(\"sample_id\")  dlbcl_meta <- readr::read_tsv(system.file(\"extdata/dlbcl_meta_with_dlbclass.tsv\",package = \"GAMBLR.predict\"))  dlbcl_meta_clean <- filter(dlbcl_meta,                           lymphgen %in% c(\"MCD\",\"EZB\",\"BN2\",\"N1\",\"ST2\",\"Other\")) ncol(all_full_status_train) [1] 202 ncol(lyseq_valid) [1] 125 lyseq_train <- all_full_status_train %>%   select(all_of(names(lyseq_valid)))"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"create-training-data-umap","dir":"Articles","previous_headings":"","what":"Create training data UMAP","title":"Applying a DLBCLone model to new data","text":"Visually confirm separation training samples based LymphGen class labels.","code":"mu_lyseq_train = make_and_annotate_umap(   lyseq_train,   dlbcl_meta_clean,   core_features = list(     ST2=c(\"SGK1\",\"DUSP2\",\"TET2\",\"SOCS1\"),     N1=\"NOTCH1\",     EZB=c(\"EZH2\",\"BCL2_SV\"),     MCD=c(\"MYD88HOTSPOT\",\"CD79B\",\"PIM1\"),     BN2=c(\"BCL6_SV\",\"NOTCH2\",\"SPEN\",\"CD70\")   ) ) make_umap_scatterplot(mu_lyseq_train$df)"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"visualize-umap","dir":"Articles","previous_headings":"","what":"Visualize UMAP","title":"Applying a DLBCLone model to new data","text":"Visually confirm separation training samples based LymphGen class labels.","code":"make_umap_scatterplot(mu_lyseq_train$df)"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"train-the-model","dir":"Articles","previous_headings":"","what":"Train the model","title":"Applying a DLBCLone model to new data","text":"Train optimize model using training data custom feature set.","code":"lyseq_features_optimized = DLBCLone_optimize_params(     mu_lyseq_train$features,    dlbcl_meta_clean,   umap_out = mu_lyseq_train,   truth_classes = c(\"MCD\",\"EZB\",\"BN2\",\"N1\",\"ST2\",\"Other\"),   min_k=11,   max_k=21 )  lyseq_features_optimized <- DLBCLone_activate( # Activates optimized model setting the UMAP projection   lyseq_features_optimized,    force = TRUE ) lyseq_features_optimized <- DLBCLone_activate( # Activates optimized model setting the UMAP projection   lyseq_features_optimized,    force = TRUE ) transforming each data point individually using the provided UMAP model. This will take some time. done model given to function"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"training-accuracy","dir":"Articles","previous_headings":"","what":"Training accuracy","title":"Applying a DLBCLone model to new data","text":"Check classification accuracy optimized classifier (DLBCLone_wo) training data set.","code":"make_alluvial(lyseq_features_optimized,   pred_column=\"DLBCLone_wo\") Warning: Duplicated aesthetics after name standardisation: fill Warning in to_lodes_form(data = data, axes = axis_ind, discern = params$discern): Some strata appear at multiple axes. Warning in to_lodes_form(data = data, axes = axis_ind, discern = params$discern): Some strata appear at multiple axes."},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"sanity-check-feature-incidence-in-the-test-data","dir":"Articles","previous_headings":"","what":"Sanity check feature incidence in the test data","title":"Applying a DLBCLone model to new data","text":"","code":"pred_check <- DLBCLone_predict(   mutation_status = lyseq_valid,   optimized_model = lyseq_features_optimized,   check_frequencies = TRUE ) pred_check$plot"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"apply-the-model-to-the-test-data","dir":"Articles","previous_headings":"","what":"Apply the model to the test data","title":"Applying a DLBCLone model to new data","text":"UMAP working , see similar level separation test samples UMAP space. Since LymphGen classifications test samples, can check . order visualize , metadata need attached UMAP projection new samples. hopefully see roughly placement samples scatterplot relative training samples.","code":"pred_valid_lyseq_all <- DLBCLone_predict(   mutation_status = lyseq_valid,   optimized_model = lyseq_features_optimized )  knitr::kable(head(pred_valid_lyseq_all$prediction)) projected_with_meta = left_join(pred_valid_lyseq_all$projection, select(valid_metadata,sample_id,lymphgen)) Joining with `by = join_by(sample_id)` head(projected_with_meta) sample_id         V1         V2 lymphgen 1 00-14595_tumorA -0.8899906  4.3290272      EZB 2 00-14595_tumorB -0.8807368  4.2731309      EZB 3 00-14595_tumorC -0.9343416  4.1505504      EZB 4 00-14595_tumorD -0.6999627  4.4204650      EZB 5 00-15201_tumorA -1.2391076  0.3538165    Other 6 00-15201_tumorB  0.7030904 -4.2771802       N1 unique(projected_with_meta$lymphgen) [1] \"EZB\"         \"Other\"       \"N1\"          \"BN2/N1\"      \"BN2\"  [6] \"MCD\"         \"ST2\"         \"EZB/MCD/ST2\" \"EZB/ST2\"     \"BN2/EZB\" [11] \"BN2/MCD\"     \"EZB/MCD\" #drop composites projected_with_meta = filter(projected_with_meta,!grepl(\"/\",lymphgen)) make_umap_scatterplot(projected_with_meta) test_sample = \"92-38267_tumorB\"  make_neighborhood_plot(   single_sample_prediction_output = pred_valid_lyseq_all,   this_sample_id = test_sample,   prediction_in_title = TRUE,   add_circle = TRUE,   label_column = \"DLBCLone_wo\" ) nearest_neighbor_heatmap(   this_sample_id = test_sample,   DLBCLone_model = pred_valid_lyseq_all,   font_size = 8 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"sanity-check-the-umap","dir":"Articles","previous_headings":"","what":"Sanity check the UMAP","title":"Applying a DLBCLone model to new data","text":"UMAP working , see similar level separation test samples UMAP space. Since LymphGen classifications test samples, can check . order visualize , metadata need attached UMAP projection new samples. hopefully see roughly placement samples scatterplot relative training samples.","code":"projected_with_meta = left_join(pred_valid_lyseq_all$projection, select(valid_metadata,sample_id,lymphgen)) Joining with `by = join_by(sample_id)` head(projected_with_meta) sample_id         V1         V2 lymphgen 1 00-14595_tumorA -0.8899906  4.3290272      EZB 2 00-14595_tumorB -0.8807368  4.2731309      EZB 3 00-14595_tumorC -0.9343416  4.1505504      EZB 4 00-14595_tumorD -0.6999627  4.4204650      EZB 5 00-15201_tumorA -1.2391076  0.3538165    Other 6 00-15201_tumorB  0.7030904 -4.2771802       N1 unique(projected_with_meta$lymphgen) [1] \"EZB\"         \"Other\"       \"N1\"          \"BN2/N1\"      \"BN2\"  [6] \"MCD\"         \"ST2\"         \"EZB/MCD/ST2\" \"EZB/ST2\"     \"BN2/EZB\" [11] \"BN2/MCD\"     \"EZB/MCD\" #drop composites projected_with_meta = filter(projected_with_meta,!grepl(\"/\",lymphgen)) make_umap_scatterplot(projected_with_meta)"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"make_neighborhood_plot","dir":"Articles","previous_headings":"","what":"make_neighborhood_plot","title":"Applying a DLBCLone model to new data","text":"","code":"test_sample = \"92-38267_tumorB\"  make_neighborhood_plot(   single_sample_prediction_output = pred_valid_lyseq_all,   this_sample_id = test_sample,   prediction_in_title = TRUE,   add_circle = TRUE,   label_column = \"DLBCLone_wo\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"nearest_neighbor_heatmap","dir":"Articles","previous_headings":"","what":"nearest_neighbor_heatmap","title":"Applying a DLBCLone model to new data","text":"","code":"nearest_neighbor_heatmap(   this_sample_id = test_sample,   DLBCLone_model = pred_valid_lyseq_all,   font_size = 8 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"accuracy-assessment","dir":"Articles","previous_headings":"","what":"Accuracy Assessment","title":"Applying a DLBCLone model to new data","text":"Finally, lets assess accuracy validation set comparing dlbclone_predict predictions LymphGen results previously generated.  Another way visualize results via Oncoplot (using GAMBLR.viz::prettyOncoplot).","code":"pred_vs_original = left_join(pred_valid_lyseq_all$prediction,valid_metadata)  #collapse composites into group-COMP pred_vs_original = tidy_lymphgen(pred_vs_original,lymphgen_column_in = \"lymphgen\",lymphgen_column_out = \"lymphgen_tidy\")  #convert composites into their primary class pred_vs_original = mutate(pred_vs_original,lymphgen_basic = gsub(\"-COMP\",\"\",lymphgen_tidy))  make_alluvial(list(predictions=pred_vs_original),   pred_column = \"DLBCLone_wo\",   group_order = c(\"MCD\",\"BN2\",\"ST2\",\"EZB\",\"N1\",\"Other\"),   truth_column = \"lymphgen_basic\") library(GAMBLR.viz) ashm_genes = intersect(ashm_genes,lyseq_genes)  silent_show = rep(\"Silent\",length(ashm_genes)) names(silent_show)=ashm_genes # add hotspot annotation valid_maf_vaf$hot_spot = NA valid_maf_vaf = mutate(valid_maf_vaf,hot_spot=ifelse(Hugo_Symbol==\"MYD88\" & HGVSp_Short==\"p.L265P\",TRUE,FALSE)) prettyOncoplot(these_samples_metadata = pred_vs_original,    maf_df = valid_maf_vaf,   metadataColumns = c(\"lymphgen_basic\",\"DLBCLone_w\",\"DLBCLone_wo\"),   minMutationPercent = 1,   cluster_rows = T,   highlightHotspots = T,   genes = lyseq_genes,   pctFontSize = 3,   fontSizeGene = 3,   hideSideBarplot = T,   simplify_annotation = T,   hide_annotations = c(\"DLBCLone_wo\",\"DLBCLone_w\"),   include_noncoding = as.list(silent_show),   sortByColumns = c(\"DLBCLone_wo\",\"lymphgen_basic\"))"},{"path":"https://morinlab.github.io/GAMBLR.predict/articles/validation.html","id":"oncoplot","dir":"Articles","previous_headings":"","what":"Oncoplot","title":"Applying a DLBCLone model to new data","text":"Another way visualize results via Oncoplot (using GAMBLR.viz::prettyOncoplot).","code":"library(GAMBLR.viz) ashm_genes = intersect(ashm_genes,lyseq_genes)  silent_show = rep(\"Silent\",length(ashm_genes)) names(silent_show)=ashm_genes # add hotspot annotation valid_maf_vaf$hot_spot = NA valid_maf_vaf = mutate(valid_maf_vaf,hot_spot=ifelse(Hugo_Symbol==\"MYD88\" & HGVSp_Short==\"p.L265P\",TRUE,FALSE)) prettyOncoplot(these_samples_metadata = pred_vs_original,    maf_df = valid_maf_vaf,   metadataColumns = c(\"lymphgen_basic\",\"DLBCLone_w\",\"DLBCLone_wo\"),   minMutationPercent = 1,   cluster_rows = T,   highlightHotspots = T,   genes = lyseq_genes,   pctFontSize = 3,   fontSizeGene = 3,   hideSideBarplot = T,   simplify_annotation = T,   hide_annotations = c(\"DLBCLone_wo\",\"DLBCLone_w\"),   include_noncoding = as.list(silent_show),   sortByColumns = c(\"DLBCLone_wo\",\"lymphgen_basic\"))"},{"path":"https://morinlab.github.io/GAMBLR.predict/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Kostiantyn Dreval. Author, maintainer. Ryan Morin. Author.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Dreval K, Morin R (2025). GAMBLR.predict: ML functionality classification B-cell lymphomas. R package version 1.2.","code":"@Manual{,   title = {GAMBLR.predict: ML functionality for classification of B-cell lymphomas},   author = {Kostiantyn Dreval and Ryan Morin},   year = {2025},   note = {R package version 1.2}, }"},{"path":"https://morinlab.github.io/GAMBLR.predict/index.html","id":"dlbclone","dir":"","previous_headings":"","what":"DLBCLone","title":"ML functionality for classification of B-cell lymphomas","text":"package contains functionality apply DLBCLone classifier identify genetic subgroups Diffuse Large B-cell Lymphoma (DLBCL) described preprint Klossok et al (2025). repository includes Shiny interface pre-trained models. can launch running GAMBLR.predict:::DLBCLone_shiny(). want classify samples using existing model, relevant functions get started : DLBCLone_load_optimized() DLBCLone_predict().","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/index.html","id":"cfldfl-random-forest-classifier","dir":"","previous_headings":"","what":"cFL/dFL random forest classifier","title":"ML functionality for classification of B-cell lymphomas","text":"pakage contains functionaliry apply random forest classifier identify genetic subgroups Follicular Lymphoma cFL/dFL described Blood (2023). function allows classify_fl(). either accepts metadata mutations maf format input data frames assemble matrix perform classification, can also accept matrix prepared advance. Please refer function documentation examples description supported parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/index.html","id":"docker","dir":"","previous_headings":"","what":"Docker","title":"ML functionality for classification of B-cell lymphomas","text":"build docker image, run following command root repository: run docker image, use following command: open browser go http://localhost:8787. can log username rstudio password set command .","code":"docker build -t gamblr.predict . docker run -it --rm -e PASSWORD='some_password' -p 8787:8787 gamblr.predict"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_KNN.html","id":null,"dir":"Reference","previous_headings":"","what":"Run DLBCLone KNN Classification — DLBCLone_KNN","title":"Run DLBCLone KNN Classification — DLBCLone_KNN","text":"Weighted KNN feature (mutation) matrix optional upweighting user-specified \"core\" features, optional exclusion \"hidden\" features, optional optimization explicit outgroup (e.g. \"\"). WARNING: function one core DLBCLone functions. probably using DLBCLone_predict instead!","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_KNN.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run DLBCLone KNN Classification — DLBCLone_KNN","text":"","code":"DLBCLone_KNN(   features_df,   metadata,   core_features = NULL,   core_feature_multiplier = 1.5,   hidden_features = NULL,   min_k = 5,   max_k = 60,   truth_column = \"lymphgen\",   truth_classes = c(\"EZB\", \"BN2\", \"ST2\", \"MCD\", \"N1\", \"Other\"),   other_class = \"Other\",   optimize_for_other = TRUE,   predict_unlabeled = FALSE,   plot_samples = NULL,   DLBCLone_KNN_out = NULL,   seed = 12345,   epsilon = 0.001,   weighted_votes = TRUE,   skip_umap = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_KNN.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run DLBCLone KNN Classification — DLBCLone_KNN","text":"features_df Numeric matrix/data.frame (rows = samples, cols = features). Row names must sample IDs. metadata Data frame least sample_id ground-truth label column given truth_column. core_features Character vector feature names upweight (optional). core_feature_multiplier Numeric multiplier core_features. hidden_features Character vector feature names drop (optional). min_k, max_k Integer K range explore optimizing. truth_column Name metadata column ground-truth class labels. truth_classes Character vector classes consider (including other_class intend optimize ). other_class Name explicit outgroup class (default: \"\"). optimize_for_other Logical; TRUE, computes separate \"\" score (ratio) searches purity threshold; FALSE, treats classes symmetrically. predict_unlabeled TRUE, re-runs KNN classify samples present features_df metadata. plot_samples Optional vector sample_ids keep example plots. DLBCLone_KNN_out Optional prior result; supplied, learned parameters reused (skip optimization). seed Random seed. epsilon Small value added distances weighting. weighted_votes FALSE, neighbors unweighted (equal votes). skip_umap TRUE, skip layout optimization plots end.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_KNN.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run DLBCLone KNN Classification — DLBCLone_KNN","text":"list fields including: predictions Per-sample vote/score summary predicted labels DLBCLone_k_best_k Best K found DLBCLone_k_purity_threshold Best purity threshold (applicable) DLBCLone_k_accuracy Best accuracy metric achieved truth_classes, truth_column Echoed arguments unlabeled_predictions Predictions unlabeled samples (requested) df Annotated layout plotting (built run) plot_truth, plot_predicted ggplots built run","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_KNN.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run DLBCLone KNN Classification — DLBCLone_KNN","text":"version removes hard-coded LymphGen class names instead derives -group classes outgroup column name arguments truth_classes other_class. keeps backward compatibility default LymphGen-like usage.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_KNN_predict.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict DLBCLone Classes for New Samples Using a Trained KNN Model — DLBCLone_KNN_predict","title":"Predict DLBCLone Classes for New Samples Using a Trained KNN Model — DLBCLone_KNN_predict","text":"Applies previously optimized DLBCLone KNN model predict class labels new (test) samples. function combines training test feature matrices, ensures feature compatibility, uses parameters DLBCLone KNN optimization run classify test samples. Optionally, runs iterative mode stable results predicting multiple samples.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_KNN_predict.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict DLBCLone Classes for New Samples Using a Trained KNN Model — DLBCLone_KNN_predict","text":"","code":"DLBCLone_KNN_predict(   train_df,   test_df,   metadata,   DLBCLone_KNN_out,   mode = \"batch\",   truth_column = \"lymphgen\",   other_class = \"Other\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_KNN_predict.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict DLBCLone Classes for New Samples Using a Trained KNN Model — DLBCLone_KNN_predict","text":"train_df Data frame matrix features training samples (rows = samples, columns = features). test_df Data frame matrix features test samples classified. metadata Data frame metadata samples, including least sample_id column. DLBCLone_KNN_out List. Output previous call DLBCLone_KNN containing optimized parameters. (Required) mode Character. \"iterative\", runs KNN prediction test sample individually (recommended stability). core_features Optional character vector feature names upweight KNN calculation. core_feature_multiplier Numeric. Multiplier apply core features (default: 1.5). hidden_features Optional character vector feature names exclude analysis.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_KNN_predict.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict DLBCLone Classes for New Samples Using a Trained KNN Model — DLBCLone_KNN_predict","text":"list containing KNN prediction results test samples, including predicted class labels scores.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_KNN_predict.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict DLBCLone Classes for New Samples Using a Trained KNN Model — DLBCLone_KNN_predict","text":"Ensures feature columns train_df test_df compatible. mode = \"iterative\", runs KNN prediction test sample one time. Uses parameters (e.g., k, feature weights) provided DLBCLone_KNN_out object. Returns structure DLBCLone_KNN, predictions test samples.","code":""},{"path":[]},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_activate.html","id":null,"dir":"Reference","previous_headings":"","what":"Activate a DLBCLone model by embedding its training set once — DLBCLone_activate","title":"Activate a DLBCLone model by embedding its training set once — DLBCLone_activate","text":"Computes UMAP projection model's training features stores inside model object projection_train. already present force = FALSE, returns model unchanged.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_activate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Activate a DLBCLone model by embedding its training set once — DLBCLone_activate","text":"","code":"DLBCLone_activate(   optimized_model,   seed = 12345,   force = FALSE,   store_labeled = TRUE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_activate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Activate a DLBCLone model by embedding its training set once — DLBCLone_activate","text":"optimized_model DLBCLone optimized model (list) contains least $model (frozen uwot model), $features (training feature matrix rownames), $df (training metadata incl. sample_id labels), $best_params$na_option, $truth_column. seed Integer seed reproducibility (passed make_and_annotate_umap). force Logical; TRUE, recompute even projection already present. store_labeled Logical; TRUE, also store pre-joined projection_train_labeled coordinates + truth labels.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_activate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Activate a DLBCLone model by embedding its training set once — DLBCLone_activate","text":"optimized_model list $projection_train added (optionally $projection_train_labeled). data frames containing UMAP coordinates training samples, joined sample_id (requested) truth labels, latter.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_activate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Activate a DLBCLone model by embedding its training set once — DLBCLone_activate","text":"","code":"if (FALSE) { # \\dontrun{  # activating a model after optimization optimized_model <- DLBCLone_optimize(  df = df_LySeqST,  features = feat_status_LySeqST ) activated_model <- DLBCLone_activate(optimized_model) # projection_train is now present and will be used by DLBCLone_predict()  # activating a model after loading from disk  loaded_model <- DLBCLone_load_optimized(  path = \"models\",  name_prefix = \"DLBCLone_LySeqST\") loaded_model <- DLBCLone_activate(loaded_model, force = TRUE) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_ensemble_postprocess.html","id":null,"dir":"Reference","previous_headings":"","what":"Post-process KNN results across K to score consistency, (optionally) refine classified/Other cutoffs per-class and (optionally) assign composite classes — DLBCLone_ensemble_postprocess","title":"Post-process KNN results across K to score consistency, (optionally) refine classified/Other cutoffs per-class and (optionally) assign composite classes — DLBCLone_ensemble_postprocess","text":"Post-process KNN results across K score consistency, (optionally) refine classified/cutoffs per-class (optionally) assign composite classes","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_ensemble_postprocess.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Post-process KNN results across K to score consistency, (optionally) refine classified/Other cutoffs per-class and (optionally) assign composite classes — DLBCLone_ensemble_postprocess","text":"","code":"DLBCLone_ensemble_postprocess(   optimized_model,   assign_composites = FALSE,   other_min = 2,   any_split = TRUE,   min_purity = 0.75,   min_gap = 2,   optimize_per_class = TRUE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_ensemble_postprocess.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Post-process KNN results across K to score consistency, (optionally) refine classified/Other cutoffs per-class and (optionally) assign composite classes — DLBCLone_ensemble_postprocess","text":"optimized_model Output DLBCLone_optimize_params assign_composites Logical; TRUE, samples split votes across multiple -group classes assigned composite class (e.g. \"EZB/MCD\") instead \"\". other_min Integer; comparing across range K values,threshold number K values sample classified re-assigned . Set high value want samples reassigned . any_split Logical; TRUE, split among -group votes across Ks tested triggers reassignment (composite). min_purity Numeric range 0-1; top -group vote share required keep top class instead assigning composite class. min_gap Integer; top minus second -group votes must least gap keep top class. optimize_per_class Logical; TRUE, range thresholds tested per class optimize classification/cutoff. complex approach may yield better results yet fully validated.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_ensemble_postprocess.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Post-process KNN results across K to score consistency, (optionally) refine classified/Other cutoffs per-class and (optionally) assign composite classes — DLBCLone_ensemble_postprocess","text":"list : predictions: updated predictions_df (DLBCLone_wo DLBCLone_wc / DLBCLone_wc_simplified) consistency_report: per-sample counts decision flags","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_load_optimized.html","id":null,"dir":"Reference","previous_headings":"","what":"Load a previously saved DLBCLone model (including UMAP state) — DLBCLone_load_optimized","title":"Load a previously saved DLBCLone model (including UMAP state) — DLBCLone_load_optimized","text":"Reconstructs DLBCLone model saved via DLBCLone_save_optimized() restoring serialized model list associated uwot UMAP object. Optionally performs integrity check verify embeddings can reproduced saved state.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_load_optimized.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load a previously saved DLBCLone model (including UMAP state) — DLBCLone_load_optimized","text":"","code":"DLBCLone_load_optimized(   path = \".\",   name_prefix = \"DLBCLone\",   check_integrity = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_load_optimized.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load a previously saved DLBCLone model (including UMAP state) — DLBCLone_load_optimized","text":"path Character scalar. Directory containing saved files. Defaults \".\". name_prefix Character scalar. Common filename prefix used model saved. function looks <name_prefix>_model.rds <name_prefix>_umap.uwot path. Defaults \"DLBCLone\". check_integrity Logical. TRUE, function re-embeds training samples (batch iterative modes, available) confirms coordinates match saved embeddings (within small tolerance). requires saved model list contains projection_train, consequence activating model DLBCLone_activate().","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_load_optimized.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load a previously saved DLBCLone model (including UMAP state) — DLBCLone_load_optimized","text":"list representing reconstructed DLBCLone model, suitable downstream use DLBCLone_predict() utilities expect DLBCLone_model. return, DLBCLone_model$model contains restored uwot model object.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_load_optimized.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load a previously saved DLBCLone model (including UMAP state) — DLBCLone_load_optimized","text":"function expects two files produced DLBCLone_save_optimized(): <name_prefix>_model.rds: serialized list core model components (e.g., features, df, optional test embeddings). <name_prefix>_umap.uwot: serialized uwot UMAP model saved uwot::save_uwot(). check_integrity = TRUE, function computes fresh embeddings via make_and_annotate_umap() compares saved ones. mismatch larger 0.01 either axis throw error.","code":""},{"path":[]},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_load_optimized.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load a previously saved DLBCLone model (including UMAP state) — DLBCLone_load_optimized","text":"","code":"if (FALSE) { # \\dontrun{ # Restore a model for use in a fresh R session DLBCLone_myfeats_opt <- DLBCLone_load_optimized(   path = \".\",   name_prefix = \"DLBCLone_myfeats\" )  # Restore and verify that saved embeddings can be reproduced confirmed_DLBCLone <- DLBCLone_load_optimized(   path = \".\",   name_prefix = \"dlbclone_dlc_test\",   check_integrity = TRUE ) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_optimize_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize parameters for classifying samples using UMAP and k-nearest neighbor — DLBCLone_optimize_params","title":"Optimize parameters for classifying samples using UMAP and k-nearest neighbor — DLBCLone_optimize_params","text":"Optimize parameters classifying samples using UMAP k-nearest neighbor","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_optimize_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize parameters for classifying samples using UMAP and k-nearest neighbor — DLBCLone_optimize_params","text":"","code":"DLBCLone_optimize_params(   combined_mutation_status_df,   metadata_df,   umap_out,   truth_classes = c(\"EZB\", \"MCD\", \"ST2\", \"N1\", \"BN2\", \"Other\"),   other_class = \"Other\",   truth_column = \"lymphgen\",   optimize_for_other = FALSE,   eval_group = NULL,   min_k = 3,   max_k = 23,   verbose = FALSE,   seed = 12345,   maximize = \"balanced_accuracy\",   cap_classification_rate = 1,   exclude_other_for_accuracy = FALSE,   weights_opt = c(TRUE) )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_optimize_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize parameters for classifying samples using UMAP and k-nearest neighbor — DLBCLone_optimize_params","text":"combined_mutation_status_df Data frame one row per sample one column per mutation metadata_df Data frame metadata one row per sample three required columns: sample_id, dataset lymphgen umap_out output previous run make_and_annotate_umap. provided, function use model project data instead re-running UMAP. truth_classes Vector classes use training testing. Default: c(\"EZB\",\"MCD\",\"ST2\",\"N1\",\"BN2\",\"\") optimize_for_other Set TRUE optimize threshold classifying samples \"\" based relative proportion samples near sample UMAP space \"\" label. Rather treating just another class, optimize threshold separate score considers many non-samples neighborhood sample question. parameter change value predicted_label. Instead, predicted_label_optimized column contain optimized label. Default: FALSE eval_group desired, use specify rows evaluated held training rather using samples. NOTE: parameter probably become deprecated! min_k Starting k knn (Default: 3) max_k Ending k knn (Default: 33) verbose Whether print verbose outputs console seed Random seed use reproducibility (default: 12345) maximize Metric use optimization. Either \"sensitivity\" (average sensitivity across classes), \"accuracy\" (actual accuracy across samples) \"balanced_accuracy\" (mean balanced accuracy values across classes). Default: \"balanced_accuracy\"","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_optimize_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimize parameters for classifying samples using UMAP and k-nearest neighbor — DLBCLone_optimize_params","text":"List data frames results parameter optimization including best model, associated knn parameters annotated UMAP output data frame. list also includes predictions \"\" class included training testing.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_optimize_params.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Optimize parameters for classifying samples using UMAP and k-nearest neighbor — DLBCLone_optimize_params","text":"","code":"if (FALSE) { # \\dontrun{  lymphgen_lyseq = GAMBLR.predict::DLBCLone_optimize_params(  dlbcl_status_combined_lyseq,  dlbcl_meta_lyseq_train,  min_k = 5,  max_k=23,  truth_classes = c(\"MCD\",\"EZB\",\"ST2\",\"BN2\",\"Other\")) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict DLBCL genetic subgroup for one or more samples using a pre-trained DLBCLone model — DLBCLone_predict","title":"Predict DLBCL genetic subgroup for one or more samples using a pre-trained DLBCLone model — DLBCLone_predict","text":"Projects new samples frozen UMAP space pre-trained DLBCLone model assigns subtype labels weighted k-NN classifier. function aligns features input matrix training model, optionally constructs/weights meta-features (*_feats) based model's core_features, prevents label leakage excluding test sample neighbor set.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict DLBCL genetic subgroup for one or more samples using a pre-trained DLBCLone model — DLBCLone_predict","text":"","code":"DLBCLone_predict(   mutation_status,   optimized_model,   fill_missing = FALSE,   drop_extra = FALSE,   check_frequencies = FALSE,   dry_run = FALSE,   seed = 12345,   verbose = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict DLBCL genetic subgroup for one or more samples using a pre-trained DLBCLone model — DLBCLone_predict","text":"mutation_status Data frame matrix one row per sample one column per feature (typically binary count mutation indicators). Row names must unique sample IDs. Columns correspond features model trained . Extra/missing features handled drop_extra fill_missing. optimized_model pre-trained DLBCLone model object returned DLBCLone_load_optimized() (saved via DLBCLone_save_optimized()). Must contain fields $model (uwot UMAP), $features (training feature matrix), $df (training metadata incl. sample_id, lymphgen), $best_params (e.g., na_option, threshold, use_weights), $k_DLBCLone_w. Optional fields include $core_features, $core_feature_multiplier, $purity_DLBCLone_w, $score_thresh_DLBCLone_w, $truth_classes. fill_missing Logical. TRUE, features exist model absent mutation_status added set zero samples (warning). FALSE, missing model features cause error. Defaults FALSE. drop_extra Logical. TRUE, features present mutation_status seen model training dropped (message). FALSE, extra features cause error. Defaults FALSE. check_frequencies Logical. TRUE, function run prediction. Instead, computes returns per-feature frequency comparison test training cohorts (binary presence/absence), along ggplot highlighting large deviations. Defaults FALSE. dry_run Logical. TRUE, return preprocessed/weighted test feature matrix (column alignment core-feature weighting/meta-feature construction) without running projection classification. Defaults FALSE. seed Integer seed passed embedding/projection steps reproducibility. Defaults 12345. annotate_accuracy Logical. Currently unused (reserved future output annotations). Defaults FALSE.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict DLBCL genetic subgroup for one or more samples using a pre-trained DLBCLone model — DLBCLone_predict","text":"list elements (fields may vary depending options/model): prediction: data frame per-sample predictions joined test UMAP coordinates (V1, V2) vote metrics. projection: data frame projected test coordinates. umap_input: model's training feature matrix (optimized_model$features). model: frozen UMAP model used projection (optimized_model$model). features_df: processed test feature matrix used projection/classification (rows = samples). df: alias prediction (kept compatibility). metadata: model's training metadata (optimized_model$df). type: string identifier \"DLBCLone_predict\". unprocessed_votes: predictions post-processing. (optional) core_features, core_feature_multiplier, mutation_status: included core-feature weighting applied.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict DLBCL genetic subgroup for one or more samples using a pre-trained DLBCLone model — DLBCLone_predict","text":"Feature alignment. Columns mutation_status must match model's training features. Set drop_extra=TRUE drop unexpected columns, fill_missing=TRUE add missing model columns (filled zero). , adjustment, columns exactly match (including order), function stops error. Core features & meta-features. optimized_model$core_features : list feature groups, function creates meta-features (columns suffixed \"_feats\") (weighted) mean group's members. core_feature_multiplier list, group-specific numeric weights applied. character vector, core features may multiplicatively -weighted core_feature_multiplier match training scale already appear weighted input. Projection & classification. training test samples projected frozen UMAP space (retraining) via make_and_annotate_umap(..., umap_out=optimized_model, ret_model=FALSE). test sample, neighbors drawn projected training set test sample removed prevent self-label leakage. Labels assigned using weighted_knn_predict_with_conf() k=optimized_model$k_DLBCLone_w, confidence threshold best_params$threshold, optional distance weighting best_params$use_weights, max_neighbors. other_class currently fixed \"\". Post-processing (optional). model contains $purity_DLBCLone_w /$score_thresh_DLBCLone_w, raw vote outputs passed process_votes() derive DLBCLone_w DLBCLone_wo decisions using score ratio criteria. available, $truth_classes used order/interpret group labels. Early-return modes. check_frequencies=TRUE: returns list ggplot object frequency deviation data frame; projection/prediction. dry_run=TRUE: returns processed test feature matrix (alignment/weighting); projection/prediction.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict.html","id":"errors-and-messages","dir":"Reference","previous_headings":"","what":"Errors and messages","title":"Predict DLBCL genetic subgroup for one or more samples using a pre-trained DLBCLone model — DLBCLone_predict","text":"function stops feature columns reconciled (see drop_extra, fill_missing), , alignment, column order/identity exactly match training features. Messages emitted dropping/adding features core-feature weighting inferred/applied skipped.","code":""},{"path":[]},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict DLBCL genetic subgroup for one or more samples using a pre-trained DLBCLone model — DLBCLone_predict","text":"","code":"if (FALSE) { # \\dontrun{ # Typical usage model <- DLBCLone_load_optimized(path = \"models\", name_prefix = \"DLBCLone_LySeqST\") # Inspect distribution shifts without running classification freq_chk <- DLBCLone_predict(   mutation_status = my_panelX_matrix,   optimized_model = model,   check_frequencies = TRUE ) print(freq_chk$plot); head(freq_chk$data)  preds <- DLBCLone_predict(   mutation_status = feat_status_LySeqST,  # rows = samples, cols = features   optimized_model = model,   drop_extra = TRUE,    # drop unexpected columns   fill_missing = TRUE   # add any missing model columns as zeros ) head(preds$prediction)   # Dry run to see the meta-features after alignment/weighting processed <- DLBCLone_predict(   mutation_status = my_panelX_matrix,   optimized_model = model,   dry_run = TRUE ) colnames(processed)   } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict_mixture_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict DLBCLone Class Membership Using a Trained Gaussian Mixture Model — DLBCLone_predict_mixture_model","title":"Predict DLBCLone Class Membership Using a Trained Gaussian Mixture Model — DLBCLone_predict_mixture_model","text":"Applies previously trained supervised Gaussian mixture model (GMM) UMAP-projected data DLBCLone subtypes. Assigns class predictions optionally reclassifies samples \"\" based probability density thresholds.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict_mixture_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict DLBCLone Class Membership Using a Trained Gaussian Mixture Model — DLBCLone_predict_mixture_model","text":"","code":"DLBCLone_predict_mixture_model(   model,   umap_out,   probability_threshold = 0.5,   density_max_threshold = 0.05,   cohort = NULL )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict_mixture_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict DLBCLone Class Membership Using a Trained Gaussian Mixture Model — DLBCLone_predict_mixture_model","text":"model Fitted MclustDA model object, returned DLBCLone_train_mixture_model. umap_out List. Output make_and_annotate_umap, containing data frame UMAP coordinates samples classified model. must projected using UMAP model generated using training data. probability_threshold Numeric. Minimum posterior probability required assign class (default: 0.5). density_max_threshold Numeric. Minimum maximum density required assign class (default: 0.05). cohort Optional character. Cohort label annotate predictions.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict_mixture_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict DLBCLone Class Membership Using a Trained Gaussian Mixture Model — DLBCLone_predict_mixture_model","text":"list : gaussian_mixture_model Fitted MclustDA model object predictions Data frame sample IDs, UMAP coordinates, predicted classes, thresholded assignments probability_threshold Probability threshold used \"\" assignment","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict_mixture_model.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict DLBCLone Class Membership Using a Trained Gaussian Mixture Model — DLBCLone_predict_mixture_model","text":"Uses provided MclustDA model predict class membership sample UMAP projection. Computes per-class densities posterior probabilities sample. Samples low maximum probability density reclassified \"\". Returns raw thresholded class assignments, respectively columns DLBCLone_g DLBCLone_go.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_predict_mixture_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict DLBCLone Class Membership Using a Trained Gaussian Mixture Model — DLBCLone_predict_mixture_model","text":"","code":"# Predict on new UMAP data using a trained mixture model: if (FALSE) { # \\dontrun{ result <- DLBCLone_predict_mixture_model(model, umap_out) head(result$predictions) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_save_optimized.html","id":null,"dir":"Reference","previous_headings":"","what":"Save a DLBCLone model (and optionally integrity test embeddings) — DLBCLone_save_optimized","title":"Save a DLBCLone model (and optionally integrity test embeddings) — DLBCLone_save_optimized","text":"Serializes DLBCLone model list associated uwot UMAP object disk. Optionally computes stores reference embeddings enable future integrity checks DLBCLone_load_optimized().","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_save_optimized.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save a DLBCLone model (and optionally integrity test embeddings) — DLBCLone_save_optimized","text":"","code":"DLBCLone_save_optimized(   DLBCLone_model,   base_path = \"./\",   name_prefix = \"DLBCLone\",   include_tests = FALSE,   overwrite = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_save_optimized.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save a DLBCLone model (and optionally integrity test embeddings) — DLBCLone_save_optimized","text":"DLBCLone_model List. model object save. must contain trained UMAP model $model created uwot. base_path Character scalar. Directory write output files. Defaults \"./\". name_prefix Character scalar. Prefix saved files. Files named <name_prefix>_model.rds <name_prefix>_umap.uwot. Defaults \"DLBCLone\". include_tests Logical. TRUE, compute embed two reference embeddings (batch iterative modes) training data store saved model list embedding_batch embedding_iterative. Defaults FALSE. overwrite Logical. FALSE (default), error thrown either target file already exists. Set TRUE replace existing files.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_save_optimized.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save a DLBCLone model (and optionally integrity test embeddings) — DLBCLone_save_optimized","text":"Invisibly, paths two written files (invisibly). Called side effect writing .rds .uwot files.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_save_optimized.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Save a DLBCLone model (and optionally integrity test embeddings) — DLBCLone_save_optimized","text":"UMAP model stored separately using uwot::save_uwot() removed list prior writing .rds, avoid duplication. include_tests = TRUE, function calls make_and_annotate_umap() twice create reproducible embeddings can verified later check_integrity = TRUE DLBCLone_load_optimized().","code":""},{"path":[]},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_save_optimized.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save a DLBCLone model (and optionally integrity test embeddings) — DLBCLone_save_optimized","text":"","code":"if (FALSE) { # \\dontrun{ # Save a trained model; error if files exist DLBCLone_save_optimized(   DLBCLone_model = trained_model,   base_path = \"save_optimized/trial_folder\",   name_prefix = \"test_A\" ) } # } if (FALSE) { # \\dontrun{ # Save with embedded test embeddings, overwriting if present DLBCLone_save_optimized(   DLBCLone_model = trained_model,   base_path = \"save_optimized/trial_folder\",   name_prefix = \"test_A\",   include_tests = TRUE,   overwrite = TRUE ) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_shiny.html","id":null,"dir":"Reference","previous_headings":"","what":"Run the DLBCLone Shiny App — DLBCLone_shiny","title":"Run the DLBCLone Shiny App — DLBCLone_shiny","text":"Launches Shiny application interactive exploration.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_shiny.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run the DLBCLone Shiny App — DLBCLone_shiny","text":"","code":"DLBCLone_shiny(...)"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_summarize_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize and Export DLBCLone Model Results — DLBCLone_summarize_model","title":"Summarize and Export DLBCLone Model Results — DLBCLone_summarize_model","text":"Generates saves set summary plots tables DLBCLone model, including UMAP scatterplots, alluvial plots, oncoplots. Results saved PDF files directory named provided base name.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_summarize_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize and Export DLBCLone Model Results — DLBCLone_summarize_model","text":"","code":"DLBCLone_summarize_model(base_name, optimized_model)"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_summarize_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize and Export DLBCLone Model Results — DLBCLone_summarize_model","text":"base_name Character. base name (directory) saving output files. optimized_model List. output DLBCLone optimization, containing predictions, features, metadata.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_summarize_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize and Export DLBCLone Model Results — DLBCLone_summarize_model","text":"return value. Side effect: writes multiple PDF files disk.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_summarize_model.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize and Export DLBCLone Model Results — DLBCLone_summarize_model","text":"Creates directory results exist. Saves UMAP scatterplots samples non-\"\" samples. Generates alluvial plots different DLBCLone predictions Exports oncoplot summarizing mutation classification results. Uses make_umap_scatterplot, make_alluvial, prettyOncoplot visualization.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_summarize_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize and Export DLBCLone Model Results — DLBCLone_summarize_model","text":"","code":"if (FALSE) { # \\dontrun{ DLBCLone_summarize_model(optimized_model = all_features_optimized,                          base_name=\"model_summaries/Lymphgen_all_features\") } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_train_mixture_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Train a Gaussian Mixture Model for DLBCLone Classification — DLBCLone_train_mixture_model","title":"Train a Gaussian Mixture Model for DLBCLone Classification — DLBCLone_train_mixture_model","text":"Fits supervised Gaussian mixture model (GMM) UMAP-projected data using user-provided taxonomy genetic subtypes, excluding samples labeled \"\". Assigns class predictions optionally reclassifies samples \"\" based probability density thresholds. NOTE: related core KNN DLBCLone approach mostly just curiosity.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_train_mixture_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Train a Gaussian Mixture Model for DLBCLone Classification — DLBCLone_train_mixture_model","text":"","code":"DLBCLone_train_mixture_model(   umap_out,   probability_threshold = 0.5,   density_max_threshold = 0.05,   truth_column = \"lymphgen\",   cohort = NULL,   truth_classes = c(\"EZB\", \"MCD\", \"ST2\", \"N1\", \"BN2\", \"Other\") )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_train_mixture_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Train a Gaussian Mixture Model for DLBCLone Classification — DLBCLone_train_mixture_model","text":"umap_out List. Output make_and_annotate_umap, containing data frame UMAP coordinates truth labels. probability_threshold Numeric. Minimum posterior probability required assign class (default: 0.5). density_max_threshold Numeric. Minimum maximum density required assign class (default: 0.05). cohort Optional character. Cohort label annotate predictions.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_train_mixture_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Train a Gaussian Mixture Model for DLBCLone Classification — DLBCLone_train_mixture_model","text":"list : gaussian_mixture_model Fitted MclustDA model object predictions Data frame sample IDs, UMAP coordinates, true labels, predicted classes, thresholded assignments probability_threshold Probability threshold used \"\" assignment","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_train_mixture_model.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Train a Gaussian Mixture Model for DLBCLone Classification — DLBCLone_train_mixture_model","text":"Uses MclustDA fit supervised mixture model UMAP coordinates (V1, V2) class labels. Predicts class membership computes per-class densities sample. Samples low maximum probability density reclassified \"\". Returns raw thresholded class assignments, respectively columns DLBCLone_g DLBCLone_go.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_train_mixture_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Train a Gaussian Mixture Model for DLBCLone Classification — DLBCLone_train_mixture_model","text":"","code":"if (FALSE) { # \\dontrun{  result <- DLBCLone_train_mixture_model(umap_out)  head(result$predictions) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_train_test_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the result of a DLBCLone classification — DLBCLone_train_test_plot","title":"Plot the result of a DLBCLone classification — DLBCLone_train_test_plot","text":"Plot result DLBCLone classification","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_train_test_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the result of a DLBCLone classification — DLBCLone_train_test_plot","text":"","code":"DLBCLone_train_test_plot(   test_df,   train_df,   predictions_df,   other_df,   details,   annotate_accuracy = FALSE,   classes = c(\"BN2\", \"ST2\", \"MCD\", \"EZB\", \"N1\"),   label_offset = 2,   title1 = \"Original Class\",   title2 = \"DLBCLone Predicted Class\",   title3 = \"DLBCLone Predicted Class (Other)\",   base_size = 1 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_train_test_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the result of a DLBCLone classification — DLBCLone_train_test_plot","text":"test_df Data frame containing test data UMAP coordinates train_df Data frame containing training data UMAP coordinates predictions_df Data frame containing predictions UMAP coordinates other_df Data frame containing predictions samples \"\" class details Single-row data frame best parameters DLBCLone_optimize_params annotate_accuracy Set true add labels accuracy values classes Vector classes used training testing label_offset Length label offset accuracy labels title1 additional argument title2 additional argument title3 additional argument","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_train_test_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the result of a DLBCLone classification — DLBCLone_train_test_plot","text":"ggplot object","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/DLBCLone_train_test_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the result of a DLBCLone classification — DLBCLone_train_test_plot","text":"","code":"if (FALSE) { # \\dontrun{ #add the dataset name to the metadata if it's not already #there (required for the plot work) lymphgen_A53_DLBCLone$df$dataset = \"GAMBL\"  DLBCLone_train_test_plot(  test_df = lymphgen_A53_DLBCLone$df,  train_df = lymphgen_A53_DLBCLone$df,  predictions_df = lymphgen_A53_DLBCLone$predictions,  #other_df = lymphgen_A53_DLBCLone$predictions_other,  #required only when \"Other\" was in the truth_classes  details = lymphgen_A53_DLBCLone$best_params,  classes = c(\"MCD\",\"EZB\",\"BN2\",\"ST2\",\"N1\",\"A53\",\"Other\"),  annotate_accuracy=TRUE,label_offset = 1) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/RFmodel_BL.html","id":null,"dir":"Reference","previous_headings":"","what":"BL Classifier model. — RFmodel_BL","title":"BL Classifier model. — RFmodel_BL","text":"random forest model developed described PMID: 36201743. Used classify BL tumours genetic subgroups.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/RFmodel_BL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"BL Classifier model. — RFmodel_BL","text":"","code":"RFmodel_BL"},{"path":[]},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/RFmodel_BL.html","id":"rfmodel-bl","dir":"Reference","previous_headings":"","what":"RFmodel_BL","title":"BL Classifier model. — RFmodel_BL","text":"randomForest model.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/RFmodel_FL.html","id":null,"dir":"Reference","previous_headings":"","what":"FL Classifier model. — RFmodel_FL","title":"FL Classifier model. — RFmodel_FL","text":"random forest model developed described PMID: 37084389. Used classify FL tumours genetic subgroups.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/RFmodel_FL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"FL Classifier model. — RFmodel_FL","text":"","code":"RFmodel_FL"},{"path":[]},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/RFmodel_FL.html","id":"rfmodel-fl","dir":"Reference","previous_headings":"","what":"RFmodel_FL","title":"FL Classifier model. — RFmodel_FL","text":"randomForest model.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/RFmodel_Lacy.html","id":null,"dir":"Reference","previous_headings":"","what":"DLBCL Classifier model. — RFmodel_Lacy","title":"DLBCL Classifier model. — RFmodel_Lacy","text":"random forest model developed reproduce DLBCL grouping approach described PMID: 32187361. Used classify DLBCL tumours HMRN groups.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/RFmodel_Lacy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DLBCL Classifier model. — RFmodel_Lacy","text":"","code":"RFmodel_Lacy"},{"path":[]},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/RFmodel_Lacy.html","id":"rfmodel-lacy","dir":"Reference","previous_headings":"","what":"RFmodel_Lacy","title":"DLBCL Classifier model. — RFmodel_Lacy","text":"randomForest model.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/annotate_hotspots.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate Hotspots. — annotate_hotspots","title":"Annotate Hotspots. — annotate_hotspots","text":"Annotate MAF-like data frome hot_spot column indicating recurrent mutations.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/annotate_hotspots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate Hotspots. — annotate_hotspots","text":"","code":"annotate_hotspots(mutation_maf, ...)"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/annotate_hotspots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate Hotspots. — annotate_hotspots","text":"mutation_maf data frame MAF format. ... parameter. parameters ignored.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/annotate_hotspots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate Hotspots. — annotate_hotspots","text":"data frame one additional column \"hot_spot\".","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/annotate_hotspots.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Annotate Hotspots. — annotate_hotspots","text":"function takes already loaded MAF data frame mutation_maf parameter.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/annotate_hotspots.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate Hotspots. — annotate_hotspots","text":"","code":"my_metadata = get_gambl_metadata() #> Using the bundled metadata in GAMBLR.data... all_coding_ssm = get_coding_ssm(these_samples_metadata = my_metadata,                                 projection = \"grch37\",                                 this_seq_type = \"genome\") %>%                    dplyr::filter(Hugo_Symbol %in% c(\"EZH2\",                                  \"MEF2B\",\"MYD88\",\"KMT2D\")) %>%                    dplyr::arrange(Hugo_Symbol) #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> id_ease: WARNING! 1838 samples in the provided metadata were removed because their seq types are not the same as in the `set_type` argument. Use `verbose = TRUE` to see their IDs. #> after linking with metadata, we have mutations from 817 samples  hot_ssms = annotate_hotspots(all_coding_ssm) hot_ssms %>% dplyr::filter(!is.na(hot_spot)) %>%       dplyr::select(1:5,37,hot_spot) #> genomic_data Object #> Genome Build: grch37  #> Showing first 10 rows: #>    Hugo_Symbol Entrez_Gene_Id Center NCBI_Build Chromosome HGVSp_Short hot_spot #> 1         EZH2              0      .     GRCh37          7     p.Y646N     TRUE #> 2         EZH2              0      .     GRCh37          7     p.Y646H     TRUE #> 3         EZH2              0      .     GRCh37          7     p.Y646N     TRUE #> 4         EZH2              0      .     GRCh37          7     p.Y646F     TRUE #> 5         EZH2              0      .     GRCh37          7     p.Y646N     TRUE #> 6         EZH2              0      .     GRCh37          7     p.Y646N     TRUE #> 7         EZH2              0      .     GRCh37          7     p.Y646F     TRUE #> 8         EZH2              0      .     GRCh37          7     p.Y646S     TRUE #> 9         EZH2              0      .     GRCh37          7     p.Y646S     TRUE #> 10        EZH2              0      .     GRCh37          7     p.Y646F     TRUE"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/assemble_genetic_features.html","id":null,"dir":"Reference","previous_headings":"","what":"Assemble genetic features for UMAP input — assemble_genetic_features","title":"Assemble genetic features for UMAP input — assemble_genetic_features","text":"function assembles matrix genetic features sample, including mutation status, aSHM counts, structural variant status BCL2, BCL6, MYC. supports genome capture sequencing (data) types.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/assemble_genetic_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assemble genetic features for UMAP input — assemble_genetic_features","text":"","code":"assemble_genetic_features(   these_samples_metadata,   sv_from_metadata = c(BCL2 = \"bcl2_ba\", BCL6 = \"bcl6_ba\", MYC = \"myc_ba\"),   genes,   synon_genes,   maf_with_synon,   hotspot_genes,   genome_build = \"grch37\",   sv_value = 2,   synon_value = 1,   coding_value = 2,   include_ashm = FALSE,   annotated_sv,   include_GAMBL_sv = TRUE,   review_hotspots = TRUE,   verbose = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/assemble_genetic_features.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assemble genetic features for UMAP input — assemble_genetic_features","text":"these_samples_metadata Data frame sample metadata, must include seq_type sample_id. sv_from_metadata named vector specifies columns containing oncogene translocation status SV annotated metadata name oncogene value column name metadata. column created output \"_SV\". genes Vector gene symbols include. synon_genes Vector gene symbols synonymous mutations (generally subset genes). maf_with_synon MAF data frame including synonymous mutations. hotspot_genes Vector specifying genes hotspot mutations separately annotated. columns named \"HOTSPOT\". work, either specify review_hotspots = TRUE , want full control hotspot annotation, MAF must include column \"hot_spot\" TRUE specifying row corresponding hotspot mutation. sv_value Value assign SV presence (default: 2). synon_value Value assign synonymous mutations (default: 1). coding_value Value assign coding mutations (default: 2). include_ashm Logical; TRUE, use GAMBLR.results::get_ssm_by_region retrieve non-coding mutations gene synon_genes use infer mutation status (default: FALSE). WARNING: feature experimental likely going give comparable results using mix genome capture data. also relies GAMBLR.results, core dependency GAMBLR.predict. annotated_sv Data frame bedpe format annotated SVs GAMBLR.utils::annotate_sv(). provided, oncogene SV status based union SVs data frame metadata columns specified sv_from_metadata. include_GAMBL_sv Logical; TRUE, SVs GAMBLR.results automatically retrieved annotated. WARNING: feature experimental likely going give comparable results using mix genome capture data. also relies GAMBLR.results, core dependency GAMBLR.predict. review_hotspots Logical; TRUE, gene hotspot_genes compatible review_hotspots hotspots annotated. information, see GAMBLR.helpers::review_hotspots verbose Defaults FALSE","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/assemble_genetic_features.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assemble genetic features for UMAP input — assemble_genetic_features","text":"Matrix assembled features sample.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/assemble_genetic_features.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assemble genetic features for UMAP input — assemble_genetic_features","text":"","code":"if (FALSE) { # \\dontrun{ all_meta = get_gambl_metadata() %>%  dplyr::filter(pathology==\"DLBCL\",seq_type==\"genome\")  all_maf = get_all_coding_ssm(all_meta,include_silent=TRUE)  sv_all =get_combined_sv(all_meta)  anno_sv = annotate_sv(sv_all)  feat_mat = assemble_genetic_features(all_meta,                                     genes=c(\"EZH2\",\"SOCS1\",\"PIM1\",                                             \"MYD88\",\"CREBBP\",\"SGK1\",                                             \"NOTCH2\",\"NOTCH1\"),                                     maf_with_synon = all_maf,                                     annotated_sv = anno_sv,                                     synon_genes=c(\"PIM1\",\"SOCS1\")) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/assign_cn_to_ssm.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign CN to SSM. — assign_cn_to_ssm","title":"Assign CN to SSM. — assign_cn_to_ssm","text":"Annotate mutations copy number information.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/assign_cn_to_ssm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign CN to SSM. — assign_cn_to_ssm","text":"","code":"assign_cn_to_ssm(   these_samples_metadata,   maf_data,   seg_data,   projection,   coding_only = FALSE,   assume_diploid = FALSE,   include_silent = FALSE,   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/assign_cn_to_ssm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign CN to SSM. — assign_cn_to_ssm","text":"these_samples_metadata Metadata table one rows specify samples process. maf_data data frame mutations MAF format maf_data object (e.g. get_coding_ssm get_ssm_by_sample). seg_data data frame segmented copy number data seg_data object projection Specified genome projection returned data relative . required inferred maf_df seg_df (provided). coding_only Optional. Set TRUE restrict variants coding space Default work genome-wide variants. assume_diploid Optional, parameter annotates every mutation copy neutral. Default FALSE. include_silent Logical parameter indicating whether include silent mutations coding space. Default FALSE. parameter makes sense coding_only set TRUE. ... additional parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/assign_cn_to_ssm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign CN to SSM. — assign_cn_to_ssm","text":"list containing data frame (MAF-like format) three extra columns: - log.ratio log ratio seg file (NA overlap). - LOH - CN (rounded absolute copy number estimate region based log.ratio, NA overlap found).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/assign_cn_to_ssm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assign CN to SSM. — assign_cn_to_ssm","text":"function takes metadata table returns mutations samples metadata. mutation annotated local copy number state mutated site. user can specify coding mutations interest. , set coding_only = TRUE. necessary, function relies get_ssm_by_samples get_cn_segments obtain required data.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/assign_cn_to_ssm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assign CN to SSM. — assign_cn_to_ssm","text":"","code":"# long-handed way # 1. get some metadata for a collection of samples some_meta = get_gambl_metadata() %>%         dplyr::filter(study==\"FL_Dreval\",         grepl(\"SP\",sample_id)) #> Using the bundled metadata in GAMBLR.data... # 2. Get the SSMs for these samples  ssm_genomes_grch37 = get_coding_ssm(projection = \"grch37\",                                   these_samples_metadata = some_meta) #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> after linking with metadata, we have mutations from 182 samples # peek at the results ssm_genomes_grch37 %>% dplyr::select(1:8) #> genomic_data Object #> Genome Build: grch37  #> Showing first 10 rows: #>    Hugo_Symbol Entrez_Gene_Id Center NCBI_Build Chromosome Start_Position #> 1       HNRNPU              0      .     GRCh37          1      245027102 #> 2         PCLO              0      .     GRCh37          7       82784068 #> 3        MYOM2              0      .     GRCh37          8        2063762 #> 4       CREBBP              0      .     GRCh37         16        3786740 #> 5        IGLL5              0      .     GRCh37         22       23230399 #> 6    HIST1H2BC              0      .     GRCh37          6       26123774 #> 7        SETD2              0      .     GRCh37          3       47088059 #> 8         IRF8              0      .     GRCh37         16       85942737 #> 9       ARID5B              0      .     GRCh37         10       63661999 #> 10      ARID5B              0      .     GRCh37         10       63810677 #>    End_Position Strand #> 1     245027102      + #> 2      82784068      + #> 3       2063762      + #> 4       3786740      + #> 5      23230400      + #> 6      26123774      + #> 7      47088059      + #> 8      85942737      + #> 9      63661999      + #> 10     63810677      +  # 3. Lazily let this function obtain the corresponding seg_data # for the right genome_build cn_list = assign_cn_to_ssm(some_meta,ssm_genomes_grch37) #> Using the bundled CN segments (.seg) calls in GAMBLR.data... #> Running in default mode of any...  cn_list$maf %>% dplyr::select(1:8,log.ratio,CN) #> genomic_data Object #> Genome Build: grch37  #> Showing first 10 rows: #>    Hugo_Symbol Entrez_Gene_Id Center NCBI_Build Chromosome Start_Position #> 1       HNRNPU              0      .     GRCh37          1      245027102 #> 2         PCLO              0      .     GRCh37          7       82784068 #> 3        MYOM2              0      .     GRCh37          8        2063762 #> 4       CREBBP              0      .     GRCh37         16        3786740 #> 5        IGLL5              0      .     GRCh37         22       23230399 #> 6    HIST1H2BC              0      .     GRCh37          6       26123774 #> 7        SETD2              0      .     GRCh37          3       47088059 #> 8         IRF8              0      .     GRCh37         16       85942737 #> 9       ARID5B              0      .     GRCh37         10       63661999 #> 10      ARID5B              0      .     GRCh37         10       63810677 #>    End_Position Strand log.ratio CN #> 1     245027102      + 0.4306932  3 #> 2      82784068      + 0.0000000  2 #> 3       2063762      + 0.0000000  2 #> 4       3786740      + 0.0000000  2 #> 5      23230400      + 0.0000000  2 #> 6      26123774      + 0.0000000  2 #> 7      47088059      + 0.0000000  2 #> 8      85942737      + 1.3219281  5 #> 9      63661999      + 0.5849625  3 #> 10     63810677      + 0.5849625  3 if (FALSE) { # \\dontrun{ # This wouldn't work because the hg38 seg_data is not bundled ssm_genomes_hg38 = get_coding_ssm(projection = \"hg38\",                                   these_samples_metadata = some_meta) cn_list = assign_cn_to_ssm(some_meta,ssm_genomes_hg38)  # Easiest/laziest way: cn_list = assign_cn_to_ssm(projection = \"grch37\")   cn_list$maf %>% dplyr::group_by(Tumor_Sample_Barcode,CN) %>%   dplyr::count() } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/basic_umap_scatterplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Basic UMAP Scatterplot — basic_umap_scatterplot","title":"Basic UMAP Scatterplot — basic_umap_scatterplot","text":"Generates simple UMAP scatterplot visualizing sample clustering separation.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/basic_umap_scatterplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basic UMAP Scatterplot — basic_umap_scatterplot","text":"","code":"basic_umap_scatterplot(   optimized,   plot_samples = NULL,   colour_by = NULL,   truth_column = \"lymphgen\",   pred_column = \"DLBCLone_ko\",   other_label = \"Other\",   title = \"UMAP based on selected features\",   use_plotly = TRUE,   custom_colours = NULL )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/basic_umap_scatterplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Basic UMAP Scatterplot — basic_umap_scatterplot","text":"optimized Data frame containing least V1, V2, sample_id, grouping columns. plot_samples Optional character vector sample_ids label plot colour_by Column name color points . Defaults truth_column. truth_column Name truth/ground-truth column (default: \"lymphgen\"). pred_column Name predicted-class column (default: \"DLBCLone_ko\"). other_label Label used outgroup/unclassified class (default: \"\"). title Plot title. use_plotly Logical; FALSE plot_samples provided, draw static labels. custom_colours Optional named vector colors groups; falls back get_gambl_colours().","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/basic_umap_scatterplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Basic UMAP Scatterplot — basic_umap_scatterplot","text":"ggplot object.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/basic_umap_scatterplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Basic UMAP Scatterplot — basic_umap_scatterplot","text":"","code":"if (FALSE) { # \\dontrun{ my_umap = make_and_annotate_umap(my_data, my_metadata)  basic_umap_scatterplot(my_umap$df,                        plot_samples = \"some_sample_ID\",                        colour_by = \"DLBCLone_ko\") } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/calc_mutation_frequency_bin_region.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Mutation Frequency By Sliding Window. — calc_mutation_frequency_bin_region","title":"Calculate Mutation Frequency By Sliding Window. — calc_mutation_frequency_bin_region","text":"Count number mutations sliding window across region samples.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/calc_mutation_frequency_bin_region.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Mutation Frequency By Sliding Window. — calc_mutation_frequency_bin_region","text":"","code":"calc_mutation_frequency_bin_region(   region,   these_samples_metadata = NULL,   these_sample_ids = NULL,   this_seq_type = \"genome\",   maf_data = NULL,   projection = \"grch37\",   slide_by = 100,   window_size = 1000,   return_format = \"long\",   min_count_per_bin = 0,   return_count = TRUE,   drop_unmutated = FALSE,   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/calc_mutation_frequency_bin_region.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Mutation Frequency By Sliding Window. — calc_mutation_frequency_bin_region","text":"region string describing genomic region \"chrom:start-end\" format. region must specified format separate chromosome, start_pos, end_pos arguments. these_samples_metadata Optional data frame containing sample_id column. providing maf file, seq_type also required column. these_sample_ids Optional vector sample IDs. Output subset IDs present vector. this_seq_type Optional vector seq_types include heatmap. Default \"genome\". Uses default seq_type priority samples >1 seq_type. maf_data Optional maf data frame. subset rows Tumor_Sample_Barcode matches provided sample IDs metadata table. provided, maf data obtained get_ssm_by_regions(). projection Specify genome build use. Required. Default grch37. slide_by Slide size sliding window. Default 100. window_size Size sliding window. Default 1000. return_format Return format mutations. Accepted inputs \"long\" \"wide\". Long returns data frame one sample ID/window per row. Wide returns matrix one sample ID per row one window per column. Using \"wide\" format retain samples windows regardless drop_unmutated min_count_per_bin parameters. min_count_per_bin Minimum counts per bin, default 0. Setting greater 0 drop unmutated windows return_format long. return_count Boolean statement return mutation count per window (TRUE) binary mutated/unmutated status (FALSE). Default TRUE. drop_unmutated Boolean whether drop windows 0 mutations. effective \"long\" return format. ... additional parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/calc_mutation_frequency_bin_region.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Mutation Frequency By Sliding Window. — calc_mutation_frequency_bin_region","text":"Either matrix long tidy table counts per window.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/calc_mutation_frequency_bin_region.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Mutation Frequency By Sliding Window. — calc_mutation_frequency_bin_region","text":"function called return mutation frequency given region, either provided input maf data frame GAMBL maf data. Regions specified region parameter. Alternatively, region interest can also specified calling function chromosome, start_pos, end_pos parameters. function operates single region. return matrix sliding window counts multiple regions, see calc_mutation_frequency_bin_regions.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/calc_mutation_frequency_bin_region.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Mutation Frequency By Sliding Window. — calc_mutation_frequency_bin_region","text":"","code":"myc_region = \"8:128747680-128753674\"  myc_mut_freq = calc_mutation_frequency_bin_region(region = myc_region,                                                   slide_by = 10,                                                   window_size = 10000) #> Using the bundled metadata in GAMBLR.data... #> processing bins of size 10000 across 5994 bp region #> Using GAMBLR.data::get_ssm_by_region... #> Using the bundled metadata in GAMBLR.data... #> Joining with `by = join_by(sample_id)` #> Joining with `by = join_by(window_start)` dplyr::arrange(myc_mut_freq,desc(mutation_count)) #> # A tibble: 612,000 × 3 #>    sample_id                 bin         mutation_count #>    <chr>                     <chr>                <int> #>  1 BLGSP-71-26-00399-01A-01E 8_128747680             41 #>  2 BLGSP-71-26-00399-01A-01E 8_128747690             41 #>  3 BLGSP-71-26-00399-01A-01E 8_128747700             41 #>  4 BLGSP-71-26-00399-01A-01E 8_128747710             41 #>  5 BLGSP-71-26-00399-01A-01E 8_128747720             41 #>  6 BLGSP-71-26-00399-01A-01E 8_128747730             41 #>  7 BLGSP-71-26-00399-01A-01E 8_128747740             41 #>  8 BLGSP-71-26-00399-01A-01E 8_128747750             41 #>  9 BLGSP-71-26-00399-01A-01E 8_128747760             41 #> 10 BLGSP-71-26-00399-01A-01E 8_128747770             41 #> # ℹ 611,990 more rows"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/calc_mutation_frequency_bin_regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Mutation counts across sliding windows for multiple regions. — calc_mutation_frequency_bin_regions","title":"Mutation counts across sliding windows for multiple regions. — calc_mutation_frequency_bin_regions","text":"Obtain long tidy wide matrix mutation counts across sliding windows multiple regions.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/calc_mutation_frequency_bin_regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mutation counts across sliding windows for multiple regions. — calc_mutation_frequency_bin_regions","text":"","code":"calc_mutation_frequency_bin_regions(   regions_list = NULL,   regions_bed = NULL,   these_samples_metadata = NULL,   these_sample_ids = NULL,   this_seq_type = \"genome\",   maf_data = NULL,   projection = \"grch37\",   region_padding = 1000,   drop_unmutated = FALSE,   skip_regions = NULL,   only_regions = NULL,   slide_by = 100,   window_size = 500,   return_format = \"wide\",   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/calc_mutation_frequency_bin_regions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mutation counts across sliding windows for multiple regions. — calc_mutation_frequency_bin_regions","text":"regions_list Named vector regions format c(name1 = \"chr:start-end\", name2 = \"chr:start-end\"). neither regions regions_bed specified, function use GAMBLR aSHM region information. regions_bed Data frame regions four columns (chrom, start, end, name). these_samples_metadata Metadata least sample_id column. providing maf data frame, seq_type also required. these_sample_ids Vector sample IDs. Metadata subset sample IDs present vector. this_seq_type Optional vector seq_types include heatmap. Default \"genome\". Uses default seq_type priority samples >1 seq_type. maf_data Optional maf data frame. subset rows Tumor_Sample_Barcode matches provided sample IDs metadata table. provided, maf data obtained get_ssm_by_regions(). projection Genome build function operate . Ensure matches provided regions maf data correct chr prefix handling. Default \"grch37\". region_padding Amount pad start end coordinates . Default 1000. drop_unmutated Whether drop bins 0 mutations. returning matrix format, drop bins mutations samples. skip_regions Optional character vector genes exclude default aSHM regions. only_regions Optional character vector genes include default aSHM regions. slide_by Slide size sliding window. Default 100. window_size Size sliding window. Default 500. return_format Return format mutations. Accepted inputs \"long\" \"wide\". Long returns data frame one sample ID/window per row. Wide returns matrix one sample ID per row one window per column. Using \"wide\" format retain samples windows regardless drop_unmutated min_count_per_bin parameters. Default wide. ... additional parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/calc_mutation_frequency_bin_regions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mutation counts across sliding windows for multiple regions. — calc_mutation_frequency_bin_regions","text":"table mutation counts sliding windows across one regions. May long wide.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/calc_mutation_frequency_bin_regions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mutation counts across sliding windows for multiple regions. — calc_mutation_frequency_bin_regions","text":"function takes metadata table these_samples_metadata parameter internally calls calc_mutation_frequency_bin_region (internally calls get_ssm_by_regions). retrieve mutation counts sliding windows across one regions. May optionally provide combination maf data frame, existing metadata, regions data frame named vector.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/calc_mutation_frequency_bin_regions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mutation counts across sliding windows for multiple regions. — calc_mutation_frequency_bin_regions","text":"","code":"#load metadata.  my_meta = get_gambl_metadata() #> Using the bundled metadata in GAMBLR.data...  dlbcl_bl_meta = dplyr::filter(my_meta, pathology %in% c(\"DLBCL\", \"BL\"))    #get ashm regions  some_regions = create_bed_data(grch37_ashm_regions,                                 fix_names = \"concat\",                                 concat_cols = c(\"gene\",\"region\"),                                 sep=\"-\")  print(some_regions) #> BED Data Object #> Genome Build: grch37  #> Showing first 10 rows: #>    chrom     start       end           name region regulatory_comment #> 1      1   6661482   6662702     KLHL21-TSS    TSS               <NA> #> 2      1  23885584  23885835        ID3-TSS    TSS               <NA> #> 3      1  28832551  28836339       RCC1-TSS    TSS               <NA> #> 4      1  31229012  31232011     LAPTM5-TSS    TSS               <NA> #> 5      1 150550814 150552135    MCL1-intron intron               <NA> #> 6      2  88904839  88909096 EIF2Ak3-intron intron               <NA> #> 7      2  88925456  88927581    EIF2Ak3-TSS    TSS               <NA> #> 8      2 232572640 232574297       PTMA-TSS    TSS               <NA> #> 9      2 157669490 157671299      FCRL3-TSS    TSS               <NA> #> 10     1 203274698 203275778    BTG2-intron intron    active_promoter  mut_count_matrix <- calc_mutation_frequency_bin_regions(    these_samples_metadata = dlbcl_bl_meta,    regions_bed = some_regions  ) #> id_ease: WARNING! 1783 samples in the provided metadata were removed because their seq types are not the same as in the `set_type` argument. Use `verbose = TRUE` to see their IDs. dim(mut_count_matrix) #> [1]   763 14697 tail(mut_count_matrix[,c(1:10)]) #> # A tibble: 6 × 10 #>   sample_id `1_6661382` `1_6661482` `1_6661582` `1_6661682` `1_6661782` #>   <chr>           <int>       <int>       <int>       <int>       <int> #> 1 SP59456             0           0           0           0           0 #> 2 SP59460             0           0           0           0           0 #> 3 SU-DHL-10           0           0           0           0           0 #> 4 SU-DHL-4            0           0           0           0           0 #> 5 Seraphina           0           0           0           0           0 #> 6 Thomas              0           0           0           0           0 #> # ℹ 4 more variables: `1_6661882` <int>, `1_6661982` <int>, `1_6662082` <int>, #> #   `1_6662182` <int>"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/chapuy_features.html","id":null,"dir":"Reference","previous_headings":"","what":"Features for DLBCL grouping by Chapuy method. — chapuy_features","title":"Features for DLBCL grouping by Chapuy method. — chapuy_features","text":"named list data frames lists needed assemble matrix classify DLBCL tumors according Chapuy method described PMID: 29713087.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/chapuy_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Features for DLBCL grouping by Chapuy method. — chapuy_features","text":"","code":"chapuy_features"},{"path":[]},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/chapuy_features.html","id":"chapuy-features","dir":"Reference","previous_headings":"","what":"chapuy_features","title":"Features for DLBCL grouping by Chapuy method. — chapuy_features","text":"named list.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/check_excess_params.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Excess Params — check_excess_params","title":"Check Excess Params — check_excess_params","text":"Function checking excessive parameter names. function notify user unavailable parameters called given given function. function designed work internal function-call already available GAMBLR functions.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/check_excess_params.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Excess Params — check_excess_params","text":"","code":"check_excess_params(...)"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/check_excess_params.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Excess Params — check_excess_params","text":"... Parameters check.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/check_excess_params.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Excess Params — check_excess_params","text":"Nothing","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/check_excess_params.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check Excess Params — check_excess_params","text":"Catch function calls containing unsupported arguments.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/check_for_missing_features.html","id":null,"dir":"Reference","previous_headings":"","what":"Check matrix against missing features. — check_for_missing_features","title":"Check matrix against missing features. — check_for_missing_features","text":"Operate matrix supplied user check features missing compared provided set.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/check_for_missing_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check matrix against missing features. — check_for_missing_features","text":"","code":"check_for_missing_features(incoming_matrix, feature_set)"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/check_for_missing_features.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check matrix against missing features. — check_for_missing_features","text":"incoming_matrix incoming matrix checked missing features. feature_set feature set.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/check_for_missing_features.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check matrix against missing features. — check_for_missing_features","text":"matrix column names correspond features provided set","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_bl.html","id":null,"dir":"Reference","previous_headings":"","what":"Classify BL samples into genetic subgroups. — classify_bl","title":"Classify BL samples into genetic subgroups. — classify_bl","text":"Assemble binary feature matrix use random forest prediction model classify BL tumors genetic subgroups. Please see PMID 36201743 genetic subgroups BL.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_bl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classify BL samples into genetic subgroups. — classify_bl","text":"","code":"classify_bl(   these_samples_metadata,   maf_data,   projection = \"grch37\",   output = \"both\",   ashm_cutoff = 3 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_bl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classify BL samples into genetic subgroups. — classify_bl","text":"these_samples_metadata metadata data frame contains sample_id column ids samples classified. Required input. maf_data MAF data frame used matrix assembling. maf columns can provided, required \"Hugo_Symbol\", \"NCBI_Build\", \"Chromosome\", \"Start_Position\", \"End_Position\", \"Variant_Classification\", \"HGVSp_Short\", \"Tumor_Sample_Barcode\". Required input. projection projection samples. Defaults grch37. output output returned prediction done. Can one predictions, matrix, . Defaults . ashm_cutoff Numeric value indicating number mutations binarizing aSHM feature. Recommended use default value (3).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_bl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classify BL samples into genetic subgroups. — classify_bl","text":"data frame classification, binary matrix used classification, ","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_bl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Classify BL samples into genetic subgroups. — classify_bl","text":"","code":"if (FALSE) { # \\dontrun{ test_meta <- get_gambl_metadata()  %>%     filter(pathology == \"BL\") maf <- get_ssm_by_samples(     these_samples_metadata = test_meta ) predictions <- classify_bl(      these_samples_metadata = test_meta,      maf_data = maf ) predictions <- classify_bl(      these_samples_metadata = test_meta,      maf_data = maf,      output = \"predictions\" ) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl.html","id":null,"dir":"Reference","previous_headings":"","what":"Classify DLBCLs according to genetic subgroups. — classify_dlbcl","title":"Classify DLBCLs according to genetic subgroups. — classify_dlbcl","text":"Using user-provided GAMBLR.data-retrieved data, function assemble matrix according approach Chapuy et al (2018) Lacy et al (2020) classifiers. Since neither classifiers publicly released, implemented solution closely (> 92% accuracy) recapitulates systems. classifier Chapuy et al, constructed matrix used calculate class probability using bundled feature weights obtained reproduction classifier. Lacy et al classifier, matrix used prediction random forest model, supplied GAMBLR.predict package. Following modification Lacy classifier described Runge et al (PMID 33010029), specifying method function hmrn also consider truncating mutations NOTCH1 separate N1 subgroup.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classify DLBCLs according to genetic subgroups. — classify_dlbcl","text":"","code":"classify_dlbcl(   these_samples_metadata,   maf_data,   only_maf_data = FALSE,   seg_data,   sv_data,   projection = \"grch37\",   this_seq_type = \"genome\",   output = \"both\",   method = \"chapuy\",   adjust_ploidy = TRUE,   annotate_sv = TRUE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classify DLBCLs according to genetic subgroups. — classify_dlbcl","text":"these_samples_metadata metadata data frame contains sample_id column ids samples classified. maf_data MAF data frame used matrix assembling. least must contain first 45 columns standard MAF format. only_maf_data Whether restrict matrix generation maf data . supported lymphgenerator mode. Default FALSE (use SV CNV). seg_data SEG data frame used matrix assembling. Must standard SEG formatting, example, returned get_sample_cn_segments. Expected grch37 projection. sv_data SV data frame used matrix assembling. Must standard BEDPE formatting, example, returned get_manta_sv. Expected grch37 projection. projection projection samples. Used adjust ploidy seg data provided annotate SVs necessary. Defaults grch37. this_seq_type used lymphgenerator matrix generation. seq_type defines cutoff consider aSHM site mutate. genomes, assign status mutated based average pathology-adjusted number mutations. capture samples, mutation aSHM site result mutated annotation. argument ignored chapuy, lacy, hmrn methods. output output returned prediction done. Can one predictions, matrix, . Defaults . method Classification method. One chapuy (used default), lacy, hmrn. adjust_ploidy Whether perform ploidy adjustment CNV data. Defaults TRUE (recommended). annotate_sv Whether perform SV annotation supplied SV data frame. Defaults TRUE.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classify DLBCLs according to genetic subgroups. — classify_dlbcl","text":"data frame, binary matrix, ","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Classify DLBCLs according to genetic subgroups. — classify_dlbcl","text":"","code":"if (FALSE) { # \\dontrun{ metadata <- get_gambl_metadata() %>%     filter(pathology == \"DLBCL\")  maf <- get_ssm_by_samples(     these_samples_metadata = metadata )  cnv <- get_cn_segments(     these_samples_metadata = metadata )  bed <- get_manta_sv(     these_samples_metadata = metadata ) predictions_chapuy <- classify_dlbcl(     these_samples_metadata = metadata,     maf_data = maf,     seg_data = cnv,     sv_data = bed,     output = \"predictions\" ) predictions_lacy <- classify_dlbcl(these_samples_metadata = test_meta, method = \"lacy\") predictions_hmrn <- classify_dlbcl(these_samples_metadata = test_meta, method = \"hmrn\", output = \"predictions\") matrix_and_predictions <- classify_dlbcl(these_samples_metadata = test_meta) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl_chapuy.html","id":null,"dir":"Reference","previous_headings":"","what":"Classify DLBCLs according to genetic subgroups of Chapuy et al. — classify_dlbcl_chapuy","title":"Classify DLBCLs according to genetic subgroups of Chapuy et al. — classify_dlbcl_chapuy","text":"Use feature weights NMF model assemble binary matrix classify DLBCL tumors based C0-C5 system Chapuy et al","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl_chapuy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classify DLBCLs according to genetic subgroups of Chapuy et al. — classify_dlbcl_chapuy","text":"","code":"classify_dlbcl_chapuy(   these_samples_metadata,   maf_data,   seg_data,   sv_data,   projection = \"grch37\",   output = \"both\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl_chapuy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classify DLBCLs according to genetic subgroups of Chapuy et al. — classify_dlbcl_chapuy","text":"these_samples_metadata metadata data frame contains sample_id column ids samples classified. maf_data MAF data frame used matrix assembling. least must contain first 45 columns standard MAF format. seg_data SEG data frame used matrix assembling. Must standard SEG formatting, example, returned get_cn_segments. sv_data SV data frame used matrix assembling. Must standard BEDPE formatting, example, returned get_combined_sv. projection projection samples. used retrerive data GAMBLR.data provided. Defaults grch37. output output returned prediction done. Can one predictions, matrix, . Defaults .","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl_chapuy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classify DLBCLs according to genetic subgroups of Chapuy et al. — classify_dlbcl_chapuy","text":"data frame, binary matrix, ","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl_lacy.html","id":null,"dir":"Reference","previous_headings":"","what":"Classify DLBCLs according to genetic subgroups of Lacy et al. — classify_dlbcl_lacy","title":"Classify DLBCLs according to genetic subgroups of Lacy et al. — classify_dlbcl_lacy","text":"Use random forest model classify DLBCL tumors based system Lacy et al","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl_lacy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classify DLBCLs according to genetic subgroups of Lacy et al. — classify_dlbcl_lacy","text":"","code":"classify_dlbcl_lacy(   these_samples_metadata,   maf_data,   seg_data,   sv_data,   projection = \"grch37\",   output = \"both\",   include_N1 = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl_lacy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classify DLBCLs according to genetic subgroups of Lacy et al. — classify_dlbcl_lacy","text":"these_samples_metadata metadata data frame contains sample_id column ids samples classified. maf_data MAF data frame used matrix assembling. least must contain first 45 columns standard MAF format. seg_data SEG data frame used matrix assembling. Must standard SEG formatting, example, returned get_cn_segments. sv_data SV data frame used matrix assembling. Must standard BEDPE formatting, example, returned get_combined_sv. projection projection samples. Used annotate hotspot SSM mutations retreive coordinates shm features. Defaults grch37. output output returned prediction done. Can one predictions, matrix, . Defaults . include_N1 Whether set samples NOTCH1 truncating mutations N1 group described Runge et al (2021). Defaults FALSE.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl_lacy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classify DLBCLs according to genetic subgroups of Lacy et al. — classify_dlbcl_lacy","text":"data frame, binary matrix, ","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl_lymphgenerator.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct LymphGenerator matrix — classify_dlbcl_lymphgenerator","title":"Construct LymphGenerator matrix — classify_dlbcl_lymphgenerator","text":"Use LymphGenerator features construct matrix. Optionally, flatten features biological information.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl_lymphgenerator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct LymphGenerator matrix — classify_dlbcl_lymphgenerator","text":"","code":"classify_dlbcl_lymphgenerator(   these_samples_metadata,   maf_data,   sv_data,   seg_data,   seq_type = \"genome\",   projection = \"grch37\",   output = \"matrix\",   drop_after_flattening = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl_lymphgenerator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct LymphGenerator matrix — classify_dlbcl_lymphgenerator","text":"these_samples_metadata metadata data frame contains sample_id column ids samples classified. Must also contain column pathology. maf_data MAF data frame used matrix assembling. least must contain first 45 columns standard MAF format. sv_data SV data frame used matrix assembling. Must standard BEDPE formatting, example, returned get_combined_sv. seg_data SEG data frame used matrix assembling. Must standard SEG formatting, example, returned get_sample_cn_segments. Must already adjusted ploidy. seq_type String seq type sample set. projection String projection samples. used retrieve data GAMBLR.data provided. Defaults grch37. output output returned. Currently matrix supported. drop_after_flattening Boolean whether remove features (rows) flattening. Defaults FALSE.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_dlbcl_lymphgenerator.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct LymphGenerator matrix — classify_dlbcl_lymphgenerator","text":"binary matrix","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_fl.html","id":null,"dir":"Reference","previous_headings":"","what":"Classify FL samples into cFL/dFL subgroups. — classify_fl","title":"Classify FL samples into cFL/dFL subgroups. — classify_fl","text":"Use random forest prediction model assemble binary matrix use classify FL tummors cFL/dFL. Please see PMID 37084389 details FL genetic subgroups.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_fl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classify FL samples into cFL/dFL subgroups. — classify_fl","text":"","code":"classify_fl(   these_samples_metadata,   maf_data,   matrix,   output = \"predictions\",   model = RFmodel_FL )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_fl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classify FL samples into cFL/dFL subgroups. — classify_fl","text":"these_samples_metadata metadata data frame contains sample_id column ids samples classified. Required input. maf_data MAF data frame used matrix assembling. maf data must grch37 projection. chr prefix discarded present. maf columns can provided, required \"Hugo_Symbol\", \"NCBI_Build\", \"Chromosome\", \"Start_Position\", \"End_Position\", \"Variant_Classification\", \"HGVSp_Short\", \"Tumor_Sample_Barcode\". Required input. matrix Optionally, binary feature matrix already prepared, can provided argument. output output returned prediction done. Can one predictions, matrix, . Defaults predictions. model RF model. Classifier paper describing cFL used. recommended change value parameter. developer-option used testing functionality improvement.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_fl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classify FL samples into cFL/dFL subgroups. — classify_fl","text":"data frame, binary matrix, ","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/classify_fl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Classify FL samples into cFL/dFL subgroups. — classify_fl","text":"","code":"if (FALSE) { # \\dontrun{ meta <- get_gambl_metadata() %>%     filter(pathology == \"FL\")  maf <- get_coding_ssm(     these_samples_metadata = meta,     tool_name = \"publication\" )  classify_fl(     these_samples_metadata = meta,     maf_data = maf ) classify_fl(     these_samples_metadata = meta,     maf_data = maf,     output = \"both\" ) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/collate_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Collate Results — collate_results","title":"Collate Results — collate_results","text":"Bring together collated results selection gambl samples.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/collate_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collate Results — collate_results","text":"","code":"collate_results(   sample_table,   these_samples_metadata,   join_with_full_metadata = FALSE,   seq_type_filter = c(\"genome\", \"capture\"),   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/collate_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collate Results — collate_results","text":"sample_table vector characters sample IDs, data frame sample IDs column (sample_id). provided, overwrite sample subsets provided these_samples_metadata. these_samples_metadata metadata table sample IDs interest. provided, function get metadata available samples. parameter intended use combination join_with_full_metadata. join_with_full_metadata Set TRUE horizontally expand metadata QC results. Default FALSE. these_samples_metadata provided, collated resutls added metadata table. provided, function join collated results available metadata specified seq_type (seq_type_filter). seq_type_filter Filtering criteria get_gambl_metadata these_samples_metadata provided, default genomes captures. ... additional parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/collate_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collate Results — collate_results","text":"data frame collated results.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/collate_results.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Collate Results — collate_results","text":"Currently, function gathers QC metrics (mirage_metrics) collated result. Potentially, future, additional collated results can added function well.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/collate_results.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Collate Results — collate_results","text":"","code":"#load packages library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union  #return collated results for all available samples all_collated = collate_results() #> Using the bundled collated results in GAMBLR.data... #> Using the bundled metadata in GAMBLR.data...  #return available collated results for a metadata subset fl_collated = collate_results(  these_samples_metadata = get_gambl_metadata(    seq_type_filter = \"genome\") %>%     dplyr::filter(pathology == \"FL\")) #> Using the bundled collated results in GAMBLR.data... #> Using the bundled metadata in GAMBLR.data...  #horizontally expand a metadata subset with collated results fl_meta_collated = collate_results(  join_with_full_metadata = TRUE,   these_samples_metadata = get_gambl_metadata(    seq_type_filter = \"genome\") %>%     dplyr::filter(pathology == \"FL\")) #> Using the bundled collated results in GAMBLR.data... #> Using the bundled metadata in GAMBLR.data... #> Joining with `by = join_by(sample_id, study)`  #horizontally expand all available metadata with collated results all_meta_collated = collate_results(join_with_full_metadata = TRUE) #> Using the bundled collated results in GAMBLR.data... #> Using the bundled metadata in GAMBLR.data... #> Joining with `by = join_by(sample_id, study)`"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/complete_missing_from_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Complete samples missing from matrix. — complete_missing_from_matrix","title":"Complete samples missing from matrix. — complete_missing_from_matrix","text":"samples missing matrix, add filled 0 value normalize ordering consistency.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/complete_missing_from_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Complete samples missing from matrix. — complete_missing_from_matrix","text":"","code":"complete_missing_from_matrix(   incoming_matrix,   list_of_samples,   fill_in_values = 0,   normalize_order = TRUE,   samples_in_rows = TRUE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/complete_missing_from_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Complete samples missing from matrix. — complete_missing_from_matrix","text":"incoming_matrix matrix data frame filled. Required parameter. list_of_samples Vector specifying desired samples present resulting matrix. Required parameter. fill_in_values Value used fill matrix. normalize_order Logical parameter specifying whether sample order according supplied list. Default TRUE. samples_in_rows Logical argument indicating whether samples rows columns. Default assumes samples rows columns features.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/complete_missing_from_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Complete samples missing from matrix. — complete_missing_from_matrix","text":"data frame maintained orientation (rows columns) samples supplied list present reordered according specified order.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/complete_missing_from_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Complete samples missing from matrix. — complete_missing_from_matrix","text":"","code":"if (FALSE) { # \\dontrun{ partial_matrix = get_coding_ssm_status(these_samples_metadata = (get_gambl_metadata(case_set = \"BL--DLBCL\") %>% filter(pairing_status == \"unmatched\")), include_hotspots = FALSE) complete_matrix = complete_missing_from_matrix(partial_matrix, get_gambl_metadata() %>% pull(sample_id)) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/construct_reduced_winning_version.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct reduced 21-dimension feature vector for DLBCLass — construct_reduced_winning_version","title":"Construct reduced 21-dimension feature vector for DLBCLass — construct_reduced_winning_version","text":"function R port pre-processing code DLBCLass https://github.com/getzlab/DLBCL-Classifier","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/construct_reduced_winning_version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct reduced 21-dimension feature vector for DLBCLass — construct_reduced_winning_version","text":"","code":"construct_reduced_winning_version(   mutations_file = \"inst/extdata/DLBCL.699.fullGSM.Sep_23_2022.tsv\",   fisher_test_result_file = \"inst/extdata/fisher_exact_5x2.Sep_23_2022.combined.tsv\",   include_cn = TRUE,   mutation_data,   add_missing_features = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/construct_reduced_winning_version.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct reduced 21-dimension feature vector for DLBCLass — construct_reduced_winning_version","text":"add_missing_features Set TRUE fill missing features zeroes data Data frame mutation status DLBCLass supplement fisher_test_result Fisher's test result DLBCLass github repository","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/construct_reduced_winning_version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct reduced 21-dimension feature vector for DLBCLass — construct_reduced_winning_version","text":"list data frames full mutation features, collapsed 21-dimension meta-features mutation-(CNV) features","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/construct_reduced_winning_version.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct reduced 21-dimension feature vector for DLBCLass — construct_reduced_winning_version","text":"","code":"if (FALSE) { # \\dontrun{ original_dlbclass_features = construct_reduced_winning_version() } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/flatten_feature.html","id":null,"dir":"Reference","previous_headings":"","what":"Flatten feature — flatten_feature","title":"Flatten feature — flatten_feature","text":"Return matrix (features rows samples columns) several features squished (flattened) single one. number order features flattened matter. New row new name specified user created, positive (value 1) features flatten positive.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/flatten_feature.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Flatten feature — flatten_feature","text":"","code":"flatten_feature(new_name, features_to_flatten, incoming_data)"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/flatten_feature.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Flatten feature — flatten_feature","text":"new_name String new feature name. features_to_flatten Vector features (row names) flattened. incoming_data Matrix data frame features.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/flatten_feature.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Flatten feature — flatten_feature","text":"matrix","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_all_coding_ssm.html","id":null,"dir":"Reference","previous_headings":"","what":"Get all Coding SSMs — get_all_coding_ssm","title":"Get all Coding SSMs — get_all_coding_ssm","text":"Retrieve coding SSMs GAMBL MAF-like format, regardless seq_type.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_all_coding_ssm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get all Coding SSMs — get_all_coding_ssm","text":"","code":"get_all_coding_ssm(   these_samples_metadata = NULL,   include_silent = FALSE,   projection = \"grch37\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_all_coding_ssm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get all Coding SSMs — get_all_coding_ssm","text":"these_samples_metadata Supply metadata table containing sample/seq_type combinations want. include_silent set TRUE, silent/synonymous mutations coding regions also returned. projection desired genome build 'grch37' 'hg38' allowed. Default grch37","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_all_coding_ssm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get all Coding SSMs — get_all_coding_ssm","text":"data frame containing MAF data columns (one row per mutation).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_all_coding_ssm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get all Coding SSMs — get_all_coding_ssm","text":"Effectively retrieve coding SSM calls one DNA seq_type. additional optional arguments, see GAMBLR.results::get_coding_ssm","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_all_coding_ssm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get all Coding SSMs — get_all_coding_ssm","text":"","code":"library(GAMBLR.open) my_meta = get_gambl_metadata(seq_type_filter = c(\"genome\",\"capture\")) #> Using the bundled metadata in GAMBLR.data... my_meta = check_and_clean_metadata(my_meta,duplicate_action=\"keep_first\") #> Duplicate rows (keeping first occurrence) for 'sample_id' and 'seq_type' have been dropped. maf_all_seqtype = get_all_coding_ssm(my_meta)  table(maf_all_seqtype$maf_seq_type) #>  #> capture  genome  #>   57951 3171050   # most common mutations by gene and Variant_Classification dplyr::group_by(maf_all_seqtype,                 Hugo_Symbol,                 Variant_Classification) %>%    dplyr::count() %>%    dplyr::arrange(desc(n)) #> genomic_data Object #> Genome Build: grch37  #> Showing first 10 rows: #>    Hugo_Symbol Variant_Classification       n #> 1      Unknown                    IGR 1306295 #> 2        PTPRD                 Intron   20317 #> 3        IGLL5                 Intron   12050 #> 4         PCLO                 Intron    5932 #> 5        UNC5D                 Intron    5530 #> 6         BCL6                 Intron    5207 #> 7        ROBO2                 Intron    4850 #> 8         BCL2                 Intron    4737 #> 9         BCL2                  5'UTR    4728 #> 10       PTPRK                 Intron    4369"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ashm_count_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Get ASHM Count Matrix. — get_ashm_count_matrix","title":"Get ASHM Count Matrix. — get_ashm_count_matrix","text":"Prepare matrix one row per sample one column per region using set hypermutated regions.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ashm_count_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get ASHM Count Matrix. — get_ashm_count_matrix","text":"","code":"get_ashm_count_matrix(   regions_bed,   these_samples_metadata,   this_seq_type,   projection = \"grch37\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ashm_count_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get ASHM Count Matrix. — get_ashm_count_matrix","text":"regions_bed bed file one row region. these_samples_metadata used complete matrix. GAMBL samples used default. Provide data frame least sample_id samples using non-GAMBL data. this_seq_type seq type return results . used metadata provided these_samples_metadata. projection genome build use mutations (must match coordinate system regions avoid nonsense result)","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ashm_count_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get ASHM Count Matrix. — get_ashm_count_matrix","text":"matrix","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ashm_count_matrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get ASHM Count Matrix. — get_ashm_count_matrix","text":"Values number mutations patient region.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ashm_count_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get ASHM Count Matrix. — get_ashm_count_matrix","text":"","code":"regions_bed = create_bed_data(GAMBLR.data::grch37_ashm_regions,                               fix_names=\"concat\",                               concat_cols=c(\"gene\",\"region\"),                               sep=\"-\") my_meta = get_gambl_metadata() %>% dplyr::filter(pathology==\"DLBCL\") #> Using the bundled metadata in GAMBLR.data... shm_matrix <- get_ashm_count_matrix(      regions_bed = regions_bed,      this_seq_type = \"genome\",      these_samples_metadata = my_meta ) #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> id_ease: WARNING! 1783 samples in the provided metadata were removed because their seq types are not the same as in the `set_type` argument. Use `verbose = TRUE` to see their IDs. #> Running in default mode of any... #> Joining with `by = join_by(sample_id, region_name)` head(shm_matrix[,c(1:12)]) #>           AICDA-TSS BACH2-TSS BCL11A-TSS BCL2-TSS BCL2-intron BCL6-Intergenic-1 #> 02-13135T         0         1          0       20           0                 0 #> 02-20170T         1         1          0        0           0                 0 #> 02-22991T         0         0          0        0           0                 0 #> 04-24937T         0         2         15        4           0                 0 #> 04-28140T         0         0          0        0           0                 0 #> 04-29264T         0         0          0        0           0                 0 #>           BCL6-Intergenic-2 BCL6-Intergenic-3 BCL6-Intergenic-4 #> 02-13135T                 0                 1                 0 #> 02-20170T                 0                 2                 0 #> 02-22991T                 0                 0                 1 #> 04-24937T                 0                 1                 0 #> 04-28140T                 0                 0                 0 #> 04-29264T                 0                 2                 2 #>           BCL6-Intergenic-5 BCL6-TSS BCL7A-TSS #> 02-13135T                 0        4         3 #> 02-20170T                 0        2         0 #> 02-22991T                 0        1         0 #> 04-24937T                 0       12         2 #> 04-28140T                 0        0         0 #> 04-29264T                 1        3         3 if (FALSE) { # \\dontrun{ #this example should fail because the regions_bed is not hg38 shm_matrix <- get_ashm_count_matrix(regions_bed=regions_bed,                             this_seq_type = \"genome\",                             these_samples_metadata = my_meta,                             projection = \"hg38\") # Error in get_ashm_count_matrix( # Your projection argument does not match the genome_build of regions_bed } # } # format the name column to include the coordinates instead of the gene regions_bed = create_bed_data(GAMBLR.data::hg38_ashm_regions,                            fix_names=\"concat\",                            concat_cols=c(\"chr_name\",\"hg38_start\",\"hg38_end\"),                            sep=\"-\")   matrix_hg38 <- get_ashm_count_matrix(regions_bed=regions_bed,                                       this_seq_type = \"genome\",                                       these_samples_metadata = my_meta,                                       projection = \"hg38\") #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> id_ease: WARNING! 1783 samples in the provided metadata were removed because their seq types are not the same as in the `set_type` argument. Use `verbose = TRUE` to see their IDs. #> Running in default mode of any... #> Joining with `by = join_by(sample_id, region_name)` print(dim(matrix_hg38)) #> [1] 2312  129 print(head(matrix_hg38[,c(1:8)])) #>           chr1-203305570-203306650 chr1-226732862-226740184 #> 02-13135T                        0                        0 #> 02-20170T                        0                        0 #> 02-22991T                        0                        0 #> 04-24937T                       21                        0 #> 04-28140T                        0                        0 #> 04-29264T                        1                        0 #>           chr1-226733387-226740281 chr1-28506039-28509827 #> 02-13135T                        0                      0 #> 02-20170T                        0                      0 #> 02-22991T                        0                      0 #> 04-24937T                        0                      0 #> 04-28140T                        0                      0 #> 04-29264T                        0                      0 #>           chr1-30756165-30759164 chr11-102317439-102319346 #> 02-13135T                      0                         0 #> 02-20170T                      0                         1 #> 02-22991T                      0                         0 #> 04-24937T                      0                         4 #> 04-28140T                      0                         0 #> 04-29264T                      0                         0 #>           chr11-111377353-111379499 chr11-118883749-118885805 #> 02-13135T                         0                         0 #> 02-20170T                         0                         0 #> 02-22991T                         0                         0 #> 04-24937T                         1                         0 #> 04-28140T                         0                         0 #> 04-29264T                         1                         0"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_cn_segments.html","id":null,"dir":"Reference","previous_headings":"","what":"Get CN Segments. — get_cn_segments","title":"Get CN Segments. — get_cn_segments","text":"Retrieve copy number segments GAMBL outputs","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_cn_segments.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get CN Segments. — get_cn_segments","text":"","code":"get_cn_segments(   these_samples_metadata,   projection = \"grch37\",   this_seq_type,   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_cn_segments.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get CN Segments. — get_cn_segments","text":"these_samples_metadata User must provide metadata table restrict data samples table. metadata also ensures proper handling duplicate sample_id across seq_types ensures seq_type metadata faithfully represents seq_type data projection Desired genome coordinate system returned CN segments. Default \"grch37\". this_seq_type Deprecated. ... Additional parameters passed function.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_cn_segments.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get CN Segments. — get_cn_segments","text":"data frame CN segments specified region.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_cn_segments.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get CN Segments. — get_cn_segments","text":"function merely loads returns seg_data available projection (genome build)","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_cn_segments.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get CN Segments. — get_cn_segments","text":"","code":"# Example for the capture samples:  genome_metadata = get_gambl_metadata(seq_type_filter=\"genome\") #> Using the bundled metadata in GAMBLR.data...  genome_segments_hg38 = get_cn_segments(                              these_samples_metadata = genome_metadata,                              projection=\"hg38\") #> Using the bundled CN segments (.seg) calls in GAMBLR.data..."},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_cnv_and_ssm_status.html","id":null,"dir":"Reference","previous_headings":"","what":"Get CNV and coding SSM combined status — get_cnv_and_ssm_status","title":"Get CNV and coding SSM combined status — get_cnv_and_ssm_status","text":"specified chromosome region (gene name), return status 1 copy number (CN) state non-neutral, .e. different 2, region contains coding simple somatic mutation (SSM).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_cnv_and_ssm_status.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get CNV and coding SSM combined status — get_cnv_and_ssm_status","text":"","code":"get_cnv_and_ssm_status(   genes_and_cn_threshs,   these_samples_metadata,   maf_df,   seg_data,   cn_matrix,   only_cnv = \"none\",   genome_build = \"grch37\",   include_hotspots = TRUE,   review_hotspots = TRUE,   adjust_for_ploidy = TRUE,   include_silent = FALSE,   this_seq_type )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_cnv_and_ssm_status.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get CNV and coding SSM combined status — get_cnv_and_ssm_status","text":"genes_and_cn_threshs data frame columns \"gene_id\" \"cn_thresh\". \"gene_id\" column stores gene symbols (characters) determine regions return CNV /coding SSM status. \"cn_thresh\" column stores integers mean maximum minimum CN states return status 1 (contains CNV) respective gene. integer 2 (neutral CN state diploids), taken maximum (gene consider tumor suppressor); 2, minimum (oncogene); equal 2, consider CNV return status. these_samples_metadata metadata samples interest included returned matrix. Can created get_gambl_metadata function. maf_df Optional data frame containing coding variants samples (.e. output get_all_coding_ssm) seg_data Optionally provide function data frame segments used instead GAMBL flatfiles cn_matrix Instead seg_data, can provide matrix CN values samples metadata. See GAMBLR.utils::segmented_data_to_cn_matrix information create matrix. only_cnv vector gene names indicating genes CNV status considered, ignoring SSM status. Set argument \"\" \"none\" (default) apply behavior none genes, respectively. genome_build Reference genome build. Possible values \"grch37\" (default) \"hg38\". include_hotspots Logical parameter indicating whether hotspots object also tabulated. Default TRUE. review_hotspots Logical parameter indicating whether hotspots object reviewed include functionally relevant mutations rare lymphoma-related genes. Default TRUE. adjust_for_ploidy Set FALSE disable scaling CN values genome-wide average per sample include_silent Set TRUE want Synonymous mutations also considered this_seq_type Deprecated","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_cnv_and_ssm_status.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get CNV and coding SSM combined status — get_cnv_and_ssm_status","text":"data frame CNV SSM combined status.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_cnv_and_ssm_status.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get CNV and coding SSM combined status — get_cnv_and_ssm_status","text":"user can choose regions intended return copy number variation (CNV) status, coding SSM status, least presence one . behavior controlled arguments genes_and_cn_threshs (column cn_thresh) only_cnv. function internally calls get_cn_states, get_ssm_by_samples get_coding_ssm_statusfunctions. Therefore, many arguments assigned functions. needed, see documentation functions information. case returning NA values, due get_cn_segments function able internally return copy number segments specified chromosome region.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_cnv_and_ssm_status.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get CNV and coding SSM combined status — get_cnv_and_ssm_status","text":"","code":"library(GAMBLR.open) # Get sample metadata including a mix of seq_type all_types_meta = suppressMessages(get_gambl_metadata()) %>%              dplyr::filter(pathology == \"BL\") dplyr::group_by(all_types_meta, seq_type) %>%       dplyr::summarize(n=dplyr::n()) #> # A tibble: 1 × 2 #>   seq_type     n #>   <chr>    <int> #> 1 genome     234  # For MYC and SYNCRIP, return CNV and SSM combined status; for MIR17HG,  # return only CNV status; for CCND3 return only SSM status genes_and_cn_threshs = data.frame(   gene_id=c(\"MYC\", \"MIR17HG\", \"CCND3\",\"ID3\",\"DDX3X\", \"SYNCRIP\"),   cn_thresh=c(3, 3, 2, 2, 2, 1) )  genome_cnv_ssm_status = suppressMessages(get_cnv_and_ssm_status(                            genes_and_cn_threshs,                            genome_build = \"hg38\",                            dplyr::filter(all_types_meta,seq_type==\"genome\"),                            only_cnv = \"MIR17HG\"))  print(dim(genome_cnv_ssm_status))     #> [1] 234   6 head(genome_cnv_ssm_status)    #>                           MYC MIR17HG CCND3 ID3 DDX3X SYNCRIP #> Akata                       1       1     0   1     1       0 #> BL2                         1       1     0   1     1       0 #> BL30                        1       1     0   1     1       0 #> BL41                        1       1     1   1     0       0 #> BL70                        1       1     1   1     1       0 #> BLGSP-71-06-00001-01A-11D   0       0     1   1     1       0 colSums(genome_cnv_ssm_status) #>     MYC MIR17HG   CCND3     ID3   DDX3X SYNCRIP  #>     172      38      68     112     118      12          all_path_meta = suppressMessages(get_gambl_metadata()) all_path_meta = check_and_clean_metadata(all_path_meta,duplicate_action=\"keep_first\") #> Duplicate rows (keeping first occurrence) for 'sample_id' and 'seq_type' have been dropped. dplyr::group_by(all_types_meta, seq_type) %>%       dplyr::summarize(n=dplyr::n())              #> # A tibble: 1 × 2 #>   seq_type     n #>   <chr>    <int> #> 1 genome     234 all_pathology_status = suppressMessages(get_cnv_and_ssm_status(                            genes_and_cn_threshs,                            all_path_meta,                            genome_build = \"grch37\",                            only_cnv = \"MIR17HG\"))  print(dim(all_pathology_status))    #> [1] 448   6 head(all_pathology_status) #>           MYC MIR17HG CCND3 ID3 DDX3X SYNCRIP #> 01-20260T   1       0     0   0     0       0 #> 02-13135T   1       0     0   0     1       0 #> 02-20170T   0       1     0   0     0       1 #> 02-22991T   1       0     0   0     0       0 #> 03-34157T   0       0     0   0     0       0 #> 04-24029T   0       0     0   0     0       0 colSums(all_pathology_status) #>     MYC MIR17HG   CCND3     ID3   DDX3X SYNCRIP  #>     114      62      25       5      25     134"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_coding_ssm.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Coding SSMs — get_coding_ssm","title":"Get Coding SSMs — get_coding_ssm","text":"Convenience function loading coding Simple Somatic Mutations (SSM) bundled data GAMBLR.data::sample_data.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_coding_ssm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Coding SSMs — get_coding_ssm","text":"","code":"get_coding_ssm(   these_sample_ids = NULL,   these_samples_metadata = NULL,   projection = \"grch37\",   this_seq_type = \"genome\",   tool_name = \"slms-3\",   min_read_support = 3,   include_silent = TRUE,   verbose = FALSE,   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_coding_ssm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Coding SSMs — get_coding_ssm","text":"these_sample_ids Optional, vector multiple sample_id (single sample ID string) want results . these_samples_metadata Optional, metadata table (sample IDs column) subset return . provided (these_sample_ids provided), function return samples specified seq_type metadata. projection Reference genome build coordinates MAF file. default grch37. this_seq_type this_seq_type want back, default genome. tool_name Optionally specify tool report variant . default slms-3, also supports \"publication\" return exact variants reported original papers. min_read_support returns variants least many reads t_alt_count. include_silent Logical parameter indicating whether include silent mutations coding mutations. Default TRUE. verbose Set FALSE minimize output console. Default TRUE. parameter also dictates verbosity helper function internally called inside main function. ... additional parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_coding_ssm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Coding SSMs — get_coding_ssm","text":"data frame","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_coding_ssm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Coding SSMs — get_coding_ssm","text":"\"bare bones\" function developed retrieve coding SSM calls non-GSC-users. Effectively retrieve coding SSM calls. Multiple filtering parameters available function. information implement filtering parameters, refer parameter descriptions well examples vignettes. function depends bundled sample data package.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_coding_ssm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Coding SSMs — get_coding_ssm","text":"","code":"# Get mutations from exome data originally aligned to grch37 ssm_exomes_grch37 = get_coding_ssm(projection = \"grch37\",this_seq_type = \"capture\") #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> Using the bundled metadata in GAMBLR.data... #> after linking with metadata, we have mutations from 1787 samples  # Get mutations from genome data, hg38 build ssm_genomes_hg38 = get_coding_ssm(projection = \"hg38\",this_seq_type = \"genome\") #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> Using the bundled metadata in GAMBLR.data... #> after linking with metadata, we have mutations from 860 samples"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_coding_ssm_status.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Coding SSM Status. — get_coding_ssm_status","title":"Get Coding SSM Status. — get_coding_ssm_status","text":"Tabulate mutation status (SSM) set genes.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_coding_ssm_status.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Coding SSM Status. — get_coding_ssm_status","text":"","code":"get_coding_ssm_status(   gene_symbols,   these_samples_metadata,   maf_data,   include_hotspots = TRUE,   keep_multihit_hotspot = FALSE,   review_hotspots = TRUE,   genes_of_interest = c(\"FOXO1\", \"MYD88\", \"CREBBP\"),   genome_build,   include_silent = FALSE,   include_silent_genes,   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_coding_ssm_status.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Coding SSM Status. — get_coding_ssm_status","text":"gene_symbols vector gene symbols mutation status tabulated. provided, lymphoma genes returned default. these_samples_metadata metadata samples interest included returned matrix. column \"sample_id\" required. provided, example metadata used default. maf_data data frame maf format. Must grch37 projection. include_hotspots Logical parameter indicating whether hotspots object also tabulated. Default TRUE. keep_multihit_hotspot Logical parameter indicating whether keep gene annotation mutated gene hot spot non-hotspot mutation. Default FALSE. set TRUE, report number non-hotspot mutations instead tabulating just mutation presence. review_hotspots Logical parameter indicating whether hotspots object reviewed include functionally relevant mutations rare lymphoma-related genes. Default TRUE. genes_of_interest vector genes hotspot review. Currently FOXO1, MYD88, CREBBP supported. genome_build Reference genome build coordinates MAF file. default inferred maf_data. include_silent Logical parameter indicating whether include silent mutations coding mutations. Default FALSE. include_silent_genes Optionally, provide list genes Silent variants considered. provided, Silent variants genes included regardless include_silent argument. ... parameter. parameters ignored.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_coding_ssm_status.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Coding SSM Status. — get_coding_ssm_status","text":"data frame tabulated mutation status.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_coding_ssm_status.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Coding SSM Status. — get_coding_ssm_status","text":"function takes data frame (MAF-like format) converts binary one-hot encoded matrix mutation status either set user-specified genes (via gene_symbols) , genes provided, default lymphoma genes. default behaviour assign gene/sample_id combination mutated protein coding mutation sample MAF can configured use synonymous variants (via include_silent_genes) (via include_silent) genes. function also filtering convenience parameters giving user full control return. information, refer parameter descriptions examples. Currently grch37 genome build supported hotspot annotation review version function.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_coding_ssm_status.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Coding SSM Status. — get_coding_ssm_status","text":"","code":"coding_tabulated_df = get_coding_ssm_status(  maf_data = get_coding_ssm(),  gene_symbols = c(\"EZH2\",\"KMT2D\",\"CREBBP\",\"MYC\") ) #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> Using the bundled metadata in GAMBLR.data... #> after linking with metadata, we have mutations from 817 samples #> Using the bundled metadata in GAMBLR.data... #> Joining with `by = join_by(sample_id)` #> annotating hotspots #> Joining with `by = join_by(sample_id)` #> CREBBPHOTSPOT #> OK #> MYD88HOTSPOT #> FOXO1HOTSPOT  head(coding_tabulated_df) #>                   sample_id KMT2D CREBBP EZH2 MYC CREBBPHOTSPOT MYD88HOTSPOT #> 1                     Akata     0      0    0   1             0            0 #> 2                       BL2     0      0    0   1             0            1 #> 3                      BL30     1      0    0   1             0            0 #> 4                      BL41     0      0    0   1             0            0 #> 5                      BL70     0      0    0   1             0            0 #> 6 BLGSP-71-06-00001-01A-11D     0      0    0   0             0            0 #>   FOXO1HOTSPOT #> 1            1 #> 2            1 #> 3            0 #> 4            0 #> 5            0 #> 6            1  #all lymphoma genes from bundled NHL gene list coding_tabulated_df = get_coding_ssm_status(                            maf_data = get_coding_ssm()                       ) #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> Using the bundled metadata in GAMBLR.data... #> after linking with metadata, we have mutations from 817 samples #> No gene_symbols provided, defaulting to all lymphoma genes. #> Using the bundled metadata in GAMBLR.data... #> Joining with `by = join_by(sample_id)` #> annotating hotspots #> Joining with `by = join_by(sample_id)` #> CREBBPHOTSPOT #> OK #> MYD88HOTSPOT #> OK #> FOXO1HOTSPOT #> OK head(coding_tabulated_df[,c(1:10)]) #>                   sample_id TNFRSF14 SPEN CARD11 KMT2D BCL7A FOXO1 BCL2 BTK #> 1                     Akata        0    1      0     0     0     0    0   0 #> 2                       BL2        0    0      0     0     0     0    0   0 #> 3                      BL30        0    0      0     1     0     0    0   0 #> 4                      BL41        0    0      0     0     0     0    0   0 #> 5                      BL70        0    0      0     0     0     0    0   0 #> 6 BLGSP-71-06-00001-01A-11D        0    0      0     0     0     0    0   0 #>   CREBBP #> 1      0 #> 2      0 #> 3      0 #> 4      0 #> 5      0 #> 6      0 if (FALSE) { # \\dontrun{ #this example would fail because hg38 is not supported by this function (yet) coding_tabulated_df = get_coding_ssm_status(maf_data=                         get_coding_ssm(projection = \"hg38\")) # Error in get_coding_ssm_status(maf_data = get_coding_ssm(projection = \"hg38\")) :  # Currently only grch37 projection (hg19 genome build) is supported. } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_gambl_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Get GAMBL Metadata. — get_gambl_metadata","title":"Get GAMBL Metadata. — get_gambl_metadata","text":"Convenience function loading sample metadata.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_gambl_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get GAMBL Metadata. — get_gambl_metadata","text":"","code":"get_gambl_metadata(seq_type_filter = c(\"genome\", \"capture\"), case_set, ...)"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_gambl_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get GAMBL Metadata. — get_gambl_metadata","text":"seq_type_filter Specify seq type want return metadata . Default \"genome\". case_set Optionally specify study details return samples particular case set. See function description supported case sets. ... additional parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_gambl_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get GAMBL Metadata. — get_gambl_metadata","text":"data frame metadata, tailored user without GSC access. compression Format original data used input analysis pipelines (cram, bam fastq) bam_available Whether file available last checked. patient_id anonymized unique identifier patient. BC samples, Res ID. sample_id unique identifier sample analyzed. seq_type assay type used produce data (one \"genome\",\"capture, \"mrna\", \"promethION\") genome_build name genome reference data aligned . cohort Name group samples added together (usually single study), often format pathology_cohort_descriptor. pathology diagnosis pathology sample time_point Timing biopsy increasing alphabetical order (= diagnosis, B = first relapse etc) ffpe_or_frozen Whether nucleic acids extracted frozen FFPE sample COO_consensus Consensus call COO different sources. DHITsig_consensus Consensus call DHIT signature status different sources. EBV_status_inf Inferred EBV status tumor lymphgen_no_cnv LymphGen label using model without CNV lymphgen_with_cnv LymphGen label using model CNV lymphgen_cnv_noA53 LymphGen label using model CNV excluding A53 class lymphgen_wright LymphGen call sample Wright et (applicable) fl_grade Grade FL samples normal_sample_id Sample id normal tissue used analysis pairing_status Matching status sample lymphgen LymphGen label molecular_BL label sample according molecular BL classifier Tumor_Sample_Barcode Duplicate sample_id simplifying joins MAF data frames pathology_rank Numeric rank consistent ordering samples pathology hiv_status HIV status sample age_group Adult_BL Pediatric_BL , specific BLGSP study sex biological sex patient, available. Allowable options: M, F, NA","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_gambl_metadata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get GAMBL Metadata. — get_gambl_metadata","text":"bare bones function developed retrieve metadata non-GSC-users. Specify seq type (seq_type_filter) samples want returned argument. relies bundled metadata package. Specify case_set argument retreive samples particular study. Currently supported case_sets : FL_Dreval (FL samples Dreval et al), DLBCL_Dreval (DLBCL samples Dreval et al), FL-DLBCL-study (samples Dreval et al), DLBCL_Arthur (samples Arthur et al study), DLBCL_Hilton (samples Hilton et al DLBCL Trios study), DLBCL_cell_lines (5 DLBCL cell lines), DLBCL_Chapuy (samples Chapuy et al study), DLBCL_Schmitz (samples Schmitz et al study), DLBCL_Reddy (samples Reddy et al study), DLBCL_Thomas (HTMCP DLBCLs Thomas et al study), BL_Thomas (BL samples Thomas et al study)","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_gambl_metadata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get GAMBL Metadata. — get_gambl_metadata","text":"","code":"#return metadata for genome samples (here, the parameter is redundant because 'genome' is the default) genome_meta = get_gambl_metadata(seq_type_filter = \"genome\") #> Using the bundled metadata in GAMBLR.data...  #return metadata for capture samples. capture_meta = get_gambl_metadata(seq_type_filter = \"capture\") #> Using the bundled metadata in GAMBLR.data...  #If you want metadata for genome and capture samples you can provide a vector of seq types all_meta = get_gambl_metadata(seq_type_filter = c(\"genome\", \"capture\")) #> Using the bundled metadata in GAMBLR.data...  dplyr::group_by(all_meta,cohort,seq_type) %>%      dplyr::count() #> # A tibble: 21 × 3 #> # Groups:   cohort, seq_type [21] #>    cohort             seq_type     n #>    <chr>              <chr>    <int> #>  1 BL_Adult           genome      91 #>  2 BL_Pediatric       genome     121 #>  3 BL_cell_lines      genome      22 #>  4 DLBCL_Gascoyne     genome      21 #>  5 DLBCL_GenomeCanada genome      59 #>  6 DLBCL_HTMCP        genome      43 #>  7 DLBCL_ICGC         genome      84 #>  8 DLBCL_LSARP_Trios  capture     12 #>  9 DLBCL_LSARP_Trios  genome     142 #> 10 DLBCL_Marra        genome      38 #> # ℹ 11 more rows"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_manta_sv.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Manta SVs — get_manta_sv","title":"Get Manta SVs — get_manta_sv","text":"Retrieve Manta SVs one many samples","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_manta_sv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Manta SVs — get_manta_sv","text":"","code":"get_manta_sv(   these_samples_metadata = NULL,   projection = \"grch37\",   region,   min_vaf = 0.1,   min_score = 40,   pass_filters = TRUE,   verbose = FALSE,   chromosome,   qstart,   qend,   pairing_status,   these_sample_ids = NULL,   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_manta_sv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Manta SVs — get_manta_sv","text":"these_samples_metadata metadata data frame limit result sample_ids within projection projection genome build. Default grch37. region Specify single region fetch SVs anchored within using format \"chrom:start-end\" min_vaf minimum tumour VAF SV returned. Default 0.1. min_score lowest Manta somatic score SV returned. Default 40. pass_filters TRUE (default) return SVs annotated PASS FILTER column. Set FALSE keep variants, regardless PASS filters. verbose Set FALSE minimize output console. Default TRUE. parameter also dictates verbose-ness helper function internally called inside main function. chromosome DEPRECATED. Use region instead. qstart DEPRECATED. Use region instead. qend DEPRECATED. Use region instead. pairing_status DEPRECATED. these_sample_ids DEPRECATED. Subset metadata supply `these_samples_metadata“ instead. ... additional parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_manta_sv.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Manta SVs — get_manta_sv","text":"Retrieve Manta SVs additional VCF information allow filtering high-confidence variants. get SV calls multiple samples, supply metadata table via these_samples_metadata subset samples. results restricted sample_ids within data frame. function can also restrict returned breakpoints within genomic region specified via region (chr:start-end format). Useful filtering parameters also available, use min_vaf set minimum tumour VAF SV returned min_score set lowest Manta somatic score SV returned. addition, user can chose return variants, even ones passing filter criteria. , set pass_filters = FALSE (defaults TRUE).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_manta_sv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Manta SVs — get_manta_sv","text":"","code":"# lazily get every SV in the table with default quality filters all_sv <- get_manta_sv() #> Using the bundled metadata in GAMBLR.data... #> Using the bundled Manta SV (.bedpe) calls in GAMBLR.data... head(all_sv) #> genomic_data Object #> Genome Build: grch37  #> Showing first 10 rows: #>   CHROM_A   START_A     END_A CHROM_B   START_B     END_B #> 1       1 161658631 161658631       3  16509907  16509907 #> 2       1 161663959 161663959       9  37363320  37363320 #> 3       1 161663959 161663959       9  37363320  37363320 #> 4      11  65267283  65267283      14 106110907 106110907 #> 5      11  65267422  65267422      14 106110905 106110905 #> 6      13  91976545  91976545      14 106211857 106211857 #>                      manta_name SCORE STRAND_A STRAND_B tumour_sample_id #> 1      MantaBND:21171:0:1:0:0:0   133        +        +         FL2002T1 #> 2     MantaBND:206628:0:1:0:0:0   122        +        +  09-15842_tumorA #> 3     MantaBND:195941:0:1:0:0:0   151        +        +  09-15842_tumorB #> 4   MantaBND:152220:0:1:0:0:0:0    88        +        -        15-38154T #> 5   MantaBND:152220:0:1:0:0:0:0   135        -        +        15-38154T #> 6 MantaBND:18:59794:59817:0:1:0    90        -        +        15-31924T #>   normal_sample_id VAF_tumour  DP pair_status FILTER #> 1          FL2002N      0.331 127     matched   PASS #> 2  09-15842_normal      0.281 196     matched   PASS #> 3  09-15842_normal      0.364 187     matched   PASS #> 4        15-38154N      0.150 167     matched   PASS #> 5        15-38154N      0.290 169     matched   PASS #> 6        15-31924N      0.365  85     matched   PASS  # get all SVs for just one cohort cohort_meta = suppressMessages(get_gambl_metadata()) %>%                dplyr::filter(cohort == \"DLBCL_cell_lines\")  some_sv <- get_manta_sv(these_samples_metadata = cohort_meta, verbose=FALSE) #> Using the bundled Manta SV (.bedpe) calls in GAMBLR.data... head(some_sv) #> genomic_data Object #> Genome Build: grch37  #> Showing first 10 rows: #>   CHROM_A   START_A     END_A CHROM_B  START_B    END_B #> 1      14 106329462 106329462      18 60774579 60774579 #> 2      14 106329465 106329465      18 60793497 60793497 #> 3      14 106330466 106330466      18 60793914 60793914 #> 4      14 106349765 106349765      18 60793914 60793914 #> 5      14 106379091 106379091      18 60793492 60793492 #> 6      14 106380227 106380227      18 60774578 60774578 #>                  manta_name SCORE STRAND_A STRAND_B tumour_sample_id #> 1 MantaBND:220769:1:2:0:0:0   134        +        -        SU-DHL-10 #> 2 MantaBND:194451:1:2:0:0:0   103        +        -           DOHH-2 #> 3 MantaBND:217561:1:2:0:0:0   182        +        -         SU-DHL-4 #> 4 MantaBND:217561:0:1:0:0:0   198        -        +         SU-DHL-4 #> 5 MantaBND:194451:0:1:0:0:0    91        -        +           DOHH-2 #> 6 MantaBND:220769:0:1:0:0:0   169        -        +        SU-DHL-10 #>   normal_sample_id VAF_tumour DP pair_status FILTER #> 1        14-11247N      0.318 66   unmatched   PASS #> 2        14-11247N      0.290 69   unmatched   PASS #> 3        14-11247N      0.474 57   unmatched   PASS #> 4        14-11247N      0.500 62   unmatched   PASS #> 5        14-11247N      0.300 60   unmatched   PASS #> 6        14-11247N      0.578 45   unmatched   PASS nrow(some_sv) #> [1] 13  # get the SVs in a region around MYC # WARNING: This is not the best way to find MYC SVs. # Use annotate_sv on the full SV set instead. myc_region_hg38 = \"chr8:127710883-127761821\" myc_region_grch37 = \"8:128723128-128774067\"  hg38_myc_locus_sv <- get_manta_sv(region = myc_region_hg38,                                 projection = \"hg38\",                                 verbose = FALSE) #> Using the bundled metadata in GAMBLR.data... #> Using the bundled Manta SV (.bedpe) calls in GAMBLR.data... head(hg38_myc_locus_sv) #> genomic_data Object #> Genome Build: hg38  #> Showing first 10 rows: #>   CHROM_A   START_A     END_A CHROM_B   START_B     END_B #> 1    chr2  88860304  88860306    chr8 127751936 127751938 #> 2    chr2  88860417  88860417    chr8 127751955 127751955 #> 3    chr2  88861500  88861500    chr8 127748752 127748752 #> 4    chr3 187811601 187811601    chr8 127745649 127745649 #> 5    chr8 127741233 127741234   chr12  25049104  25049105 #> 6    chr8 127713694 127713694   chr14 105857950 105857950 #>                     manta_name SCORE STRAND_A STRAND_B #> 1  MantaBND:194837:0:1:0:0:0:0   102        +        + #> 2  MantaBND:194837:0:1:0:0:0:0    73        -        - #> 3   MantaBND:1102030:0:1:0:0:0    89        +        + #> 4     MantaBND:48510:0:2:0:0:0   106        -        + #> 5    MantaBND:174836:0:1:0:0:0   219        +        + #> 6 MantaBND:1:10030:23823:0:0:0   109        -        + #>            tumour_sample_id          normal_sample_id VAF_tumour  DP #> 1 BLGSP-71-27-00414-01A-01E BLGSP-71-27-00414-10A-01D      0.171 280 #> 2 BLGSP-71-27-00414-01A-01E BLGSP-71-27-00414-10A-01D      0.117 230 #> 3 BLGSP-71-30-00647-01A-01E BLGSP-71-06-00286-99A-01D      0.283  46 #> 4                  FL1008T2                   FL1008N      0.171 245 #> 5                  FL1018T2                   FL1018N      0.323 288 #> 6 BLGSP-71-06-00280-01A-01D BLGSP-71-06-00280-99A-01D      0.272 235 #>   pair_status FILTER #> 1     matched   PASS #> 2     matched   PASS #> 3   unmatched   PASS #> 4     matched   PASS #> 5     matched   PASS #> 6     matched   PASS nrow(hg38_myc_locus_sv) #> [1] 260  incorrect_myc_locus_sv <- get_manta_sv(region = myc_region_grch37,                                 projection = \"hg38\",                                 verbose = FALSE) #> Using the bundled metadata in GAMBLR.data... #> Using the bundled Manta SV (.bedpe) calls in GAMBLR.data... head(incorrect_myc_locus_sv) #> genomic_data Object #> Genome Build: hg38  #> Showing first 10 rows: #>  [1] CHROM_A          START_A          END_A            CHROM_B          #>  [5] START_B          END_B            manta_name       SCORE            #>  [9] STRAND_A         STRAND_B         tumour_sample_id normal_sample_id #> [13] VAF_tumour       DP               pair_status      FILTER           #> <0 rows> (or 0-length row.names) nrow(incorrect_myc_locus_sv) #> [1] 0 # The effect of specifying the wrong coordinate is evident  # Despite potentially being incomplete, we can nonetheless # annotate these directly for more details annotated_myc_hg38 = suppressMessages(          annotate_sv(hg38_myc_locus_sv, genome_build = \"hg38\") ) head(annotated_myc_hg38) #>   chrom1    start1      end1 chrom2    start2      end2 name score strand1 #> 1      8 127741233 127741234     12  25049104  25049105    .   219       + #> 2      8 127713694 127713694     14 105857950 105857950    .   109       - #> 3      8 127716025 127716934     14 105862581 105863164    .   112       + #> 4      8 127716523 127716523     14 105862757 105862757    .   173       - #> 5      8 127718148 127718148     14 105860256 105860256    .   152       + #> 6      8 127718150 127718150     14 105860564 105860564    .   163       - #>   strand2          tumour_sample_id gene partner   fusion #> 1       +                  FL1018T2  MYC    LRMP LRMP-MYC #> 2       + BLGSP-71-06-00280-01A-01D  MYC     IGH  IGH-MYC #> 3       - BLGSP-71-06-00084-01A-01D  MYC     IGH  IGH-MYC #> 4       + BLGSP-71-06-00084-01A-01D  MYC     IGH  IGH-MYC #> 5       - BLGSP-71-08-00036-01A-01D  MYC     IGH  IGH-MYC #> 6       + BLGSP-71-08-00036-01A-01D  MYC     IGH  IGH-MYC table(annotated_myc_hg38$partner) #>  #> BCL6  DMD  IGH  IGK  IGL LRMP PAX5  #>    1    2  247    3    2    1    4  # The usual MYC partners are seen here"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_sample_cn_segments.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Sample CN Segments. — get_sample_cn_segments","title":"Get Sample CN Segments. — get_sample_cn_segments","text":"Get segments single (multiple) sample_id(s).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_sample_cn_segments.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Sample CN Segments. — get_sample_cn_segments","text":"","code":"get_sample_cn_segments(   these_sample_ids = NULL,   these_samples_metadata = NULL,   projection = \"grch37\",   this_seq_type = \"genome\",   with_chr_prefix = FALSE,   streamlined = FALSE,   verbose = FALSE,   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_sample_cn_segments.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Sample CN Segments. — get_sample_cn_segments","text":"these_sample_ids Optional, vector multiple sample_id (single sample ID string) want results . these_samples_metadata Optional, metadata table (sample IDs column) subset return . provided (these_sample_ids provided), function return samples specified seq_type metadata. projection Selected genome projection returned CN segments. Default \"grch37\". this_seq_type Seq type returned CN segments. Default genome. with_chr_prefix Set TRUE add chr prefix chromosome names. Default FALSE. streamlined Return minimal output rather full details. Default FALSE. verbose Set FALSE minimize output console. Default TRUE. parameter also dictates verbosity helper function internally called inside main function. ... additional parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_sample_cn_segments.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Sample CN Segments. — get_sample_cn_segments","text":"data frame segments specific multiple sample ID(s).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_sample_cn_segments.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Sample CN Segments. — get_sample_cn_segments","text":"function returns CN segments. works single sample multiple samples. Specify sample IDs interested these_sample_ids (vector characters), call function these_samples_metadata already metadata table subset sample IDs interest. none parameters specified, function return CN segments available samples (get_gambl_metadata). Note, . function internally calls id_ease dealing sample IDs metadata tables.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_sample_cn_segments.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Sample CN Segments. — get_sample_cn_segments","text":"","code":"#load pacakges library(dplyr)  #get CN segments for one sample dohh2_segs = get_sample_cn_segments(these_sample_ids = \"DOHH-2\",                                     projection = \"hg38\",                                     streamlined = TRUE) #> Using the bundled CN segments (.seg) calls in GAMBLR.data... #> Using the bundled metadata in GAMBLR.data...  #get CN segments for DLBCL cell line cell_line_meta = GAMBLR.data::sample_data$meta %>%   dplyr::filter(cohort == \"DLBCL_cell_lines\")  dlbcl_segs = get_sample_cn_segments(these_samples_metadata = cell_line_meta,                                     streamlined = TRUE) #> Using the bundled CN segments (.seg) calls in GAMBLR.data..."},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_patients.html","id":null,"dir":"Reference","previous_headings":"","what":"Get SSM By Patients. — get_ssm_by_patients","title":"Get SSM By Patients. — get_ssm_by_patients","text":"Get MAF-format data frame one patient.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_patients.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get SSM By Patients. — get_ssm_by_patients","text":"","code":"get_ssm_by_patients(   these_patient_ids,   these_samples_metadata,   projection = \"grch37\",   this_seq_type = \"genome\",   tool_name = \"slms-3\",   this_study,   verbose = FALSE,   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_patients.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get SSM By Patients. — get_ssm_by_patients","text":"these_patient_ids vector patient IDs want results . user can also use metadata table subset patient IDs interest (see these_samples_metadata). these_samples_metadata metadata subset contain rows corresponding patients interest. vector patient IDs missing (these_patient_ids), function default patient IDs metadata table given parameter. projection Obtain variants projected reference (one grch37 hg38). Default grch37. this_seq_type seq type want results . Default \"genome\". tool_name Optionally specify tool report variant . default slms-3, also supports \"publication\" return exact variants reported original papers. this_study Optionally specify first name author paper variants returned . parameter can either vector indexes (integer) vector characters (matching columns MAF). verbose Set FALSE minimize output console. Default TRUE. parameter also dictates verbosity helper function internally called inside main function. ... additional parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_patients.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get SSM By Patients. — get_ssm_by_patients","text":"data frame SSM calls selected patients MAF format.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_patients.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get SSM By Patients. — get_ssm_by_patients","text":"function returns variants set patients. function internally calls get_ssm_by_samples. Thus, main contents function wrangle provided patient IDs, corresponding sample IDs can provided internal call get_ssm_by_samples. function expects either vector patient IDs (these_patients_ids) already subset metadata table (these_samples_metadata).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_patients.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get SSM By Patients. — get_ssm_by_patients","text":"","code":"# Lets find which patient_id occur more than once in the metadata first my_ids = get_gambl_metadata(seq_type_filter = c(\"genome\",\"capture\")) %>%              dplyr::group_by(patient_id) %>%              dplyr::tally() %>%              dplyr::filter(n>1) %>%              dplyr::pull(patient_id) #> Using the bundled metadata in GAMBLR.data...  #now let's get every SSM for all samples from these patients patient_maf = get_ssm_by_patients(these_patient_ids = my_ids) #> Using the bundled metadata in GAMBLR.data... #> Patient IDs and metadata were provided, this function will resort to all available patient IDs in the provided metadata. #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... patient_maf %>% dplyr::group_by(Tumor_Sample_Barcode) %>%                  dplyr::count() %>% head() #> genomic_data Object #> Genome Build: grch37  #> Showing first 10 rows: #>   Tumor_Sample_Barcode   n #> 1      00-14595_tumorA 476 #> 2      00-14595_tumorB 596 #> 3      00-14595_tumorC 679 #> 4      00-14595_tumorD 679 #> 5      00-15201_tumorA 208 #> 6      00-15201_tumorB 142"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_region.html","id":null,"dir":"Reference","previous_headings":"","what":"Get SSM By Region. — get_ssm_by_region","title":"Get SSM By Region. — get_ssm_by_region","text":"Retrieve SSMs GAMBL database within single genomic coordinate range.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_region.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get SSM By Region. — get_ssm_by_region","text":"","code":"get_ssm_by_region(   these_sample_ids = NULL,   these_samples_metadata = NULL,   maf_data,   chromosome,   qstart,   qend,   region = \"\",   streamlined = FALSE,   projection = \"grch37\",   this_seq_type = \"genome\",   tool_name = \"slms-3\",   this_study,   verbose = FALSE,   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_region.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get SSM By Region. — get_ssm_by_region","text":"these_sample_ids Optional, vector multiple sample_id (single sample ID string) want results . these_samples_metadata Optional, metadata table (sample IDs column) subset return . provided (these_sample_ids provided), function return samples specified seq_type metadata. maf_data Optional data frame mutations MAF format. user provides maf, function trusts user already subset samples interest, correct seq_type. .e following parameters ignored; these_samples_metadata, these_sample_ids, this_seq_type chromosome chromosome restricting (without chr prefix). qstart Query start coordinate range restricting . qend Query end coordinate range restricting . region Region formatted like chrX:1234-5678 instead specifying chromosome, start end separately. streamlined Return Start_Position Tumor_Smaple_Barcode two MAF columns. Default FALSE. projection Obtain variants projected reference (one grch37 hg38). this_seq_type seq_type want back, default genome. tool_name Optionally specify tool report variant . default slms-3, also supports \"publication\" return exact variants reported original papers. this_study Optionally specify first name author paper variants returned . verbose Set FALSE prevent message printed. cases, parameter left TRUE. parameter added accommodate noisy output running function loop retrieving SSM multiple regions get_ssm_by_regions. ... additional parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_region.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get SSM By Region. — get_ssm_by_region","text":"data frame containing mutations (MAF) specified region.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_region.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get SSM By Region. — get_ssm_by_region","text":"function lets user specify region interest returning SSM calls within region. multiple ways region can specified. example, user can provide full region \"region\" format (chr:start-end) region parameter. , user can provide chromosome, start end coordinates individually chr, start, end parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_region.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get SSM By Region. — get_ssm_by_region","text":"","code":"my_mutations = get_ssm_by_region(region = \"chr8:128,723,128-128,774,067\") #> Using the bundled metadata in GAMBLR.data...  #specifying chromosome, start and end individually my_mutations = get_ssm_by_region(chromosome = \"8\",                                  qstart = 128723128,                                  qend = 128774067) #> Using the bundled metadata in GAMBLR.data..."},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_regions.html","id":null,"dir":"Reference","previous_headings":"","what":"Get SSM By Regions. — get_ssm_by_regions","title":"Get SSM By Regions. — get_ssm_by_regions","text":"Efficiently retrieve mutations across range genomic regions.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_regions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get SSM By Regions. — get_ssm_by_regions","text":"","code":"get_ssm_by_regions(   these_samples_metadata,   regions_list,   regions_bed,   this_seq_type = \"genome\",   streamlined = TRUE,   projection = \"grch37\",   verbose = FALSE,   use_name_column = FALSE,   tool_name = \"slms-3\",   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_regions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get SSM By Regions. — get_ssm_by_regions","text":"these_samples_metadata Optional, metadata table (sample IDs column) subset return . regions_list vector regions chr:start-end format restrict returned SSM calls . regions_bed data frame BED format coordinates want retrieve (recommended). parameter can also accept additional column region names added return use_name_column = TRUE this_seq_type this_seq_type want back, default genome. streamlined set TRUE (default) 3 columns kept returned data frame (start, sample_id region_name). projection Obtain variants projected reference (one grch37 hg38), default grch37. verbose Set TRUE maximize output console. Default TRUE. parameter also dictates verbosity helper function internally called inside main function. use_name_column bed-format data frame name column (must named \"name\") can used name regions. tool_name Optionally specify tool report variant . default slms-3, also supports \"publication\" return exact variants reported original papers. ... additional parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_regions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get SSM By Regions. — get_ssm_by_regions","text":"Returns data frame variants MAF-like format.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_regions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get SSM By Regions. — get_ssm_by_regions","text":"function internally calls get_ssm_by_region retrieve SSM calls specified regions.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_regions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get SSM By Regions. — get_ssm_by_regions","text":"","code":"#basic usage, adding custom names from bundled ashm data frame regions_bed = create_bed_data( GAMBLR.data::grch37_ashm_regions,                           fix_names = \"concat\",                           concat_cols = c(\"gene\",\"region\"),                           sep=\"-\")  my_meta = get_gambl_metadata() #> Using the bundled metadata in GAMBLR.data... # get a full MAF-format data frame for all aSHM regions on grch37 coordinates ashm_maf = get_ssm_by_regions(regions_bed = regions_bed,                               these_samples_metadata = my_meta,                               streamlined = FALSE) #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> id_ease: WARNING! 1838 samples in the provided metadata were removed because their seq types are not the same as in the `set_type` argument. Use `verbose = TRUE` to see their IDs. #> Running in default mode of any...    one_region_maf = get_ssm_by_regions(regions_list = \"2:136875000-136875097\",                          streamlined = FALSE,                          projection = \"grch37\",                          these_samples_metadata = my_meta) #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> Using the bundled SSM calls (.maf) calls in GAMBLR.data... #> id_ease: WARNING! 1838 samples in the provided metadata were removed because their seq types are not the same as in the `set_type` argument. Use `verbose = TRUE` to see their IDs. #> Running in default mode of any... if (FALSE) { # \\dontrun{ # This example fails, as it should #ashm_maf = get_ssm_by_regions(regions_bed = regions_bed, #                              these_samples_metadata = my_meta, #                               projection=\"hg38\") # Error in get_ssm_by_regions(regions_bed = regions_bed, these_samples_metadata = my_meta,  :  # requested projection: hg38 and genome_build of regions_bed: grch37 don't match } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Get SSM By Samples. — get_ssm_by_samples","title":"Get SSM By Samples. — get_ssm_by_samples","text":"Get SSMs (.e. load MAF) single sample collection samples.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get SSM By Samples. — get_ssm_by_samples","text":"","code":"get_ssm_by_samples(   these_sample_ids = NULL,   these_samples_metadata = NULL,   this_seq_type = \"genome\",   projection = \"grch37\",   tool_name = \"slms-3\",   verbose = FALSE,   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get SSM By Samples. — get_ssm_by_samples","text":"these_sample_ids vector one sample IDs want results . these_samples_metadata Optional, metadata table (sample_id column) auto-subset data samples table returning. provided these_sample_ids also provided, function return SSM samples specified seq_type bundled metadata. this_seq_type Default genome. projection projection genome build. Supports hg38 grch37. tool_name Optionally specify tool report variant . default slms-3, also supports \"publication\" return exact variants reported original papers. verbose Enable debugging/noisier output. ... additional parameters.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get SSM By Samples. — get_ssm_by_samples","text":"data frame MAF format.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_samples.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get SSM By Samples. — get_ssm_by_samples","text":"Retrieve maf specific sample set samples. Either specify sample IDs interest these_sample_ids. metadata table subset sample IDs interest these_samples_metadata.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/get_ssm_by_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get SSM By Samples. — get_ssm_by_samples","text":"","code":"#Get genome-wide set of mutations from all DLBCL cell lines  # 1. get our metadata for the DLBCL cell lines cell_line_meta = get_gambl_metadata() %>%   dplyr::filter(cohort == \"DLBCL_cell_lines\") #> Using the bundled metadata in GAMBLR.data...  # 2. get the SSMs for the DLBCL cell lines dlbcl_maf = get_ssm_by_samples(these_samples_metadata = cell_line_meta) #> Using the bundled SSM calls (.maf) calls in GAMBLR.data...  # 3. have a look: dlbcl_maf %>% dplyr::group_by(Tumor_Sample_Barcode) %>%               dplyr::count() #> genomic_data Object #> Genome Build: grch37  #> Showing first 10 rows: #>   Tumor_Sample_Barcode     n #> 1               DOHH-2 22089 #> 2             OCI-Ly10 30051 #> 3              OCI-Ly3 31532 #> 4            SU-DHL-10 26855 #> 5             SU-DHL-4 32824"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/handle_genome_build.html","id":null,"dir":"Reference","previous_headings":"","what":"Harmonize different flavors of genome builds. — handle_genome_build","title":"Harmonize different flavors of genome builds. — handle_genome_build","text":"process different genome build flavors return consistent formatting used throughout package.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/handle_genome_build.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Harmonize different flavors of genome builds. — handle_genome_build","text":"","code":"handle_genome_build(incoming_genome_build)"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/handle_genome_build.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Harmonize different flavors of genome builds. — handle_genome_build","text":"incoming_genome_build string specifying genome build harmonized.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/handle_genome_build.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Harmonize different flavors of genome builds. — handle_genome_build","text":"string","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/id_ease.html","id":null,"dir":"Reference","previous_headings":"","what":"ID Ease — id_ease","title":"ID Ease — id_ease","text":"Internal convenience function standardize way GAMBLR functions deals sample IDs (these_sample_ids) metadata (these_samples_metadata).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/id_ease.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ID Ease — id_ease","text":"","code":"id_ease(   these_samples_metadata = NULL,   these_sample_ids = NULL,   this_seq_type = c(\"genome\", \"capture\"),   verbose = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/id_ease.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ID Ease — id_ease","text":"these_samples_metadata optional data frame metadata, subset sample IDs interest. provided retrieve GAMBL metadata available samples. these_sample_ids Optional character vector GAMBL sample IDs. this_seq_type seq type interest. Default genome exome, priority genome sample >1 seq_type. verbose Set FALSE limit information gets printed console. Default FALSE.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/id_ease.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ID Ease — id_ease","text":"Metadata (data frame).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/id_ease.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"ID Ease — id_ease","text":"function can take sample IDs vector characters, metadata table data frame format. sample IDs provided function, function operate gambl sample IDs available given seq type. highly recommended run function verbose = TRUE. Since improve overall logic function operates. also might help debugging functions internally calling function. function also performs sanity checks notifies user requested sample IDs found metadata. addition, function also notifies dimensions returned object, providing insight returned. GAMBLR functions, providing curated metadata table GAMBLR function (opposed vector IDs) safest way ensure get expected result.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/id_ease.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ID Ease — id_ease","text":"","code":"#load packages library(dplyr)  #give the function nothing (i.e return all sample IDs in the metadata for the default seq type) #return metadata for all samples in the default seq type all_meta = id_ease() #> Using the bundled metadata in GAMBLR.data...  #return metadata based on a sample ID sample_meta = id_ease(these_sample_ids = \"94-15772_tumorA\") #> Using the bundled metadata in GAMBLR.data...  #return sample IDs based on an already filtered metadata this_metadata = get_gambl_metadata(seq_type_filter = \"genome\") %>%    head(5) #> Using the bundled metadata in GAMBLR.data...  these_ids = id_ease(these_samples_metadata = this_metadata)"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/lacy_features.html","id":null,"dir":"Reference","previous_headings":"","what":"Features for DLBCL grouping by Lacy method. — lacy_features","title":"Features for DLBCL grouping by Lacy method. — lacy_features","text":"named list data frames lists needed assemble matrix classify DLBCL tumors according Lacy method described PMID: 32187361.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/lacy_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Features for DLBCL grouping by Lacy method. — lacy_features","text":"","code":"lacy_features"},{"path":[]},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/lacy_features.html","id":"lacy-features","dir":"Reference","previous_headings":"","what":"lacy_features","title":"Features for DLBCL grouping by Lacy method. — lacy_features","text":"named list.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/lymphgenerator_features.html","id":null,"dir":"Reference","previous_headings":"","what":"Features for DLBCL grouping by unified method. — lymphgenerator_features","title":"Features for DLBCL grouping by unified method. — lymphgenerator_features","text":"named list data frames lists needed assemble matrix classify DLBCL tumors according unified classification.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/lymphgenerator_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Features for DLBCL grouping by unified method. — lymphgenerator_features","text":"","code":"lymphgenerator_features"},{"path":[]},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/lymphgenerator_features.html","id":"lymphgenerator-features","dir":"Reference","previous_headings":"","what":"lymphgenerator_features","title":"Features for DLBCL grouping by unified method. — lymphgenerator_features","text":"named list.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_alluvial.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an Alluvial Plot Comparing Original and Predicted Classifications — make_alluvial","title":"Create an Alluvial Plot Comparing Original and Predicted Classifications — make_alluvial","text":"function generates detailed alluvial plot visualize concordance discordance original (e.g., Lymphgen) predicted (e.g., DLBCLone) class assignments samples. supports annotation concordance rates, per-group accuracy, unclassified rates, flexible labeling coloring options.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_alluvial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an Alluvial Plot Comparing Original and Predicted Classifications — make_alluvial","text":"","code":"make_alluvial(   optimized,   count_excluded_as_other = FALSE,   title = \"\",   group_order = NULL,   add_accuracy_to_title = TRUE,   accuracy_per_group = TRUE,   accuracy_type = \"sensitivity\",   truth_column = \"lymphgen\",   pred_name = \"DLBCLone\",   truth_name = \"Lymphgen\",   pred_column = \"predicted_label_optimized\",   nudge = 0.03,   box_nudge = 0.15,   min_flip_n = 10,   add_percent = TRUE,   add_unclass_rate = TRUE,   denom = 20,   label_size = 3,   label_lock_y = TRUE,   label_line_flip_colour = TRUE,   label_box_flip_colour = TRUE,   concordant_label_relative_pos = 0.5,   verbose = FALSE,   custom_colours = NULL,   hide_legend = TRUE,   rotate = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_alluvial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an Alluvial Plot Comparing Original and Predicted Classifications — make_alluvial","text":"optimized List containing prediction results metadata, typically output DLBCLone optimization function. count_excluded_as_other Logical; TRUE, samples excluded due missing features counted \"\" plot. title Plot title (default: empty string). group_order Character vector specifying order groups/classes axes coloring. add_accuracy_to_title Logical; TRUE, adds accuracy/concordance rate plot title. accuracy_per_group Logical; TRUE, computes displays per-group accuracy. accuracy_type Type accuracy report (default: \"sensitivity\"). nudge Amount nudge labels horizontally (default: 0.03). box_nudge Amount nudge label boxes (default: 0.15). min_flip_n Minimum number samples flow labeled (default: 10). add_percent Logical; TRUE, adds percent concordance labels. add_unclass_rate Logical; TRUE, adds unclassified rate annotation plot. denom Denominator stratum/flow width scaling (default: 20). label_size Size label text (default: 3). label_lock_y Logical; TRUE, locks label movement x-axis . label_line_flip_colour Logical; controls color assignment label lines. label_box_flip_colour Logical; controls color assignment label boxes. concordant_label_relative_pos Position concordant labels: 0 (left), 0.5 (middle), 1 (right). rotate  pred Name column predictions use predicted class (default: \"predicted_label_optimized\"). original_name Name original class column (default: \"Lymphgen\"). new_name Name predicted class column (default: \"DLBCLone\").","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_alluvial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an Alluvial Plot Comparing Original and Predicted Classifications — make_alluvial","text":"ggplot2 object representing alluvial plot.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_alluvial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create an Alluvial Plot Comparing Original and Predicted Classifications — make_alluvial","text":"Visualizes flows original predicted classes, highlighting concordant discordant assignments. Annotates concordance rate, per-group accuracy, unclassified rate specified. Supports flexible labeling, coloring, axis ordering publication-quality plots.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_alluvial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create an Alluvial Plot Comparing Original and Predicted Classifications — make_alluvial","text":"","code":"if (FALSE) { # \\dontrun{   make_alluvial(optimized_result) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_and_annotate_umap.html","id":null,"dir":"Reference","previous_headings":"","what":"Run UMAP and attach result to metadata — make_and_annotate_umap","title":"Run UMAP and attach result to metadata — make_and_annotate_umap","text":"Run UMAP attach result metadata","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_and_annotate_umap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run UMAP and attach result to metadata — make_and_annotate_umap","text":"","code":"make_and_annotate_umap(   df,   metadata,   umap_out,   truth_column = \"lymphgen\",   core_features = NULL,   core_feature_multiplier = 1.5,   hidden_features = NULL,   n_neighbors = 55,   min_dist = 0,   metric = \"cosine\",   n_epochs = 1500,   init = \"spca\",   ret_model = TRUE,   na_vals = \"drop\",   join_column = \"sample_id\",   seed = 12345,   target_column,   target_metric = \"euclidean\",   target_weight = 0.5,   calc_dispersion = FALSE,   algorithm = \"tumap\",   individually = TRUE,   make_plot = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_and_annotate_umap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run UMAP and attach result to metadata — make_and_annotate_umap","text":"df Feature matrix one row per sample one column per mutation metadata Metadata data frame one row per sample column sample_id matches row names df. data frame joined UMAP output. umap_out Optional UMAP output previous run. provided, function use model project data instead re-running UMAP. useful reproducibility using UMAP model different datasets. n_neighbors Passed UMAP2. number neighbors consider calculating UMAP embedding. min_dist Passed UMAP2. minimum distance points UMAP embedding. metric Passed UMAP2. distance metric use calculating distances points. n_epochs Passed UMAP2. number epochs run UMAP algorithm. init Passed UMAP2. initialization method UMAP algorithm. ret_model additional argument na_vals deal NA values. Two options \"drop\", remove columns containing least one NA \"to_zero\", sets NA zero leaves column intact. join_column column name metadata data frame contains sample IDs (default sample_id). seed Passed UMAP2. random seed reproducibility.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_and_annotate_umap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run UMAP and attach result to metadata — make_and_annotate_umap","text":"","code":"if (FALSE) { # \\dontrun{ #library(GAMBLR.predict)  # Load your mutation status data frame and # ensure sample_id is moved to row names all_full_status = readr::read_tsv(system.file(\"extdata/all_full_status.tsv\",                                   package = \"GAMBLR.predict\")) %>%                                   tibble::column_to_rownames(\"sample_id\") # Load sample metadata for training/labeling dlbcl_meta = readr::read_tsv(   system.file(\"extdata/dlbcl_meta_with_dlbclass.tsv\",               package = \"GAMBLR.predict\") ) my_umap <- make_and_annotate_umap(   df=all_full_status,   metadata=dlbcl_meta ) # Usually you'll immediately want to visualize it # make_umap_scatterplot(my_umap$df) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_neighborhood_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Make Neighborhood Plot — make_neighborhood_plot","title":"Make Neighborhood Plot — make_neighborhood_plot","text":"Generates UMAP plot highlighting neighborhood given sample, showing nearest neighbors group assignments.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_neighborhood_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make Neighborhood Plot — make_neighborhood_plot","text":"","code":"make_neighborhood_plot(   single_sample_prediction_output,   this_sample_id,   prediction_in_title = TRUE,   add_circle = TRUE,   label_column = \"DLBCLone_wo\",   point_size = 0.5,   point_alpha = 0.9,   line_alpha = 0.9 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_neighborhood_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make Neighborhood Plot — make_neighborhood_plot","text":"single_sample_prediction_output list containing prediction results annotation data frames. Must include elements prediction (data frame prediction results) anno_df (data frame UMAP coordinates annotations). this_sample_id Character. sample ID neighborhood plot generated. prediction_in_title Logical. TRUE, includes predicted label plot title. add_circle Plot include circle surrounding set neighbors. Set FALSE disable. label_column Specify column contains DLBCLone prediction want show. Default: optimized -balanced \"DLBCLone_wo\". point_size Numeric. size points plot. Default: 0.5. point_alpha Numeric. transparency level points plot. Default: 0.9. line_alpha Numeric. transparency level lines connecting sample neighbors. Default: 0.9.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_neighborhood_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make Neighborhood Plot — make_neighborhood_plot","text":"ggplot2 object representing UMAP plot selected sample neighbors highlighted.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_neighborhood_plot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Make Neighborhood Plot — make_neighborhood_plot","text":"function extracts nearest neighbors specified sample, draws segments connecting sample neighbors, colors points group (e.g., lymphgen subtype). plot title can optionally include predicted label.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_neighborhood_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make Neighborhood Plot — make_neighborhood_plot","text":"","code":"# Assuming 'pred_output' is the result of DLBCLone_predict_single_sample # on sample_id \"DLBCL10951T\".  if (FALSE) { # \\dontrun{  make_neighborhood_plot(pred_output, \"DLBCL10951T\") } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_umap_scatterplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Make UMAP scatterplot — make_umap_scatterplot","title":"Make UMAP scatterplot — make_umap_scatterplot","text":"Make UMAP scatterplot","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_umap_scatterplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make UMAP scatterplot — make_umap_scatterplot","text":"","code":"make_umap_scatterplot(   df,   drop_composite = TRUE,   colour_by = \"lymphgen\",   drop_other = FALSE,   high_confidence = FALSE,   custom_colours,   add_labels = FALSE,   title = NULL,   base_size = 8,   alpha = 0.8 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_umap_scatterplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make UMAP scatterplot — make_umap_scatterplot","text":"df Data frame containing UMAP coordinates (V1, V2) grouping columns. Typically df element output make_and_annotate_umap(). drop_composite Logical; TRUE, drops samples composite labels (e.g., \"EZB-COMP\"). colour_by Column name color points (default: \"lymphgen\"). drop_other Logical; TRUE, drops (hides) samples \"\" labels. high_confidence Logical; TRUE, includes samples high confidence predictions. custom_colours Named vector custom colors group. add_labels Logical; TRUE, adds labels points. title Plot title. base_size Base font point size plot (passed theme_Morons()). alpha Point transparency (default: 0.8).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_umap_scatterplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make UMAP scatterplot — make_umap_scatterplot","text":"ggplot object.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/make_umap_scatterplot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make UMAP scatterplot — make_umap_scatterplot","text":"","code":"if (FALSE) { # \\dontrun{ my_umap = make_and_annotate_umap(my_data, my_metadata) p = make_umap_scatterplot(my_umap$df,                           colour_by = \"lymphgen\",                           drop_other = TRUE) print(p) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/massage_matrix_for_clustering.html","id":null,"dir":"Reference","previous_headings":"","what":"Will prepare the data frame of binary matrix to be used as NMF input. This means that for the features with SSM and CNV, they will be squished together as one feature named GeneName-MUTorAMP or GeneName-MUTorLOSS, so the CNV features in the input data frame are expected to be named GeneName_AMP or GeneName_LOSS. Next, for the genes with hotspot mutations labelled in the input data as GeneNameHOTSPOT, the feature for hotspot mutation will be given preference and SSM with/without CNV will be set to 0 for that sample. The naming scheme of the features as in this description is important, because the function uses regex to searh for these patters as specified. Finally, if any features are provided to be dropped explicitly, they will be removed, and then the features not meeting the specified minimal frequency will be removed, as well as any samples with 0 features. Consistent with NMF input, in the input data frame each row is a feature, and each column is a sample. The input is expected to be numeric 1/0 with row and column names. — massage_matrix_for_clustering","title":"Will prepare the data frame of binary matrix to be used as NMF input. This means that for the features with SSM and CNV, they will be squished together as one feature named GeneName-MUTorAMP or GeneName-MUTorLOSS, so the CNV features in the input data frame are expected to be named GeneName_AMP or GeneName_LOSS. Next, for the genes with hotspot mutations labelled in the input data as GeneNameHOTSPOT, the feature for hotspot mutation will be given preference and SSM with/without CNV will be set to 0 for that sample. The naming scheme of the features as in this description is important, because the function uses regex to searh for these patters as specified. Finally, if any features are provided to be dropped explicitly, they will be removed, and then the features not meeting the specified minimal frequency will be removed, as well as any samples with 0 features. Consistent with NMF input, in the input data frame each row is a feature, and each column is a sample. The input is expected to be numeric 1/0 with row and column names. — massage_matrix_for_clustering","text":"prepare data frame binary matrix used NMF input. means features SSM CNV, squished together one feature named GeneName-MUTorAMP GeneName-MUTorLOSS, CNV features input data frame expected named GeneName_AMP GeneName_LOSS. Next, genes hotspot mutations labelled input data GeneNameHOTSPOT, feature hotspot mutation given preference SSM /without CNV set 0 sample. naming scheme features description important, function uses regex searh patters specified. Finally, features provided dropped explicitly, removed, features meeting specified minimal frequency removed, well samples 0 features. Consistent NMF input, input data frame row feature, column sample. input expected numeric 1/0 row column names.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/massage_matrix_for_clustering.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Will prepare the data frame of binary matrix to be used as NMF input. This means that for the features with SSM and CNV, they will be squished together as one feature named GeneName-MUTorAMP or GeneName-MUTorLOSS, so the CNV features in the input data frame are expected to be named GeneName_AMP or GeneName_LOSS. Next, for the genes with hotspot mutations labelled in the input data as GeneNameHOTSPOT, the feature for hotspot mutation will be given preference and SSM with/without CNV will be set to 0 for that sample. The naming scheme of the features as in this description is important, because the function uses regex to searh for these patters as specified. Finally, if any features are provided to be dropped explicitly, they will be removed, and then the features not meeting the specified minimal frequency will be removed, as well as any samples with 0 features. Consistent with NMF input, in the input data frame each row is a feature, and each column is a sample. The input is expected to be numeric 1/0 with row and column names. — massage_matrix_for_clustering","text":"","code":"massage_matrix_for_clustering(   incoming_data,   blacklisted_cnv_regex = \"3UTR|SV|HOTSPOT|TP53BP1|intronic\",   drop_these_features,   min_feature_percent = 0.005 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/massage_matrix_for_clustering.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Will prepare the data frame of binary matrix to be used as NMF input. This means that for the features with SSM and CNV, they will be squished together as one feature named GeneName-MUTorAMP or GeneName-MUTorLOSS, so the CNV features in the input data frame are expected to be named GeneName_AMP or GeneName_LOSS. Next, for the genes with hotspot mutations labelled in the input data as GeneNameHOTSPOT, the feature for hotspot mutation will be given preference and SSM with/without CNV will be set to 0 for that sample. The naming scheme of the features as in this description is important, because the function uses regex to searh for these patters as specified. Finally, if any features are provided to be dropped explicitly, they will be removed, and then the features not meeting the specified minimal frequency will be removed, as well as any samples with 0 features. Consistent with NMF input, in the input data frame each row is a feature, and each column is a sample. The input is expected to be numeric 1/0 with row and column names. — massage_matrix_for_clustering","text":"incoming_data Input data frame matrix prepare NMF. blacklisted_cnv_regex Regular expression match feature names considering SSM/CNV overlap. drop_these_features Optional argument features drop resulting matrix. min_feature_percent Minimum frequency feature returned resulting matrix. default, features present less 0.5% samples discarded.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/massage_matrix_for_clustering.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Will prepare the data frame of binary matrix to be used as NMF input. This means that for the features with SSM and CNV, they will be squished together as one feature named GeneName-MUTorAMP or GeneName-MUTorLOSS, so the CNV features in the input data frame are expected to be named GeneName_AMP or GeneName_LOSS. Next, for the genes with hotspot mutations labelled in the input data as GeneNameHOTSPOT, the feature for hotspot mutation will be given preference and SSM with/without CNV will be set to 0 for that sample. The naming scheme of the features as in this description is important, because the function uses regex to searh for these patters as specified. Finally, if any features are provided to be dropped explicitly, they will be removed, and then the features not meeting the specified minimal frequency will be removed, as well as any samples with 0 features. Consistent with NMF input, in the input data frame each row is a feature, and each column is a sample. The input is expected to be numeric 1/0 with row and column names. — massage_matrix_for_clustering","text":"matrix compatible NMF input.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/massage_matrix_for_clustering.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Will prepare the data frame of binary matrix to be used as NMF input. This means that for the features with SSM and CNV, they will be squished together as one feature named GeneName-MUTorAMP or GeneName-MUTorLOSS, so the CNV features in the input data frame are expected to be named GeneName_AMP or GeneName_LOSS. Next, for the genes with hotspot mutations labelled in the input data as GeneNameHOTSPOT, the feature for hotspot mutation will be given preference and SSM with/without CNV will be set to 0 for that sample. The naming scheme of the features as in this description is important, because the function uses regex to searh for these patters as specified. Finally, if any features are provided to be dropped explicitly, they will be removed, and then the features not meeting the specified minimal frequency will be removed, as well as any samples with 0 features. Consistent with NMF input, in the input data frame each row is a feature, and each column is a sample. The input is expected to be numeric 1/0 with row and column names. — massage_matrix_for_clustering","text":"","code":"if (FALSE) { # \\dontrun{ data = system.file(\"extdata\", \"sample_matrix.tsv\", package = \"GAMBLR.predict\") %>% read_tsv() %>% column_to_rownames(\"Feature\") NMF_input = massage_matrix_for_clustering(data) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/nearest_neighbor_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Heatmap visualization of mutations in nearest neighbors for a sample — nearest_neighbor_heatmap","title":"Heatmap visualization of mutations in nearest neighbors for a sample — nearest_neighbor_heatmap","text":"Generates heatmap feature values nearest neighbors specified sample, based DLBCLone model object. Supports outputs : DLBCLone_KNN (predict_unlabeled = TRUE) DLBCLone_optimize_params predict_single_sample_DLBCLone","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/nearest_neighbor_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Heatmap visualization of mutations in nearest neighbors for a sample — nearest_neighbor_heatmap","text":"","code":"nearest_neighbor_heatmap(   this_sample_id,   DLBCLone_model,   truth_column = \"lymphgen\",   metadata_cols = NULL,   clustering_distance = \"binary\",   font_size = 14,   gene_orientation = \"column\",   cluster_rows = TRUE,   cluster_columns = TRUE,   show_legend = FALSE,   draw = TRUE,   keep_metafeatures = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/nearest_neighbor_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Heatmap visualization of mutations in nearest neighbors for a sample — nearest_neighbor_heatmap","text":"this_sample_id Character. sample ID plot nearest neighbor heatmap. DLBCLone_model List. DLBCLone model object described . truth_column Character. Column name predictions/metadata use truth (default \"lymphgen\"). metadata_cols Optional character vector additional metadata columns annotate rows. clustering_distance Distance row clustering (default \"binary\"). font_size Numeric. Font size labels (default 14).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/nearest_neighbor_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Heatmap visualization of mutations in nearest neighbors for a sample — nearest_neighbor_heatmap","text":"ComplexHeatmap object (drawn).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/optimize_outgroup.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize the threshold for classifying samples as ","title":"Optimize the threshold for classifying samples as ","text":"Performs post-hoc evaluation classification sample one main classes vs outgroup/unclassified label \"\" returns optimal threshold classifying sample \"\" based ground truth provided true_labels vector. evaluates performance classifier using range thresholds returns best threshold based specified metric (balanced accuracy accuracy).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/optimize_outgroup.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize the threshold for classifying samples as ","text":"","code":"optimize_outgroup(   predicted_labels,   true_labels,   other_score,   all_classes = c(\"MCD\", \"EZB\", \"BN2\", \"N1\", \"ST2\", \"Other\"),   maximize = \"balanced_accuracy\",   exclude_other_for_accuracy = FALSE,   cap_classification_rate = 1,   verbose = FALSE,   other_class = \"Other\" )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/optimize_outgroup.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize the threshold for classifying samples as ","text":"predicted_labels Vector predicted labels samples true_labels Vector true labels samples other_score Vector scores \"\" class sample all_classes Vector classes use training testing. Default: c(\"MCD\",\"EZB\",\"BN2\",\"N1\",\"ST2\",\"\") maximize Metric use optimization. Either \"accuracy\" (actual accuracy across samples) \"balanced_accuracy\" (mean balanced accuracy values across classes). Default: \"balanced_accuracy\" exclude_other_for_accuracy Set TRUE exclude \"\" class 'lymphgen' column calculating accuracy metrics (passed DLBCLone_optimize_params). Default: FALSE","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/optimize_outgroup.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimize the threshold for classifying samples as ","text":"list data frames predictions UMAP input","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/optimize_outgroup.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Optimize the threshold for classifying samples as ","text":"NOTE: function generally meant called directly rather helper function used DLBCLone_optimize_params.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/optimize_purity.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize Purity Threshold for Classification Assignment — optimize_purity","title":"Optimize Purity Threshold for Classification Assignment — optimize_purity","text":"function searches optimal purity threshold assign samples predicted class \"\" based score ratio processed kNN vote results. iteratively tests range purity thresholds, updating predicted class score ratio meets exceeds threshold, computes accuracy threshold. function returns best accuracy achieved corresponding purity threshold. NOTE: helper function intended called directly user","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/optimize_purity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize Purity Threshold for Classification Assignment — optimize_purity","text":"","code":"optimize_purity(   optimized_model_object,   vote_df,   mode,   optimize_by = \"balanced_accuracy\",   truth_column,   all_classes = c(\"MCD\", \"EZB\", \"BN2\", \"N1\", \"ST2\", \"Other\"),   k,   cap_classification_rate = 1,   exclude_other_for_accuracy = FALSE,   other_class = \"Other\",   optimize_for_other = TRUE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/optimize_purity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize Purity Threshold for Classification Assignment — optimize_purity","text":"truth_column Name column processed_votes containing true class labels. processed_votes Data frame output process_votes, containing least columns score ratio, by_score_opt, relevant prediction truth columns. prediction_column Name column processed_votes update optimized prediction.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/optimize_purity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimize Purity Threshold for Classification Assignment — optimize_purity","text":"list two elements: best_accuracy (numeric, highest accuracy achieved) best_purity_threshold (numeric, threshold accuracy achieved).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/optimize_purity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Optimize Purity Threshold for Classification Assignment — optimize_purity","text":"threshold range 0.1 0.95 (step 0.05), function updates prediction column assign class by_score_opt score ratio meets threshold, otherwise assigns \"\". Accuracy computed proportion correct assignments (diagonal confusion matrix). function intended use optimizing classification purity kNN-based workflows, especially distinguishing confident class assignments ambiguous (\"\") cases.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/optimize_purity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Optimize Purity Threshold for Classification Assignment — optimize_purity","text":"","code":"# Example usage: if (FALSE) { # \\dontrun{ result <- optimize_purity(processed_votes,   prediction_column = \"pred_label\",   truth_column = \"true_label\") } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/posthoc_feature_enrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine feature enrichment per class using truth or predicted labels — posthoc_feature_enrichment","title":"Determine feature enrichment per class using truth or predicted labels — posthoc_feature_enrichment","text":"function identifies top N features (genes) subtype based prevalence dataset using either truth labels predicted subgroups DLBCLone.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/posthoc_feature_enrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine feature enrichment per class using truth or predicted labels — posthoc_feature_enrichment","text":"","code":"posthoc_feature_enrichment(   sample_metadata,   features,   label_column = \"lymphgen\",   truth_classes = c(\"BN2\", \"EZB\", \"MCD\", \"ST2\", \"N1\"),   method = \"frequency\",   num_feats = 10,   p_threshold = 0.01,   title = NULL,   base_size = 7,   separate_plot_per_group = TRUE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/posthoc_feature_enrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determine feature enrichment per class using truth or predicted labels — posthoc_feature_enrichment","text":"sample_metadata Data frame containing sample metadata class labels, default column named \"lymphgen\". Use label_column specify different column. label_column Name column containing class labels. default use \"lymphgen\", default truth class. truth_classes Vector class labels consider (default: c(\"BN2\",\"EZB\",\"MCD\",\"ST2\",\"N1\")). method Method determine top features: \"frequency\" abundant features, \"chi_square\" top differentially mutated features classes vs classes (default : \"frequency\"). num_feats Number top features display per subtype (default: 10). p_threshold Maximum P value retain (method fisher) title Title plot (default: NULL). base_size Base font size used (passed theme_Morons) separate_plot_per_group TRUE, creates separate plots group also combines ggarrange (default: FALSE).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/posthoc_feature_enrichment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determine feature enrichment per class using truth or predicted labels — posthoc_feature_enrichment","text":"ggplot2 object representing stacked bar plot.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/posthoc_feature_enrichment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Determine feature enrichment per class using truth or predicted labels — posthoc_feature_enrichment","text":"","code":"if (FALSE) { # \\dontrun{ library(GAMBLR.predict)  # Assuming my_DLBCLone_opt is the output from DLBCLone_optimize_params plot_list <- posthoc_feature_enrichment(     my_DLBCLone_opt$predictions,     features=DLBCLone_model$features,     method = \"chi_square\",     num_feats = 10,     title = \"LymphGen\" )  print(plot_list$bar_plot)  plot_list <- posthoc_feature_enrichment(    label_column = \"lymphgen\",    sample_metadata = my_DLBCLone_opt$predictions,    features = my_DLBCLone_opt$features,    method = \"fisher\",    num_feats = 10,    base_size=9 ) print(plot_list$forest_plot) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/process_votes.html","id":null,"dir":"Reference","previous_headings":"","what":"Process KNN Vote Strings and Scores for Classification — process_votes","title":"Process KNN Vote Strings and Scores for Classification — process_votes","text":"function processes raw neighbor label strings weighted vote scores k-nearest neighbor (KNN) classification results. computes per-class neighbor counts, weighted scores, identifies top group count score sample. function also supports custom logic handling \"\" class, including vote multipliers purity requirements. NOTE: helper function intended called directly user","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/process_votes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process KNN Vote Strings and Scores for Classification — process_votes","text":"","code":"process_votes(   df,   raw_col = \"label\",   group_labels = c(\"EZB\", \"MCD\", \"ST2\", \"BN2\", \"N1\", \"Other\"),   vote_labels_col = \"vote_labels\",   weighted_votes_col = \"weighted_votes\",   k,   other_vote_multiplier = 2,   score_purity_requirement = 1,   other_class = \"Other\",   optimize_for_other = TRUE,   debug = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/process_votes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process KNN Vote Strings and Scores for Classification — process_votes","text":"df Data frame containing kNN results, including columns neighbor labels weighted votes. raw_col Name column containing comma-separated neighbor labels (default: \"label\"). group_labels Character vector possible class labels consider (default: c(\"EZB\", \"MCD\", \"ST2\", \"BN2\", \"N1\", \"\")). vote_labels_col Name column containing comma-separated neighbor labels weighted votes (default: \"vote_labels\"). weighted_votes_col Name column containing comma-separated weighted votes (default: \"weighted_votes\"). k Number neighbors used kNN (required). other_vote_multiplier Multiplier \"\" class determining sample reclassified \"\" (default: 2). score_purity_requirement Minimum ratio top group score \"\" score assign sample top group (default: 1).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/process_votes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process KNN Vote Strings and Scores for Classification — process_votes","text":"Data frame additional columns per-class neighbor counts, scores, top group assignments, summary statistics sample.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/process_votes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Process KNN Vote Strings and Scores for Classification — process_votes","text":"Computes number neighbors class sum weighted votes per class. Identifies top group count weighted score, applies custom logic \"\" class present. Adds columns counts, scores, top group, top group score, score ratios, optimized group assignments. Designed downstream use DLBCLone similar kNN-based classification workflows.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/process_votes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Process KNN Vote Strings and Scores for Classification — process_votes","text":"","code":"# Example usage: # result <- process_votes(knn_output_df, k = 7)"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/report_accuracy.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Classification Accuracy and Per-Class Metrics based on Predictions — report_accuracy","title":"Calculate Classification Accuracy and Per-Class Metrics based on Predictions — report_accuracy","text":"Computes overall accuracy, balanced accuracy, sensitivity predicted vs. true class labels. Optionally excludes samples assigned \"\" class accuracy calculations.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/report_accuracy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Classification Accuracy and Per-Class Metrics based on Predictions — report_accuracy","text":"","code":"report_accuracy(   predictions,   truth = \"lymphgen\",   pred = \"DLBCLone_io\",   per_group = FALSE,   metric = \"accuracy\",   verbose = FALSE,   drop_other = TRUE,   skip_F1 = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/report_accuracy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Classification Accuracy and Per-Class Metrics based on Predictions — report_accuracy","text":"predictions Data frame containing predicted true class labels. truth Name column true class labels (default: \"lymphgen\"). pred Name column predicted class labels (default: \"predicted_label\"). per_group Logical; TRUE, computes per-group accuracy metrics. metric Character; type accuracy report (\"accuracy\" supported).","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/report_accuracy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Classification Accuracy and Per-Class Metrics based on Predictions — report_accuracy","text":"list : no_other Accuracy excluding samples assigned \"\" per_class Average balanced accuracy values class per_class_sensitivity Sensitivity per class overall Overall accuracy including samples","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/report_accuracy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate Classification Accuracy and Per-Class Metrics based on Predictions — report_accuracy","text":"Uses confusion matrices compute accuracy metrics. Excludes \"\" class no_other accuracy. Returns per-class metrics analysis.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/report_accuracy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Classification Accuracy and Per-Class Metrics based on Predictions — report_accuracy","text":"","code":"if (FALSE) { # \\dontrun{ result <- report_accuracy(predictions_df) result$overall result$per_class } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/summarize_all_ssm_status.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize SSM (Somatic Single Nucleotide Mutation) Status Across Samples — summarize_all_ssm_status","title":"Summarize SSM (Somatic Single Nucleotide Mutation) Status Across Samples — summarize_all_ssm_status","text":"function summarizes mutation status set genes across multiple samples, separating mutations class genes specified separate_by_class_genes counting number hits sample per mutation category.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/summarize_all_ssm_status.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize SSM (Somatic Single Nucleotide Mutation) Status Across Samples — summarize_all_ssm_status","text":"","code":"summarize_all_ssm_status(   maf_df,   these_samples_metadata,   genes_of_interest,   synon_genes,   silent_maf_df,   separate_by_class_genes = NULL,   count_hits = FALSE )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/summarize_all_ssm_status.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize SSM (Somatic Single Nucleotide Mutation) Status Across Samples — summarize_all_ssm_status","text":"maf_df data frame containing mutation annotation format (MAF) data, least following columns: Hugo_Symbol, Variant_Classification, Tumor_Sample_Barcode. these_samples_metadata data frame containing metadata samples, least sample_id column. sample matching sample_id these_samples_metadata dropped. genes_of_interest character vector gene symbols include summary. missing, defaults Tier 1 B-cell lymphoma genes. synon_genes (Optional) character vector gene symbols synonymous mutations included. silent_maf_df (Optional) separate data frame containing silent mutation data user want pull silent mutation status maf_df. argument useful want combine mutations output get_coding_ssm get_ssm_by_region get_ssm_by_gene separate_by_class_genes (Optional) character vector gene symbols mutations separated class (e.g., \"Nonsense_Mutation\", \"Missense_Mutation\"). count_hits Logical; TRUE, counts number mutations per gene per sample. FALSE (default), presence/absence recorded.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/summarize_all_ssm_status.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize SSM (Somatic Single Nucleotide Mutation) Status Across Samples — summarize_all_ssm_status","text":"wide-format data frame (matrix) samples rows mutation types columns. cell contains either count mutations (count_hits = TRUE) binary indicator (0/1) mutation presence.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/summarize_all_ssm_status.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize SSM (Somatic Single Nucleotide Mutation) Status Across Samples — summarize_all_ssm_status","text":"Mutations grouped optionally separated mutation class genes specified separate_by_class_genes Synonymous mutations can counted another separate feature genes specified synon_genes genes. function simplifies mutation annotations pivots data wide format suitable downstream analysis.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/summarize_all_ssm_status.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize SSM (Somatic Single Nucleotide Mutation) Status Across Samples — summarize_all_ssm_status","text":"","code":"# A basic example, using only the output of get_all_coding_ssm # Since the only non-coding class this function handles is Silent, # we will be missing most non-coding types such as Intron, UTR, Flank if (FALSE) { # \\dontrun{ sample_metadata = get_sample_metadata() %>% filter(seq_type!= \"mrna\")  maf_data = get_all_coding_ssm(sample_metadata)  mutation_matrix <- summarize_all_ssm_status(   maf_df = maf_data,   these_samples_metadata = sample_metadata,   genes_of_interest = c(\"TP53\", \"SGK1\", \"BCL2\"),   synon_genes = c(\"BCL2\"),   separate_by_class_genes = c(\"TP53\",\"SGK1\"),   count_hits = FALSE ) } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/tabulate_ssm_status.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Coding SSM Status. — tabulate_ssm_status","title":"Get Coding SSM Status. — tabulate_ssm_status","text":"Tabulate mutation status (SSM) set genes.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/tabulate_ssm_status.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Coding SSM Status. — tabulate_ssm_status","text":"","code":"tabulate_ssm_status(   gene_symbols,   these_samples_metadata,   maf_data,   include_hotspots = TRUE,   keep_multihit_hotspot = FALSE,   review_hotspots = TRUE,   genes_of_interest = c(\"FOXO1\", \"MYD88\", \"CREBBP\"),   genome_build,   include_silent = FALSE,   include_silent_genes,   ... )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/tabulate_ssm_status.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Coding SSM Status. — tabulate_ssm_status","text":"gene_symbols vector gene symbols mutation status tabulated. provided, lymphoma genes returned default. these_samples_metadata metadata samples interest included returned matrix. column \"sample_id\" required. provided, example metadata used default. maf_data data frame maf format. Must grch37 projection. include_hotspots Logical parameter indicating whether hotspots object also tabulated. Default TRUE. keep_multihit_hotspot Logical parameter indicating whether keep gene annotation mutated gene hot spot non-hotspot mutation. Default FALSE. set TRUE, report number non-hotspot mutations instead tabulating just mutation presence. review_hotspots Logical parameter indicating whether hotspots object reviewed include functionally relevant mutations rare lymphoma-related genes. Default TRUE. genes_of_interest vector genes hotspot review. Currently FOXO1, MYD88, CREBBP supported. genome_build Reference genome build coordinates MAF file. default inferred maf_data. include_silent Logical parameter indicating whether include silent mutations coding mutations. Default FALSE. include_silent_genes Optionally, provide list genes Silent variants considered. provided, Silent variants genes included regardless include_silent argument. ... parameter. parameters ignored.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/tabulate_ssm_status.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Coding SSM Status. — tabulate_ssm_status","text":"data frame tabulated mutation status.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/tabulate_ssm_status.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Coding SSM Status. — tabulate_ssm_status","text":"function takes data frame (MAF-like format) converts binary one-hot encoded matrix mutation status either set user-specified genes (via gene_symbols) , genes provided, default lymphoma genes. default behaviour assign gene/sample_id combination mutated protein coding mutation sample MAF can configured use synonymous variants (via include_silent_genes) (via include_silent) genes. function also filtering convenience parameters giving user full control return. information, refer parameter descriptions examples. Currently grch37 genome build supported hotspot annotation review version function.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/tabulate_ssm_status.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Coding SSM Status. — tabulate_ssm_status","text":"","code":"if (FALSE) { # \\dontrun{ coding_tabulated_df = tabulate_ssm_status(  maf_data = get_coding_ssm(),  gene_symbols = c(\"EZH2\",\"KMT2D\",\"CREBBP\",\"MYC\") )    #all lymphoma genes from bundled NHL gene list coding_tabulated_df = tabulate_ssm_status()  #this example will fail because hg38 is not supported by this function (yet) coding_tabulated_df = tabulate_ssm_status(maf_data=                         get_coding_ssm(projection = \"hg38\")) # Error in tabulate_ssm_status(maf_data = get_coding_ssm(projection = \"hg38\")) : # Currently only grch37 projection (hg19 genome build) is supported. } # }"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/weighted_knn_predict_with_conf.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted k-nearest neighbor with confidence estimate — weighted_knn_predict_with_conf","title":"Weighted k-nearest neighbor with confidence estimate — weighted_knn_predict_with_conf","text":"Weighted k-nearest neighbor confidence estimate","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/weighted_knn_predict_with_conf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted k-nearest neighbor with confidence estimate — weighted_knn_predict_with_conf","text":"","code":"weighted_knn_predict_with_conf(   train_coords,   train_labels,   test_coords,   k,   epsilon = 0.1,   conf_threshold = NULL,   other_class = \"Other\",   verbose = FALSE,   use_weights = TRUE,   max_neighbors = 500 )"},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/weighted_knn_predict_with_conf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted k-nearest neighbor with confidence estimate — weighted_knn_predict_with_conf","text":"train_coords Data frame coordinates labeled (training) samples. One row per sample, columns features (typically UMAP V1, V2). train_labels Character/factor vector labels training samples. test_coords Data frame coordinates samples classify (columns/space train_coords). k Integer; number neighbors consider. epsilon Numeric; small value added distances weighting (use_weights = TRUE). Default: 0.1. conf_threshold Optional numeric; minimum confidence assigning class. provided confidence < threshold, sample assigned other_class. other_class Name outgroup class treat specially separate_other = TRUE. Default: \"\". verbose Logical; print verbose info. Default: FALSE. use_weights Logical; inverse-distance weights (1 / (d + epsilon)). FALSE, neighbors contribute equally. Default: TRUE. max_neighbors Integer; maximum neighbors retrieve search index trimming k. Default: 500. ignore_self Logical; drop zero-distance self-neighbor. Default: TRUE. track_neighbors Logical; append neighbor diagnostics output. Default: TRUE. separate_other Logical; TRUE, exclude neighbors labeled other_class main weighted vote report influence separately (other_* columns). Default: TRUE.","code":""},{"path":"https://morinlab.github.io/GAMBLR.predict/reference/weighted_knn_predict_with_conf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weighted k-nearest neighbor with confidence estimate — weighted_knn_predict_with_conf","text":"Data frame rows = test samples columns: predicted_label predicted class confidence predicted class weight / total weight track_neighbors = TRUE, additional columns: other_score relative weight outgroup vs predicted class neighbor_id comma-separated neighbor sample IDs neighbor comma-separated neighbor indices (train order) distance comma-separated neighbor distances label comma-separated neighbor labels (-group separate_other=TRUE) vote_labels comma-separated unique labels contributing weights weighted_votes comma-separated weights per vote_labels neighbors_other count outgroup neighbors closer farthest -group neighbor other_weighted_votes sum outgroup weights closer farthest -group neighbor total_w sum weights -group neighbors used pred_w weight supporting predicted class","code":""}]
