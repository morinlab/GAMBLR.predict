<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Classify DLBCLs according to genetic subgroups. — classify_dlbcl • GAMBLR.predict</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Classify DLBCLs according to genetic subgroups. — classify_dlbcl"><meta name="description" content="Using the user-provided or GAMBLR.data-retrieved data, this function will
assemble the matrix according to the approach of Chapuy et al (2018) or Lacy
et al (2020) classifiers. Since neither of this classifiers is publicly
released, we have implemented a solution that closely (&amp;gt; 92% accuracy)
recapitulates each of these systems. For the classifier of Chapuy et al, the
constructed matrix will be used to calculate class probability using the
bundled feature weights obtained from our reproduction of the classifier. For
the Lacy et al classifier, the matrix will be used for prediction of random
forest model, which is supplied with the GAMBLR.predict package. Following
the modification of Lacy classifier described in Runge et al (PMID 33010029),
specifying the method of this function as hmrn will also consider
truncating mutations in NOTCH1 for the separate N1 subgroup."><meta property="og:description" content="Using the user-provided or GAMBLR.data-retrieved data, this function will
assemble the matrix according to the approach of Chapuy et al (2018) or Lacy
et al (2020) classifiers. Since neither of this classifiers is publicly
released, we have implemented a solution that closely (&amp;gt; 92% accuracy)
recapitulates each of these systems. For the classifier of Chapuy et al, the
constructed matrix will be used to calculate class probability using the
bundled feature weights obtained from our reproduction of the classifier. For
the Lacy et al classifier, the matrix will be used for prediction of random
forest model, which is supplied with the GAMBLR.predict package. Following
the modification of Lacy classifier described in Runge et al (PMID 33010029),
specifying the method of this function as hmrn will also consider
truncating mutations in NOTCH1 for the separate N1 subgroup."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GAMBLR.predict</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/index.html">DLBCLone: Overview</a></li>
    <li><a class="dropdown-item" href="../articles/umap.html">Exploring and selecting features</a></li>
    <li><a class="dropdown-item" href="../articles/DLBCLone_optimize_params.html">Training a new DLBCLone model</a></li>
    <li><a class="dropdown-item" href="../articles/DLBCLone_stored.html">DLBCLone Models</a></li>
    <li><a class="dropdown-item" href="../articles/predict_samples.html">Classifying samples with DLBCLone</a></li>
    <li><a class="dropdown-item" href="../articles/full_walkthrough.html">DLBCLone: Full Walkthrough</a></li>
    <li><a class="dropdown-item" href="../articles/validation.html">Applying a DLBCLone model to new data</a></li>
    <li><a class="dropdown-item" href="../articles/DLBCLone_KNN.html">K-Nearest Neighbors without UMAP</a></li>
    <li><a class="dropdown-item" href="../articles/DLBCLone_mixture_model.html">Gaussian Mixture Model</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Classify DLBCLs according to genetic subgroups.</h1>

      <div class="d-none name"><code>classify_dlbcl.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Using the user-provided or GAMBLR.data-retrieved data, this function will
assemble the matrix according to the approach of Chapuy et al (2018) or Lacy
et al (2020) classifiers. Since neither of this classifiers is publicly
released, we have implemented a solution that closely (&gt; 92% accuracy)
recapitulates each of these systems. For the classifier of Chapuy et al, the
constructed matrix will be used to calculate class probability using the
bundled feature weights obtained from our reproduction of the classifier. For
the Lacy et al classifier, the matrix will be used for prediction of random
forest model, which is supplied with the GAMBLR.predict package. Following
the modification of Lacy classifier described in Runge et al (PMID 33010029),
specifying the method of this function as <code>hmrn</code> will also consider
truncating mutations in NOTCH1 for the separate N1 subgroup.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">classify_dlbcl</span><span class="op">(</span></span>
<span>  <span class="va">these_samples_metadata</span>,</span>
<span>  <span class="va">maf_data</span>,</span>
<span>  only_maf_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">seg_data</span>,</span>
<span>  <span class="va">sv_data</span>,</span>
<span>  projection <span class="op">=</span> <span class="st">"grch37"</span>,</span>
<span>  this_seq_type <span class="op">=</span> <span class="st">"genome"</span>,</span>
<span>  output <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"chapuy"</span>,</span>
<span>  adjust_ploidy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  annotate_sv <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-these-samples-metadata">these_samples_metadata<a class="anchor" aria-label="anchor" href="#arg-these-samples-metadata"></a></dt>
<dd><p>The metadata data frame that contains sample_id
column with ids for the samples to be classified.</p></dd>


<dt id="arg-maf-data">maf_data<a class="anchor" aria-label="anchor" href="#arg-maf-data"></a></dt>
<dd><p>The MAF data frame to be used for matrix assembling. At least
must contain the first 45 columns of standard MAF format.</p></dd>


<dt id="arg-only-maf-data">only_maf_data<a class="anchor" aria-label="anchor" href="#arg-only-maf-data"></a></dt>
<dd><p>Whether to restrict matrix generation to maf data only.
Only supported in the lymphgenerator mode. Default is FALSE (use SV and
CNV).</p></dd>


<dt id="arg-seg-data">seg_data<a class="anchor" aria-label="anchor" href="#arg-seg-data"></a></dt>
<dd><p>The SEG data frame to be used for matrix assembling. Must be
of standard SEG formatting, for example, as returned by
get_sample_cn_segments. Expected to be in grch37 projection.</p></dd>


<dt id="arg-sv-data">sv_data<a class="anchor" aria-label="anchor" href="#arg-sv-data"></a></dt>
<dd><p>The SV data frame to be used for matrix assembling. Must be of
standard BEDPE formatting, for example, as returned by get_manta_sv.
Expected to be in grch37 projection.</p></dd>


<dt id="arg-projection">projection<a class="anchor" aria-label="anchor" href="#arg-projection"></a></dt>
<dd><p>The projection of the samples. Used to adjust ploidy
when seg data is provided and annotate SVs when necessary. Defaults to
grch37.</p></dd>


<dt id="arg-this-seq-type">this_seq_type<a class="anchor" aria-label="anchor" href="#arg-this-seq-type"></a></dt>
<dd><p>Only used for the lymphgenerator matrix generation. The
seq_type defines the cutoff to consider aSHM site mutate. For genomes,
it will assign status <code>mutated</code> based on the average pathology-adjusted
number of mutations. For capture samples, any mutation at the aSHM site
will result in the <code>mutated</code> annotation. This argument is ignored in
any of <code>chapuy</code>, <code>lacy</code>, and <code>hmrn</code> methods.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>The output to be returned after the prediction is done. Can be
one of predictions, matrix, or both. Defaults to both.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Classification method. One of chapuy (used as default), lacy,
or hmrn.</p></dd>


<dt id="arg-adjust-ploidy">adjust_ploidy<a class="anchor" aria-label="anchor" href="#arg-adjust-ploidy"></a></dt>
<dd><p>Whether to perform ploidy adjustment for the CNV data.
Defaults to TRUE (recommended).</p></dd>


<dt id="arg-annotate-sv">annotate_sv<a class="anchor" aria-label="anchor" href="#arg-annotate-sv"></a></dt>
<dd><p>Whether to perform SV annotation on the supplied SV data
frame. Defaults to TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>data frame, binary matrix, or both</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu">get_gambl_metadata</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pathology</span> <span class="op">==</span> <span class="st">"DLBCL"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">maf</span> <span class="op">&lt;-</span> <span class="fu">get_ssm_by_samples</span><span class="op">(</span></span></span>
<span class="r-in"><span>    these_samples_metadata <span class="op">=</span> <span class="va">metadata</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cnv</span> <span class="op">&lt;-</span> <span class="fu">get_cn_segments</span><span class="op">(</span></span></span>
<span class="r-in"><span>    these_samples_metadata <span class="op">=</span> <span class="va">metadata</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bed</span> <span class="op">&lt;-</span> <span class="fu">get_manta_sv</span><span class="op">(</span></span></span>
<span class="r-in"><span>    these_samples_metadata <span class="op">=</span> <span class="va">metadata</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">predictions_chapuy</span> <span class="op">&lt;-</span> <span class="fu">classify_dlbcl</span><span class="op">(</span></span></span>
<span class="r-in"><span>    these_samples_metadata <span class="op">=</span> <span class="va">metadata</span>,</span></span>
<span class="r-in"><span>    maf_data <span class="op">=</span> <span class="va">maf</span>,</span></span>
<span class="r-in"><span>    seg_data <span class="op">=</span> <span class="va">cnv</span>,</span></span>
<span class="r-in"><span>    sv_data <span class="op">=</span> <span class="va">bed</span>,</span></span>
<span class="r-in"><span>    output <span class="op">=</span> <span class="st">"predictions"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">predictions_lacy</span> <span class="op">&lt;-</span> <span class="fu">classify_dlbcl</span><span class="op">(</span>these_samples_metadata <span class="op">=</span> <span class="va">test_meta</span>, method <span class="op">=</span> <span class="st">"lacy"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">predictions_hmrn</span> <span class="op">&lt;-</span> <span class="fu">classify_dlbcl</span><span class="op">(</span>these_samples_metadata <span class="op">=</span> <span class="va">test_meta</span>, method <span class="op">=</span> <span class="st">"hmrn"</span>, output <span class="op">=</span> <span class="st">"predictions"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">matrix_and_predictions</span> <span class="op">&lt;-</span> <span class="fu">classify_dlbcl</span><span class="op">(</span>these_samples_metadata <span class="op">=</span> <span class="va">test_meta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kostiantyn Dreval, Ryan Morin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

