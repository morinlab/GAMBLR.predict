<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>DLBCLone — Validation Data Generation and Example • GAMBLR.predict</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="validation_files/libs/quarto-html/popper.min.js"></script><script src="validation_files/libs/quarto-html/tippy.umd.min.js"></script><link href="validation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="validation_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DLBCLone — Validation Data Generation and Example">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">GAMBLR.predict</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/index.html">DLBCLone</a></li>
    <li><a class="dropdown-item" href="../articles/umap.html">DLBCLone Functions — UMAP</a></li>
    <li><a class="dropdown-item" href="../articles/DLBCLone_optimize_params.html">DLBCLone Functions — Optimizing Parameters</a></li>
    <li><a class="dropdown-item" href="../articles/DLBCLone_stored.html">DLBCLone Functions — DLBCLone Model Management</a></li>
    <li><a class="dropdown-item" href="../articles/predict_samples.html">UNKNOWN TITLE</a></li>
    <li><a class="dropdown-item" href="../articles/full_walkthrough.html">DLBCLone Full Walkthrough of Associated Functions</a></li>
    <li><a class="dropdown-item" href="../articles/validation.html">DLBCLone — Validation Data Generation and Example</a></li>
    <li><a class="dropdown-item" href="../articles/DLBCLone_KNN.html">DLBCLone Functions — K-Nearest Neighbors</a></li>
    <li><a class="dropdown-item" href="../articles/DLBCLone_mixture_model.html">DLBCLone Functions — Gaussian Mixture Model</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>DLBCLone — Validation Data Generation and Example</h1>





      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level3"><h3 id="load-the-gamblr-predict-package-associated-training-files-from-extdata">Load the GAMBLR.predict package associated training files from extdata:<a class="anchor" aria-label="anchor" href="#load-the-gamblr-predict-package-associated-training-files-from-extdata"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_full_status_train</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/all_full_status.tsv"</span>,package <span class="op">=</span> <span class="st">"GAMBLR.predict"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"sample_id"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dlbcl_meta</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/dlbcl_meta_with_dlbclass.tsv"</span>,package <span class="op">=</span> <span class="st">"GAMBLR.predict"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dlbcl_meta_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dlbcl_meta</span>,</span>
<span>                          <span class="va">lymphgen</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MCD"</span>,<span class="st">"EZB"</span>,<span class="st">"BN2"</span>,<span class="st">"N1"</span>,<span class="st">"ST2"</span>,<span class="st">"Other"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="generating-validation-data">Generating Validation Data<a class="anchor" aria-label="anchor" href="#generating-validation-data"></a>
</h2>
<p>When using DLBCLone, you need to provide the following files to initialize training: metadata, and MAF data. In this example, I will go step by step producing a mutation matrix for a validation test. When producing training data your metadata <em>must</em> possess a truth column containing genetic subtype results for each sample as a result of running a previous model (ie. LymphGen, DLBclass, etc.). When producing a test or validation set for your training, the truth column is not required in the metadata. MAF and metadata files are required to assemble the feature matrix that will be used for UMAP and KNN approximation on your samples. The validation will focus on a lyseq feature matrix.</p>
<section class="level2"><h3 id="metadata-data">metadata data<a class="anchor" aria-label="anchor" href="#metadata-data"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_meta_dir</span> <span class="op">&lt;-</span> <span class="st">"../data/metadata/metadata_sequencing_vaf.tsv"</span></span>
<span></span>
<span><span class="va">valid_metadata_vaf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="va">valid_meta_dir</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sample_id <span class="op">=</span> <span class="va">DNAseq_sample_id</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="maf-data">MAF data<a class="anchor" aria-label="anchor" href="#maf-data"></a>
</h3>
<p>When using MAF files in GAMBLR functions, the MAF must be a S3 object. Simply feed the MAF dataframe through GAMBLR.util’s <code>create_maf_data</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_maf_dir</span> <span class="op">&lt;-</span> <span class="st">"../data/maf/LySeqST_only_read_threshold_vaf.maf"</span></span>
<span></span>
<span><span class="va">valid_maf_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="va">valid_maf_dir</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    sample_id <span class="op">=</span> <span class="va">Tumor_Sample_Barcode</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">GAMBLR.utils</span><span class="op">)</span> <span class="co"># S3 compatible maf generation for GAMBLR functions</span></span>
<span></span>
<span><span class="va">valid_maf_vaf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GAMBLR.utils/man/create_maf_data.html" class="external-link">create_maf_data</a></span><span class="op">(</span></span>
<span>  maf_df <span class="op">=</span> <span class="va">valid_maf_df</span>,</span>
<span>  genome_build <span class="op">=</span> <span class="st">"grch37"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="lyseq-features">lyseq features<a class="anchor" aria-label="anchor" href="#lyseq-features"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyseq_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"TNFRSF14"</span>, <span class="st">"SPEN"</span>, <span class="st">"ID3"</span>, <span class="st">"ARID1A"</span>, <span class="st">"RRAGC"</span>,</span>
<span>  <span class="st">"BCL10"</span>, <span class="st">"CD58"</span>, <span class="st">"NOTCH2"</span>, <span class="st">"FCGR2B"</span>, <span class="st">"FCRLA"</span>,</span>
<span>  <span class="st">"FAS"</span>, <span class="st">"CCND1"</span>, <span class="st">"BIRC3"</span>, <span class="st">"ATM"</span>, <span class="st">"KMT2D"</span>,</span>
<span>  <span class="st">"STAT6"</span>, <span class="st">"BTG1"</span>, <span class="st">"FOXO1"</span>, <span class="st">"B2M"</span>, <span class="st">"MAP2K1"</span>,</span>
<span>  <span class="st">"IDH2"</span>, <span class="st">"CHD2"</span>, <span class="st">"CREBBP"</span>, <span class="st">"SOCS1"</span>, <span class="st">"IL4R"</span>,</span>
<span>  <span class="st">"PLCG2"</span>, <span class="st">"TP53"</span>, <span class="st">"STAT5B"</span>, <span class="st">"STAT3"</span>, <span class="st">"CD79B"</span>,</span>
<span>  <span class="st">"GNA13"</span>, <span class="st">"BCL2"</span>, <span class="st">"TCF3"</span>, <span class="st">"S1PR2"</span>, <span class="st">"JAK3"</span>,</span>
<span>  <span class="st">"MEF2B"</span>, <span class="st">"DNMT3A"</span>, <span class="st">"XPO1"</span>, <span class="st">"CXCR4"</span>, <span class="st">"SF3B1"</span>,</span>
<span>  <span class="st">"PTPN1"</span>, <span class="st">"XBP1"</span>, <span class="st">"EP300"</span>, <span class="st">"MYD88"</span>, <span class="st">"SETD2"</span>,</span>
<span>  <span class="st">"RHOA"</span>, <span class="st">"NFKBIZ"</span>, <span class="st">"TBL1XR1"</span>, <span class="st">"KLHL6"</span>, <span class="st">"TET2"</span>,</span>
<span>  <span class="st">"PIM1"</span>, <span class="st">"CCND3"</span>, <span class="st">"TMEM30A"</span>, <span class="st">"PRDM1"</span>, <span class="st">"SGK1"</span>,</span>
<span>  <span class="st">"TNFAIP3"</span>, <span class="st">"CARD11"</span>, <span class="st">"POT1"</span>, <span class="st">"BRAF"</span>, <span class="st">"EZH2"</span>,</span>
<span>  <span class="st">"UBR5"</span>, <span class="st">"MYC"</span>, <span class="st">"NOTCH1"</span>, <span class="st">"TRAF2"</span>, <span class="st">"P2RY8"</span>,</span>
<span>  <span class="st">"BTK"</span>, <span class="st">"TP73"</span>, <span class="st">"NOL9"</span>, <span class="st">"SEMA4A"</span>, <span class="st">"PRRC2C"</span>,</span>
<span>  <span class="st">"BTG2"</span>, <span class="st">"ITPKB"</span>, <span class="st">"SEC24C"</span>, <span class="st">"EDRF1"</span>, <span class="st">"WEE1"</span>,</span>
<span>  <span class="st">"MPEG1"</span>, <span class="st">"ETS1"</span>, <span class="st">"DTX1"</span>, <span class="st">"SETD1B"</span>, <span class="st">"NFKBIA"</span>,</span>
<span>  <span class="st">"ZFP36L1"</span>, <span class="st">"CIITA"</span>, <span class="st">"MBTPS1"</span>, <span class="st">"IRF8"</span>, <span class="st">"ACTG1"</span>,</span>
<span>  <span class="st">"KLHL14"</span>, <span class="st">"MED16"</span>, <span class="st">"CD70"</span>, <span class="st">"JUNB"</span>, <span class="st">"KLF2"</span>,</span>
<span>  <span class="st">"CD79A"</span>, <span class="st">"DYSF"</span>, <span class="st">"DUSP2"</span>, <span class="st">"BCL2L1"</span>, <span class="st">"PRDM15"</span>,</span>
<span>  <span class="st">"RFTN1"</span>, <span class="st">"OSBPL10"</span>, <span class="st">"EIF4A2"</span>, <span class="st">"BCL6"</span>, <span class="st">"IRF4"</span>,</span>
<span>  <span class="st">"FOXC1"</span>, <span class="st">"CD83"</span>, <span class="st">"H2BC4"</span>, <span class="st">"H1-3"</span>, <span class="st">"H1-5"</span>,</span>
<span>  <span class="st">"HLA-A"</span>, <span class="st">"HLA-B"</span>, <span class="st">"PRRC2A"</span>, <span class="st">"TBCC"</span>, <span class="st">"INTS1"</span>,</span>
<span>  <span class="st">"ACTB"</span>, <span class="st">"PIK3CG"</span>, <span class="st">"PRKDC"</span>, <span class="st">"TOX"</span>, <span class="st">"CDKN2A"</span>,</span>
<span>  <span class="st">"GRHPR"</span>, <span class="st">"DDX3X"</span>, <span class="st">"PIM2"</span>, <span class="st">"UBE2A"</span>, <span class="st">"ETV6"</span>,</span>
<span>  <span class="st">"MS4A1"</span>, <span class="st">"CD19"</span>, <span class="st">"HNRNPD"</span>, <span class="st">"NFKBIE"</span>, <span class="st">"TMSB4X"</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</section></section><section class="section level2"><h2 id="assemble_genetic_features">assemble_genetic_features<a class="anchor" aria-label="anchor" href="#assemble_genetic_features"></a>
</h2>
<p>This function allows you to assemble all samples producing a matrix of genetic features. This includes mutation status, and structural variant status for BCL2, BCL6, and MYC. This customizable function allows you to pick apart what features you are most interested in, as well as the option to assign different values for the class of genetic features.</p>
<p><code>these_samples_metadata</code> data frame with sample metadata, must include seq_type and sample_id</p>
<p><code>sv_from_metadata</code> columns in metadata to use for SV status (default: c(“BCL2”,“BCL6”,“MYC”))</p>
<p><code>genes</code> vector of gene symbols to include</p>
<p><code>synon_genes</code> vector of gene symbols for synonymous mutations</p>
<p><code>maf_with_synon</code> MAF data frame including synonymous mutations</p>
<p><code>hotspot_genes</code> vector of hotspot genes</p>
<p><code>sv_value</code> value to assign for SV presence (default: 3)</p>
<p><code>synon_value</code> value to assign for synonymous mutations (default: 1)</p>
<p><code>coding_value</code> value to assign for coding mutations (default: 2)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyseq_valid</span> <span class="op">=</span> <span class="fu"><a href="../reference/assemble_genetic_features.html">assemble_genetic_features</a></span><span class="op">(</span></span>
<span>  these_samples_metadata <span class="op">=</span> <span class="va">valid_metadata_vaf</span>,</span>
<span>  sv_from_metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>BCL2 <span class="op">=</span> <span class="st">'BCL2.Translocation'</span>, BCL6 <span class="op">=</span> <span class="st">'BCL6.Translocation'</span><span class="op">)</span>,</span>
<span>  genes<span class="op">=</span><span class="va">lyseq_genes</span>,</span>
<span>  maf_with_synon <span class="op">=</span> <span class="va">valid_maf_vaf</span>,</span>
<span>  hotspot_genes <span class="op">=</span> <span class="st">"MYD88"</span>,</span>
<span>  synon_genes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PIM1"</span>,<span class="st">"SOCS1"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="full-walkthrough-with-validation-data">Full Walkthrough with Validation Data<a class="anchor" aria-label="anchor" href="#full-walkthrough-with-validation-data"></a>
</h2>
<p>Now that we have a feature set different from the training provided earlier <code>&lt;all_full_status_train&gt;</code> we can now validate DLBCLone. It is important to ensure the training matches the features of the validation or test set to ensure the featrues in your training provide appropriate, accurate, predictions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">all_full_status_train</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 202</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">lyseq_valid</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 116</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyseq_train</span> <span class="op">&lt;-</span> <span class="va">all_full_status_train</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lyseq_valid</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">lyseq_train</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">lyseq_valid</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<section class="level2"><h3 id="make_and_annotate_umap">make_and_annotate_umap<a class="anchor" aria-label="anchor" href="#make_and_annotate_umap"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_lyseq_train</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_and_annotate_umap.html">make_and_annotate_umap</a></span><span class="op">(</span></span>
<span>  <span class="va">lyseq_train</span>,</span>
<span>  <span class="va">dlbcl_meta_clean</span>,</span>
<span>  core_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    ST2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SGK1"</span>,<span class="st">"DUSP2"</span>,<span class="st">"TET2"</span>,<span class="st">"SOCS1"</span><span class="op">)</span>,</span>
<span>    N1<span class="op">=</span><span class="st">"NOTCH1"</span>,</span>
<span>    EZB<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EZH2"</span>,<span class="st">"BCL2_SV"</span><span class="op">)</span>,</span>
<span>    MCD<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MYD88HOTSPOT"</span>,<span class="st">"CD79B"</span>,<span class="st">"PIM1"</span><span class="op">)</span>,</span>
<span>    BN2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BCL6_SV"</span>,<span class="st">"NOTCH2"</span>,<span class="st">"SPEN"</span>,<span class="st">"CD70"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="dlbclone_optimize_params">DLBCLone_optimize_params<a class="anchor" aria-label="anchor" href="#dlbclone_optimize_params"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lyseq_features_optimized_train</span> <span class="op">=</span> <span class="fu"><a href="../reference/DLBCLone_optimize_params.html">DLBCLone_optimize_params</a></span><span class="op">(</span>  </span>
<span>  <span class="va">mu_lyseq_train</span><span class="op">$</span><span class="va">features</span>, </span>
<span>  <span class="va">dlbcl_meta_clean</span>,</span>
<span>  umap_out <span class="op">=</span> <span class="va">mu_lyseq_train</span>,</span>
<span>  truth_classes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MCD"</span>,<span class="st">"EZB"</span>,<span class="st">"BN2"</span>,<span class="st">"N1"</span>,<span class="st">"ST2"</span>,<span class="st">"Other"</span><span class="op">)</span>,</span>
<span>  optimize_for_other <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  min_k<span class="op">=</span><span class="fl">5</span>,</span>
<span>  max_k<span class="op">=</span><span class="fl">13</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="dlbclone_predict">DLBCLone_predict<a class="anchor" aria-label="anchor" href="#dlbclone_predict"></a>
</h3>
<section class="level3"><h4 id="predicting-all-validation-samples">predicting all validation samples<a class="anchor" aria-label="anchor" href="#predicting-all-validation-samples"></a>
</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_valid_lyseq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DLBCLone_predict.html">DLBCLone_predict</a></span><span class="op">(</span></span>
<span>  mutation_status <span class="op">=</span> <span class="va">lyseq_valid</span>,</span>
<span>  optimized_model <span class="op">=</span> <span class="va">lyseq_features_optimized_train</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pred_valid_lyseq</span><span class="op">$</span><span class="va">prediction</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top" style="width:100%;">
<colgroup>
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 10%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 44%">
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">sample_id</th>
<th style="text-align: left;">predicted_label</th>
<th style="text-align: right;">confidence</th>
<th style="text-align: right;">other_score</th>
<th style="text-align: left;">neighbor_id</th>
<th style="text-align: left;">neighbor</th>
<th style="text-align: left;">distance</th>
<th style="text-align: left;">label</th>
<th style="text-align: left;">other_neighbor</th>
<th style="text-align: left;">vote_labels</th>
<th style="text-align: left;">weighted_votes</th>
<th style="text-align: right;">neighbors_other</th>
<th style="text-align: right;">neighborhood_otherness</th>
<th style="text-align: right;">other_weighted_votes</th>
<th style="text-align: right;">total_w</th>
<th style="text-align: right;">pred_w</th>
<th style="text-align: right;">V1</th>
<th style="text-align: right;">V2</th>
<th style="text-align: right;">.id</th>
<th style="text-align: right;">MCD_NN_count</th>
<th style="text-align: right;">EZB_NN_count</th>
<th style="text-align: right;">BN2_NN_count</th>
<th style="text-align: right;">N1_NN_count</th>
<th style="text-align: right;">ST2_NN_count</th>
<th style="text-align: right;">Other_NN_count</th>
<th style="text-align: left;">top_group</th>
<th style="text-align: right;">MCD_score</th>
<th style="text-align: right;">EZB_score</th>
<th style="text-align: right;">BN2_score</th>
<th style="text-align: right;">N1_score</th>
<th style="text-align: right;">ST2_score</th>
<th style="text-align: right;">Other_score</th>
<th style="text-align: left;">top_score_group</th>
<th style="text-align: right;">top_group_score</th>
<th style="text-align: right;">top_group_count</th>
<th style="text-align: right;">Other_count</th>
<th style="text-align: right;">by_vote</th>
<th style="text-align: left;">by_vote_opt</th>
<th style="text-align: left;">by_score</th>
<th style="text-align: right;">score_ratio</th>
<th style="text-align: left;">by_score_opt</th>
<th style="text-align: left;">DLBCLone_w</th>
<th style="text-align: left;">DLBCLone_wo</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorA</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: left;">DLBCL-MC_F349_BJJ-Tumor,SU-DHL-6,06-18449_tumorB,17-33848_tumorB,SP194216,09-41114T,15-11280_CLC02281,SP116620,CAR_276_PreCART,DLBCL11573T,05-25439T</td>
<td style="text-align: left;">626,2425,109,354,1301,172,285,1331,526,1219,88</td>
<td style="text-align: left;">0.15,0.155,0.188,0.194,0.208,0.227,0.236,0.239,0.245,0.254,0.269</td>
<td style="text-align: left;">EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">52.957154159612</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">52.95715</td>
<td style="text-align: right;">52.95715</td>
<td style="text-align: right;">3.243864</td>
<td style="text-align: right;">-3.304324</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">52.957154</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">52.95715</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">Inf</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">EZB</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-14595_tumorB</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: left;">SP194216,SP116620,15-11280_CLC02281,CAR_276_PreCART,SU-DHL-6,10-15025T,DLBCL11573T,DLBCL10498T,DLBCL-MC_F358_WDS-Tumor,FL1010T2,Aph_13_PreCART</td>
<td style="text-align: left;">1301,1331,285,526,2425,177,1219,866,627,449,469</td>
<td style="text-align: left;">0.13,0.16,0.163,0.163,0.176,0.183,0.186,0.187,0.193,0.201,0.208</td>
<td style="text-align: left;">EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">63.0448321243291</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">63.04483</td>
<td style="text-align: right;">63.04483</td>
<td style="text-align: right;">3.316293</td>
<td style="text-align: right;">-3.256026</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">63.044832</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">63.04483</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">Inf</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">EZB</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-14595_tumorC</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: left;">SP193546,98-28290T,CAR_154_PreCART,08-13706T,FL1016T2,03-11110T,96-31596T,05-25674T,CAR_177_PreCART,CLC03454,02-13135T</td>
<td style="text-align: left;">1296,445,507,139,178,46,440,88,513,356,28</td>
<td style="text-align: left;">0.125,0.194,0.236,0.239,0.24,0.246,0.266,0.272,0.273,0.273,0.276</td>
<td style="text-align: left;">EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">48.2057820042242</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">48.20578</td>
<td style="text-align: right;">48.20578</td>
<td style="text-align: right;">2.927276</td>
<td style="text-align: right;">-3.456404</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">48.205782</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">48.20578</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">Inf</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">EZB</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-14595_tumorD</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: left;">SP194216,SP116620,15-11280_CLC02281,CAR_276_PreCART,SU-DHL-6,DLBCL11573T,10-15025T,DLBCL10498T,DLBCL-MC_F358_WDS-Tumor,FL1010T2,Aph_13_PreCART</td>
<td style="text-align: left;">1301,1331,285,526,2425,1219,177,866,627,449,469</td>
<td style="text-align: left;">0.14,0.154,0.155,0.159,0.168,0.178,0.183,0.192,0.193,0.204,0.208</td>
<td style="text-align: left;">EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB,EZB</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">63.4326115607216</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">63.43261</td>
<td style="text-align: right;">63.43261</td>
<td style="text-align: right;">3.308922</td>
<td style="text-align: right;">-3.246991</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">63.432612</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">63.43261</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: right;">Inf</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">EZB</td>
<td style="text-align: left;">EZB</td>
</tr>
<tr class="odd">
<td style="text-align: left;">00-15201_tumorA</td>
<td style="text-align: left;">BN2</td>
<td style="text-align: right;">0.4849835</td>
<td style="text-align: right;">7.187956</td>
<td style="text-align: left;">DLBCL-c_D_1158-Tumor,Reddy_3551T,Reddy_2534T,Reddy_2620T,1011-2020_FFPE,DLBCL-c_D_1117-Tumor,DLBCL-RICOVER_336-Tumor,CLC00239,EX01025,Reddy_3932T,DLBCL11518T</td>
<td style="text-align: left;">813,2075,1714,1768,218,777,706,319,586,2341,1184</td>
<td style="text-align: left;">0.251,0.308,0.356,0.465,0.51,0.631,0.748,0.88,0.883,0.901,0.905</td>
<td style="text-align: left;">ST2,BN2,BN2,BN2,EZB,ST2,ST2,BN2,EZB,MCD,BN2</td>
<td style="text-align: left;">Reddy_3845T,DLBCL10499T,DLBCL11002T,Reddy_3580T,Reddy_3733T,Reddy_3843T,1033700707T,1102503011T,DLBCL10955T,Reddy_2919T,OZM073-017_Diagnosis,Reddy_2634T,SP59400,Reddy_3431T,141900-PL01,Reddy_2206T,Reddy_3654T,DLBCL10962T,Reddy_2915T,1011-2018_FFPE,DLBCL10980T,DLBCL11577T,Reddy_3503T,Seq_1_PreCART,1011-2018_plasma,DLBCL-c_D_1162-Tumor,DLBCL10977T,DLBCL-c_D_1120-Tumor,Reddy_3597T,DLBCL-RICOVER_314-Tumor,Reddy_3739T,Reddy_3675T,DLBCL-MC_F500_ECU-Tumor,DLBCL-c_D_1166-Tumor,Reddy_2769T,DLBCL10888T,Reddy_3638T,Reddy_3519T,Reddy_3566T,Reddy_3562T,Reddy_3865T,1001-2030_FFPE,DLBCL11523T,Reddy_3819T,14-23891T,DLBCL11504T,DLBCL11681T,19-13976_tumorB,19-13976_tumorA,DLBCL10933T</td>
<td style="text-align: left;">BN2,EZB,MCD,ST2</td>
<td style="text-align: left;">10.4543863063556,3.09307700380592,1.10942547282643,6.89928093372623</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">4.545454</td>
<td style="text-align: right;">75.14567</td>
<td style="text-align: right;">21.55617</td>
<td style="text-align: right;">10.45439</td>
<td style="text-align: right;">1.060117</td>
<td style="text-align: right;">1.247014</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">BN2</td>
<td style="text-align: right;">1.109425</td>
<td style="text-align: right;">3.093077</td>
<td style="text-align: right;">10.45439</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">6.899281</td>
<td style="text-align: right;">75.14567</td>
<td style="text-align: left;">BN2</td>
<td style="text-align: right;">10.45439</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">BN2</td>
<td style="text-align: right;">0.1391216</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">BN2</td>
<td style="text-align: left;">Other</td>
</tr>
<tr class="even">
<td style="text-align: left;">00-15201_tumorB</td>
<td style="text-align: left;">N1</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: left;">DLBCL11503T,DLBCL11513T,DLBCL11648T,10-39294_tumorA,DLBCL10520T,DLBCL10973T,10-39294_tumorB,DLBCL10915T,c_D_1050_T,DLBCL10995T,DLBCL-MAYO_DLBCL_234-Tumor</td>
<td style="text-align: left;">1172,1180,1235,186,885,1048,187,995,1433,1068,1442</td>
<td style="text-align: left;">0.177,0.225,0.292,0.331,0.34,0.407,0.439,0.44,0.49,0.535,0.572</td>
<td style="text-align: left;">N1,N1,N1,N1,N1,N1,N1,N1,N1,N1,N1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">N1</td>
<td style="text-align: left;">32.1661354796699</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">32.16614</td>
<td style="text-align: right;">32.16614</td>
<td style="text-align: right;">-3.091845</td>
<td style="text-align: right;">2.947885</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">N1</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">32.16614</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: left;">N1</td>
<td style="text-align: right;">32.16614</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">N1</td>
<td style="text-align: left;">N1</td>
<td style="text-align: right;">Inf</td>
<td style="text-align: left;">N1</td>
<td style="text-align: left;">N1</td>
<td style="text-align: left;">N1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section class="level2"><h3 id="make_neighborhood_plot">make_neighborhood_plot<a class="anchor" aria-label="anchor" href="#make_neighborhood_plot"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_neighborhood_plot.html">make_neighborhood_plot</a></span><span class="op">(</span></span>
<span>  single_sample_prediction_output <span class="op">=</span> <span class="va">pred_valid_lyseq</span>,</span>
<span>  this_sample_id <span class="op">=</span> <span class="st">"00-14595_tumorC"</span>,</span>
<span>  prediction_in_title <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_circle <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  label_column <span class="op">=</span> <span class="st">"DLBCLone_wo"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="validation_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="nearest_neighbor_heatmap">nearest_neighbor_heatmap<a class="anchor" aria-label="anchor" href="#nearest_neighbor_heatmap"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nearest_neighbor_heatmap.html">nearest_neighbor_heatmap</a></span><span class="op">(</span></span>
<span>  this_sample_id <span class="op">=</span> <span class="st">"00-14595_tumorC"</span>,</span>
<span>  DLBCLone_model <span class="op">=</span> <span class="va">pred_valid_lyseq</span>,</span>
<span>  font_size <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="validation_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h3 id="accuracy-assessment">Accuracy Assessment<a class="anchor" aria-label="anchor" href="#accuracy-assessment"></a>
</h3>
<p>Now that we have a fully processed dlbclone validation set (148 samples) of a lyseq panel; let us assess the accuracy by comparing its <code>dlbclone_predict</code> predictions with its ground truth lymphgen labeling found in its metadata:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_vs_original</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">pred_valid_lyseq</span><span class="op">$</span><span class="va">prediction</span>,<span class="va">valid_metadata_vaf</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#collapse composites into group-COMP</span></span>
<span><span class="va">pred_vs_original</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/GAMBLR.utils/man/tidy_lymphgen.html" class="external-link">tidy_lymphgen</a></span><span class="op">(</span><span class="va">pred_vs_original</span>,lymphgen_column_in <span class="op">=</span> <span class="st">"lymphgen"</span>,lymphgen_column_out <span class="op">=</span> <span class="st">"lymphgen_tidy"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#convert composites into their primary class</span></span>
<span><span class="va">pred_vs_original</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">pred_vs_original</span>,lymphgen_basic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"-COMP"</span>,<span class="st">""</span>,<span class="va">lymphgen_tidy</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/make_alluvial.html">make_alluvial</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>predictions<span class="op">=</span><span class="va">pred_vs_original</span><span class="op">)</span>,pred_column <span class="op">=</span> <span class="st">"DLBCLone_wo"</span>,group_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MCD"</span>,<span class="st">"BN2"</span>,<span class="st">"ST2"</span>,<span class="st">"EZB"</span>,<span class="st">"N1"</span>,<span class="st">"Other"</span><span class="op">)</span>,truth_column <span class="op">=</span> <span class="st">"lymphgen_basic"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="validation_files/figure-html/compare_to_lymphgen-1.png" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">pred_vs_original</span><span class="op">$</span><span class="va">lymphgen_basic</span>,<span class="va">pred_vs_original</span><span class="op">$</span><span class="va">DLBCLone_wo</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        BN2 EZB MCD N1 Other ST2
  BN2     5   4   1  0     4   0
  EZB     0  54   0  1     1   0
  MCD     3   0  13  0     2   0
  N1      1   0   0  6     0   0
  Other  12   8   4  1    20   3
  ST2     0   0   0  0     0   5</code></pre>
</div>
</div>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kostiantyn Dreval.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
