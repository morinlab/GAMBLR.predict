% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.R
\name{nearest_neighbor_heatmap}
\alias{nearest_neighbor_heatmap}
\title{Heatmap visualization of mutations in nearest neighbors for a sample}
\usage{
nearest_neighbor_heatmap(
  this_sample_id,
  DLBCLone_model,
  truth_column = "lymphgen",
  metadata_cols = NULL,
  clustering_distance = "binary",
  font_size = 14
)
}
\arguments{
\item{this_sample_id}{Character. The sample ID for which to plot the nearest neighbor heatmap.}

\item{DLBCLone_model}{A DLBCLone model object, which can be the output of \code{DLBCLone_optimize_params}, \code{DLBCLone_KNN}, or \code{predict_single_sample_DLBCLone}.}

\item{truth_column}{The column name in the predictions data frame that contains the ground truth labels (default: "lymphgen").}

\item{metadata_cols}{Optional character vector of additional metadata columns to include in the heatmap annotations.}

\item{clustering_distance}{The distance metric to use for clustering rows. Default is "binary".}

\item{font_size}{Font size for heatmap text (default: 14).}
}
\value{
A ComplexHeatmap object showing the feature matrix for the nearest neighbors of the sample.
}
\description{
Generates a heatmap of feature values for the nearest neighbors of a specified sample,
based on a DLBCLone model object. This visualization helps to inspect the feature profiles
of samples most similar to the query sample.
}
\details{
\itemize{
\item For models of type \code{DLBCLone_optimize_params}, uses the \code{neighbors} and \code{lyseq_status} fields.
\item For models of type \code{DLBCLone_KNN}, uses the \code{unlabeled_neighbors} field.
\item The function extracts the feature matrix rows corresponding to the nearest neighbors of the specified sample,
and plots a heatmap of features with nonzero values.
}
}
\examples{
# Assuming 'model' is a DLBCLone model and 'sample_id' is a valid sample:
nearest_neighbor_heatmap(sample_id, model)

}
