% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/umap.R
\name{DLBCLone_train_mixture_model}
\alias{DLBCLone_train_mixture_model}
\title{Train a Gaussian Mixture Model for DLBCLone Classification}
\usage{
DLBCLone_train_mixture_model(
  umap_out,
  probability_threshold = 0.5,
  density_max_threshold = 0.05,
  truth_column = "lymphgen",
  cohort = NULL
)
}
\arguments{
\item{umap_out}{List. Output from \code{make_and_annotate_umap}, containing a data frame with UMAP coordinates and truth labels.}

\item{probability_threshold}{Numeric. Minimum posterior probability required to assign a class (default: 0.5).}

\item{density_max_threshold}{Numeric. Minimum maximum density required to assign a class (default: 0.05).}

\item{cohort}{Optional character. Cohort label to annotate predictions.}
}
\value{
A list with:
\item{gaussian_mixture_model}{Fitted \code{MclustDA} model object}
\item{predictions}{Data frame with sample IDs, UMAP coordinates, true labels, predicted classes, and thresholded assignments}
\item{probability_threshold}{Probability threshold used for "Other" assignment}
}
\description{
Fits a supervised Gaussian mixture model (GMM) to UMAP-projected data for DLBCLone subtypes, excluding samples labeled "Other".
Assigns class predictions and optionally reclassifies samples as "Other" based on probability and density thresholds.
}
\details{
\itemize{
\item Uses \code{MclustDA} to fit a supervised mixture model to the UMAP coordinates (V1, V2) and class labels.
\item Predicts class membership and computes per-class densities for each sample.
\item Samples with low maximum probability or density are reclassified as "Other".
\item Returns both raw and thresholded class assignments, respectively under the columns DLBCLone_g and DLBCLone_go.
}
}
\examples{
result <- DLBCLone_train_mixture_model(umap_out)
head(result$predictions)
}
